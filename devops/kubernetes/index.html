



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>Kubernetes - Security Knowledge Base</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.1b62728e.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../_site/extra.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#quick-reference" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Security Knowledge Base" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Security Knowledge Base
            </span>
            <span class="md-header-nav__topic">
              
                Kubernetes
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Security Knowledge Base" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Security Knowledge Base
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../apt/" title="APT" class="md-nav__link">
      APT
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../books/" title="Books" class="md-nav__link">
      Books
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../bug-hunting/" title="Bug hunting" class="md-nav__link">
      Bug hunting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../career/" title="Career" class="md-nav__link">
      Career
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../collections/" title="Collections" class="md-nav__link">
      Collections
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../crypto/" title="Crypto" class="md-nav__link">
      Crypto
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../databases-sqlserver/" title="Databases - SqlServer" class="md-nav__link">
      Databases - SqlServer
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../databases/" title="Databases" class="md-nav__link">
      Databases
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../defense/" title="Defense" class="md-nav__link">
      Defense
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../dfir/" title="DFIR" class="md-nav__link">
      DFIR
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../embedded-and-iot/" title="Embedded and iot" class="md-nav__link">
      Embedded and iot
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../exploits_and_shellcoding/" title="Exploits and shellcoding" class="md-nav__link">
      Exploits and shellcoding
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../iam-kerberos/" title="IAM - Kerberos" class="md-nav__link">
      IAM - Kerberos
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../iam/" title="IAM" class="md-nav__link">
      IAM
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../languages/" title="Languages" class="md-nav__link">
      Languages
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../linux-issues/" title="Linux issues" class="md-nav__link">
      Linux issues
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../linux/" title="Linux" class="md-nav__link">
      Linux
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../malware/" title="Malware" class="md-nav__link">
      Malware
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../network/" title="Network" class="md-nav__link">
      Network
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../non-security/" title="Z Non Security" class="md-nav__link">
      Z Non Security
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../operating-systems/" title="Operating systems" class="md-nav__link">
      Operating systems
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../osint/" title="OSINT" class="md-nav__link">
      OSINT
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../password-attacks/" title="Password attacks" class="md-nav__link">
      Password attacks
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../ports-and-protocols/" title="Ports and protocols" class="md-nav__link">
      Ports and protocols
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../red-blue-team/" title="Red blue team" class="md-nav__link">
      Red blue team
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../reverse-engineering/" title="Reverse engineering" class="md-nav__link">
      Reverse engineering
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../rf-and-sdr/" title="RF and SDR" class="md-nav__link">
      RF and SDR
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../social-engineering/" title="Social engineering" class="md-nav__link">
      Social engineering
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../steganography/" title="Steganography" class="md-nav__link">
      Steganography
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../vulnerable/" title="Vulnerable" class="md-nav__link">
      Vulnerable
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../web/" title="Web" class="md-nav__link">
      Web
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../wifi/" title="WiFi" class="md-nav__link">
      WiFi
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-34" type="checkbox" id="nav-34">
    
    <label class="md-nav__link" for="nav-34">
      Certifications
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-34">
        Certifications
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/cissp/" title="CISSP" class="md-nav__link">
      CISSP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/osce/" title="OSCE" class="md-nav__link">
      OSCE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-34-3" type="checkbox" id="nav-34-3">
    
    <label class="md-nav__link" for="nav-34-3">
      Oscp
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-34-3">
        Oscp
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/0-cheatsheet/" title="Enumeration" class="md-nav__link">
      Enumeration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/_collections/" title="collections" class="md-nav__link">
       collections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/_preparation/" title="Was checking" class="md-nav__link">
      Was checking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/lab-setup/" title="Lab Setup" class="md-nav__link">
      Lab Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/notes/" title="Notes" class="md-nav__link">
      Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/practice-vulnhub/" title="Practice" class="md-nav__link">
      Practice
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/setup/" title="Setup" class="md-nav__link">
      Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/y-Tools/" title="Tools" class="md-nav__link">
      Tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-34-3-9" type="checkbox" id="nav-34-3-9">
    
    <label class="md-nav__link" for="nav-34-3-9">
      Cheatsheet
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-34-3-9">
        Cheatsheet
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/0-cheatsheet/" title="Cheatsheets" class="md-nav__link">
      Cheatsheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/download/" title="Download" class="md-nav__link">
      Download
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/exploits/" title="Exploits" class="md-nav__link">
      Exploits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/post-exploitation/" title="Post exploitation" class="md-nav__link">
      Post exploitation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/share-files/" title="Share files" class="md-nav__link">
      Share files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/shell/" title="Bash" class="md-nav__link">
      Bash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/tty/" title="TTY" class="md-nav__link">
      TTY
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/web/" title="Web" class="md-nav__link">
      Web
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/windows/" title="Windows" class="md-nav__link">
      Windows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-34-3-9-10" type="checkbox" id="nav-34-3-9-10">
    
    <label class="md-nav__link" for="nav-34-3-9-10">
      Enumeration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-34-3-9-10">
        Enumeration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/enumeration/network/" title="Network" class="md-nav__link">
      Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/enumeration/vulnerability/" title="Vulnerability" class="md-nav__link">
      Vulnerability
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../certifications/oscp/cheatsheet/enumeration/windows-local/" title="Windows local" class="md-nav__link">
      Windows local
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-35" type="checkbox" id="nav-35">
    
    <label class="md-nav__link" for="nav-35">
      Cloud
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-35">
        Cloud
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/aws/" title="Aws" class="md-nav__link">
      Aws
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/azuer-o360/" title="Azuer o360" class="md-nav__link">
      Azuer o360
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/general/" title="General" class="md-nav__link">
      General
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-36" type="checkbox" id="nav-36" checked>
    
    <label class="md-nav__link" for="nav-36">
      Devops
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-36">
        Devops
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../container/" title="Container" class="md-nav__link">
      Container
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../istio/" title="Istio" class="md-nav__link">
      Istio
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Kubernetes
      </label>
    
    <a href="./" title="Kubernetes" class="md-nav__link md-nav__link--active">
      Kubernetes
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-reference" class="md-nav__link">
    Quick Reference
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minikube" class="md-nav__link">
    Minikube
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubectl" class="md-nav__link">
    Kubectl
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deployment-management" class="md-nav__link">
    Deployment Management
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volumes" class="md-nav__link">
    Volumes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kops" class="md-nav__link">
    kops
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#yamls" class="md-nav__link">
    Yamls
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pod" class="md-nav__link">
    Pod
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replicaset" class="md-nav__link">
    ReplicaSet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deployment" class="md-nav__link">
    Deployment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daemonset" class="md-nav__link">
    DaemonSet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service" class="md-nav__link">
    Service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volume-and-volumemounts" class="md-nav__link">
    Volume and VolumeMounts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#persistentvolumeclaims" class="md-nav__link">
    PersistentVolumeClaims
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storageclass-and-binding" class="md-nav__link">
    StorageClass and Binding
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#statefulset-set" class="md-nav__link">
    StatefulSet Set
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rbac" class="md-nav__link">
    RBAC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configmap" class="md-nav__link">
    ConfigMap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secret" class="md-nav__link">
    Secret
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress" class="md-nav__link">
    Ingress
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#job" class="md-nav__link">
    Job
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cronjob" class="md-nav__link">
    CronJob
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cloud-deployments" class="md-nav__link">
    Cloud Deployments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notes" class="md-nav__link">
    Notes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    Tools
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-validations" class="md-nav__link">
    Security Validations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cluster-api" class="md-nav__link">
    Cluster API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#new-references" class="md-nav__link">
    New References
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#teraform" class="md-nav__link">
    Teraform
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-37" type="checkbox" id="nav-37">
    
    <label class="md-nav__link" for="nav-37">
      Windows
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-37">
        Windows
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/active-directory/" title="Active Directory" class="md-nav__link">
      Active Directory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/powershell/" title="Powershell" class="md-nav__link">
      Powershell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/windows-issues/" title="Windows issues" class="md-nav__link">
      Windows issues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/windows-privilege-escalation/" title="Windows Privilege Escalation" class="md-nav__link">
      Windows Privilege Escalation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows/windows/" title="Windows" class="md-nav__link">
      Windows
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-reference" class="md-nav__link">
    Quick Reference
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minikube" class="md-nav__link">
    Minikube
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubectl" class="md-nav__link">
    Kubectl
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deployment-management" class="md-nav__link">
    Deployment Management
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volumes" class="md-nav__link">
    Volumes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kops" class="md-nav__link">
    kops
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#yamls" class="md-nav__link">
    Yamls
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pod" class="md-nav__link">
    Pod
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replicaset" class="md-nav__link">
    ReplicaSet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deployment" class="md-nav__link">
    Deployment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daemonset" class="md-nav__link">
    DaemonSet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service" class="md-nav__link">
    Service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volume-and-volumemounts" class="md-nav__link">
    Volume and VolumeMounts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#persistentvolumeclaims" class="md-nav__link">
    PersistentVolumeClaims
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storageclass-and-binding" class="md-nav__link">
    StorageClass and Binding
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#statefulset-set" class="md-nav__link">
    StatefulSet Set
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rbac" class="md-nav__link">
    RBAC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configmap" class="md-nav__link">
    ConfigMap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secret" class="md-nav__link">
    Secret
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress" class="md-nav__link">
    Ingress
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#job" class="md-nav__link">
    Job
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cronjob" class="md-nav__link">
    CronJob
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cloud-deployments" class="md-nav__link">
    Cloud Deployments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notes" class="md-nav__link">
    Notes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    Tools
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-validations" class="md-nav__link">
    Security Validations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cluster-api" class="md-nav__link">
    Cluster API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#new-references" class="md-nav__link">
    New References
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#teraform" class="md-nav__link">
    Teraform
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Kubernetes</h1>
                
                <h2 id="quick-reference">Quick Reference<a class="headerlink" href="#quick-reference" title="Permanent link">&para;</a></h2>
<h3 id="minikube">Minikube<a class="headerlink" href="#minikube" title="Permanent link">&para;</a></h3>
<ul>
<li>starts minikube
    <div class="codehilite"><pre><span></span><span class="n">minikube</span> <span class="k">start</span>
</pre></div></li>
<li>stops the minikube virtual machine
    <div class="codehilite"><pre><span></span><span class="n">minikube</span> <span class="n">stop</span>
</pre></div></li>
<li>completely wipe away the minikube image. Also you can delete all files in <home>/.minikube and <home>/.kube.
    <div class="codehilite"><pre><span></span><span class="n">minikube</span> <span class="k">delete</span>
</pre></div></li>
<li>find out the required environment variables to connect to the docker daemon running in minikube
    <div class="codehilite"><pre><span></span><span class="n">minikube</span> <span class="n">env</span>
</pre></div></li>
<li>find out the ip address of minikube. Needed for browser access.
    <div class="codehilite"><pre><span></span><span class="n">minikube</span> <span class="n">ip</span>
</pre></div></li>
</ul>
<h3 id="kubectl">Kubectl<a class="headerlink" href="#kubectl" title="Permanent link">&para;</a></h3>
<ul>
<li>get help
    <div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="k">explain</span> <span class="n">pods</span>
</pre></div></li>
<li>list all namespaces
    <div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="k">get</span> <span class="n">ns</span>
</pre></div></li>
<li>list all objects that you’ve created. Pods at first, later, ReplicaSets, Deployments and Services
    <div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="k">get</span> <span class="k">all</span>
</pre></div></li>
<li>either creates or updates resources depending on the contents of the yaml file
    <div class="codehilite"><pre><span></span><span class="o">-</span> <span class="n">kubectl</span> <span class="n">apply</span> <span class="err">–</span><span class="n">f</span> <span class="o">&lt;</span><span class="n">yaml</span> <span class="n">file</span><span class="o">&gt;</span>
</pre></div></li>
<li>apply all yaml files found in the current directory 
    <div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="n">apply</span> <span class="err">–</span><span class="n">f</span> <span class="p">.</span>
</pre></div></li>
<li>gives full information about the specified pod
    <div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="k">describe</span> <span class="n">pod</span> <span class="o">&lt;</span><span class="n">name</span> <span class="k">of</span> <span class="n">pod</span><span class="o">&gt;</span>
</pre></div></li>
<li>gives full information about the specified service
    <div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="k">describe</span> <span class="n">svc</span> <span class="o">&lt;</span><span class="n">name</span> <span class="k">of</span> <span class="n">pod</span><span class="o">&gt;</span>
</pre></div></li>
<li>view pod logs
    <div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="n">logs</span> <span class="err">{</span><span class="n">pod</span><span class="o">-</span><span class="n">name</span><span class="err">}</span>
</pre></div></li>
<li>Events
    <div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="k">get</span> <span class="n">events</span> <span class="c1">--sort-by=.metadata.creationTimestamp</span>
</pre></div></li>
<li>execute the specified command in the pod’s container. Doesn’t work well in Cygwin.
    <div class="codehilite"><pre><span></span><span class="nv">kubectl</span> <span class="k">exec</span> –<span class="nv">it</span> <span class="o">&lt;</span><span class="nv">pod</span> <span class="nv">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nv">command</span><span class="o">&gt;</span>
</pre></div></li>
<li>get all pods or services. Later in the course, replicasets and deployments.
    <div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="k">get</span> <span class="p">(</span><span class="n">pod</span> <span class="o">|</span> <span class="n">po</span> <span class="o">|</span> <span class="n">service</span> <span class="o">|</span> <span class="n">svc</span> <span class="o">|</span> <span class="n">rs</span> <span class="o">|</span> <span class="n">replicaset</span> <span class="o">|</span> <span class="n">deployment</span> <span class="o">|</span> <span class="n">deploy</span><span class="p">)</span>
</pre></div></li>
<li>get all pods and their labels
    <div class="codehilite"><pre><span></span><span class="nv">kubectl</span> <span class="nv">get</span> <span class="nv">po</span> <span class="o">--</span><span class="k">show</span><span class="o">-</span><span class="nv">labels</span>
</pre></div></li>
<li>get all pods matching the specified name:value pair
    <div class="codehilite"><pre><span></span><span class="nv">kubectl</span> <span class="nv">get</span> <span class="nv">po</span> <span class="o">--</span><span class="k">show</span><span class="o">-</span><span class="nv">labels</span> <span class="o">-</span><span class="nv">l</span> {<span class="nv">name</span>}<span class="o">=</span>{<span class="nv">value</span>}
</pre></div></li>
<li>delete the named pod. Can also delete svc, rs, deploy
    <div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="k">delete</span> <span class="n">po</span> <span class="o">&lt;</span><span class="n">pod</span> <span class="n">name</span><span class="o">&gt;</span>
</pre></div></li>
<li>delete all pods (also svc, rs, deploy)
    <div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="k">delete</span> <span class="n">po</span> <span class="c1">--all</span>
</pre></div></li>
<li>Monitor changes: <code class="codehilite"><span class="c1">--watch</span></code></li>
<li>Diff: <code class="codehilite"><span class="n">kubectl</span> <span class="n">diff</span> <span class="o">-</span><span class="n">f</span> <span class="n">example</span><span class="p">.</span><span class="n">yaml</span></code></li>
<li>CPU/Memory usage: <code class="codehilite"><span class="n">kubectl</span> <span class="n">top</span> <span class="n">pods</span></code></li>
</ul>
<h3 id="deployment-management">Deployment Management<a class="headerlink" href="#deployment-management" title="Permanent link">&para;</a></h3>
<ul>
<li>create: <code class="codehilite"><span class="n">kubectl</span> <span class="k">create</span> <span class="n">deployment</span> <span class="n">example</span> <span class="c1">--image=&lt;image-name&gt;</span></code></li>
<li>expose: <code class="codehilite"><span class="n">kubectl</span> <span class="n">expose</span> <span class="n">deployment</span> <span class="n">example</span> <span class="c1">--type=LoadBalancer</span></code></li>
<li>scale: <code class="codehilite"><span class="n">kubectl</span> <span class="k">scale</span> <span class="n">deployment</span> <span class="n">example</span> <span class="c1">--replicas=3</span></code></li>
<li>get the status of the named deployment
    <div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="n">rollout</span> <span class="n">status</span> <span class="n">deploy</span> <span class="o">&lt;</span><span class="n">name</span> <span class="k">of</span> <span class="n">deployment</span><span class="o">&gt;</span>
</pre></div></li>
<li>get the previous versions of the deployment
    <div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="n">rollout</span> <span class="n">history</span> <span class="n">deploy</span> <span class="o">&lt;</span><span class="n">name</span> <span class="k">of</span> <span class="n">deployment</span><span class="o">&gt;</span>
</pre></div></li>
<li>go back one version in the deployment. Also optionally --to-revision=\&lt;revision_number> We recommend this is used only in stressful emergency situations! Your YAML will now be out of date with the live deployment! 
    <div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="n">rollout</span> <span class="n">undo</span> <span class="n">deploy</span> <span class="o">&lt;</span><span class="n">name</span> <span class="k">of</span> <span class="n">deployment</span><span class="o">&gt;</span>
</pre></div></li>
<li>Manual rollouts:
    <div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="n">rollout</span> <span class="n">history</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span>
<span class="n">kubectl</span> <span class="k">set</span> <span class="n">image</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="o">=</span><span class="n">in28min</span><span class="o">/</span><span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="p">:</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="n">RELEASE</span> <span class="c1">--record=true</span>
<span class="n">kubectl</span> <span class="n">rollout</span> <span class="n">undo</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="c1">--to-revision=1</span>
</pre></div></li>
</ul>
<h3 id="volumes">Volumes<a class="headerlink" href="#volumes" title="Permanent link">&para;</a></h3>
<ul>
<li>list PersistentVolumeClaims
    <div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="k">get</span> <span class="n">pvc</span>
</pre></div></li>
</ul>
<h3 id="kops">kops<a class="headerlink" href="#kops" title="Permanent link">&para;</a></h3>
<ul>
<li>Create cluster
    <div class="codehilite"><pre><span></span>kops create cluster --zone eu-west-2a,eu-west-2b <span class="cp">${</span><span class="n">NAME</span><span class="cp">}</span>
</pre></div></li>
<li>Edit instance-group configuration
    <div class="codehilite"><pre><span></span><span class="n">kops</span> <span class="n">edit</span> <span class="n">ig</span>
</pre></div></li>
<li>Update cluster
    <div class="codehilite"><pre><span></span>kops update cluster <span class="cp">${</span><span class="n">NAME</span><span class="cp">}</span> --yes
</pre></div></li>
<li>Validate cluster
    <div class="codehilite"><pre><span></span><span class="n">kops</span> <span class="n">validate</span> <span class="k">cluster</span>
</pre></div></li>
<li>Delete cluster
    <div class="codehilite"><pre><span></span>kops delete cluster --name <span class="cp">${</span><span class="n">NAME</span><span class="cp">}</span> --yes
</pre></div></li>
</ul>
<div class="codehilite"><pre><span></span>    <span class="n">kubectl</span> <span class="k">create</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="c1">--image=in28min/hello-world-rest-api:0.0.1.RELEASE</span>
    <span class="n">kubectl</span> <span class="n">expose</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="c1">--type=LoadBalancer --port=8080</span>
    <span class="n">kubectl</span> <span class="k">scale</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="c1">--replicas=3</span>
    <span class="n">kubectl</span> <span class="k">delete</span> <span class="n">pod</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="mi">58</span><span class="n">ff5dd898</span><span class="o">-</span><span class="mi">62</span><span class="n">l9d</span>
    <span class="n">kubectl</span> <span class="n">autoscale</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="c1">--max=10 --cpu-percent=70</span>
    <span class="n">kubectl</span> <span class="n">edit</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="o">#</span><span class="n">minReadySeconds</span><span class="p">:</span> <span class="mi">15</span>
    <span class="n">kubectl</span> <span class="k">set</span> <span class="n">image</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="o">=</span><span class="n">in28min</span><span class="o">/</span><span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="p">:</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="n">RELEASE</span>

    <span class="n">gcloud</span> <span class="n">container</span> <span class="n">clusters</span> <span class="k">get</span><span class="o">-</span><span class="n">credentials</span> <span class="n">in28minutes</span><span class="o">-</span><span class="k">cluster</span> <span class="c1">--zone us-central1-a --project solid-course-258105</span>
    <span class="n">kubectl</span> <span class="k">create</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="c1">--image=in28min/hello-world-rest-api:0.0.1.RELEASE</span>
    <span class="n">kubectl</span> <span class="n">expose</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="c1">--type=LoadBalancer --port=8080</span>
    <span class="n">kubectl</span> <span class="k">set</span> <span class="n">image</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="o">=</span><span class="n">DUMMY_IMAGE</span><span class="p">:</span><span class="n">TEST</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">events</span> <span class="c1">--sort-by=.metadata.creationTimestamp</span>
    <span class="n">kubectl</span> <span class="k">set</span> <span class="n">image</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="o">=</span><span class="n">in28min</span><span class="o">/</span><span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="p">:</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="n">RELEASE</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">events</span> <span class="c1">--sort-by=.metadata.creationTimestamp</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">componentstatuses</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">pods</span> <span class="c1">--all-namespaces</span>

    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">events</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">pods</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">replicaset</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">deployment</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">service</span>

    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">pods</span> <span class="o">-</span><span class="n">o</span> <span class="n">wide</span>

    <span class="n">kubectl</span> <span class="k">explain</span> <span class="n">pods</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">pods</span> <span class="o">-</span><span class="n">o</span> <span class="n">wide</span>

    <span class="n">kubectl</span> <span class="k">describe</span> <span class="n">pod</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="mi">58</span><span class="n">ff5dd898</span><span class="o">-</span><span class="mi">9</span><span class="n">trh2</span>

    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">replicasets</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">replicaset</span>

    <span class="n">kubectl</span> <span class="k">scale</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="c1">--replicas=3</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">pods</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">replicaset</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">events</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">events</span> <span class="c1">--sort.by=.metadata.creationTimestamp</span>

    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">rs</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">rs</span> <span class="o">-</span><span class="n">o</span> <span class="n">wide</span>
    <span class="n">kubectl</span> <span class="k">set</span> <span class="n">image</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="o">=</span><span class="n">DUMMY_IMAGE</span><span class="p">:</span><span class="n">TEST</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">rs</span> <span class="o">-</span><span class="n">o</span> <span class="n">wide</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">pods</span>
    <span class="n">kubectl</span> <span class="k">describe</span> <span class="n">pod</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="mi">85995</span><span class="n">ddd5c</span><span class="o">-</span><span class="n">msjsm</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">events</span> <span class="c1">--sort-by=.metadata.creationTimestamp</span>

    <span class="n">kubectl</span> <span class="k">set</span> <span class="n">image</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="o">=</span><span class="n">in28min</span><span class="o">/</span><span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="p">:</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="n">RELEASE</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">events</span> <span class="c1">--sort-by=.metadata.creationTimestamp</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">pods</span> <span class="o">-</span><span class="n">o</span> <span class="n">wide</span>
    <span class="n">kubectl</span> <span class="k">delete</span> <span class="n">pod</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="mi">67</span><span class="n">c79fd44f</span><span class="o">-</span><span class="n">n6c7l</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">pods</span> <span class="o">-</span><span class="n">o</span> <span class="n">wide</span>
    <span class="n">kubectl</span> <span class="k">delete</span> <span class="n">pod</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="mi">67</span><span class="n">c79fd44f</span><span class="o">-</span><span class="mi">8</span><span class="n">bhdt</span>

    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">componentstatuses</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">pods</span> <span class="c1">--all-namespaces</span>

    <span class="n">gcloud</span> <span class="n">auth</span> <span class="n">login</span>
    <span class="n">kubectl</span> <span class="k">version</span>
    <span class="n">gcloud</span> <span class="n">container</span> <span class="n">clusters</span> <span class="k">get</span><span class="o">-</span><span class="n">credentials</span> <span class="n">in28minutes</span><span class="o">-</span><span class="k">cluster</span> <span class="c1">--zone us-central1-a --project solid-course-258105</span>

    <span class="n">kubectl</span> <span class="n">logs</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="mi">58</span><span class="n">ff5dd898</span><span class="o">-</span><span class="mi">6</span><span class="n">ctr2</span>
    <span class="n">kubectl</span> <span class="n">logs</span> <span class="o">-</span><span class="n">f</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="mi">58</span><span class="n">ff5dd898</span><span class="o">-</span><span class="mi">6</span><span class="n">ctr2</span>

    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="o">-</span><span class="n">o</span> <span class="n">yaml</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="o">-</span><span class="n">o</span> <span class="n">yaml</span> <span class="o">&gt;</span> <span class="n">deployment</span><span class="p">.</span><span class="n">yaml</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">service</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span> <span class="o">-</span><span class="n">o</span> <span class="n">yaml</span> <span class="o">&gt;</span> <span class="n">service</span><span class="p">.</span><span class="n">yaml</span>
    <span class="n">kubectl</span> <span class="n">apply</span> <span class="o">-</span><span class="n">f</span> <span class="n">deployment</span><span class="p">.</span><span class="n">yaml</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="k">all</span> <span class="o">-</span><span class="n">o</span> <span class="n">wide</span>
    <span class="n">kubectl</span> <span class="k">delete</span> <span class="k">all</span> <span class="o">-</span><span class="n">l</span> <span class="n">app</span><span class="o">=</span><span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span>

    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">svc</span> <span class="c1">--watch</span>
    <span class="n">kubectl</span> <span class="n">diff</span> <span class="o">-</span><span class="n">f</span> <span class="n">deployment</span><span class="p">.</span><span class="n">yaml</span>
    <span class="n">kubectl</span> <span class="k">delete</span> <span class="n">deployment</span> <span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="k">all</span> <span class="o">-</span><span class="n">o</span> <span class="n">wide</span>
    <span class="n">kubectl</span> <span class="k">delete</span> <span class="n">replicaset</span><span class="p">.</span><span class="n">apps</span><span class="o">/</span><span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="mi">797</span><span class="n">dd4b5dc</span>

    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">pods</span> <span class="c1">--all-namespaces</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">pods</span> <span class="c1">--all-namespaces -l app=hello-world-rest-api</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">services</span> <span class="c1">--all-namespaces</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">services</span> <span class="c1">--all-namespaces --sort-by=.spec.type</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">services</span> <span class="c1">--all-namespaces --sort-by=.metadata.name</span>
    <span class="n">kubectl</span> <span class="k">cluster</span><span class="o">-</span><span class="n">info</span>
    <span class="n">kubectl</span> <span class="k">cluster</span><span class="o">-</span><span class="n">info</span> <span class="n">dump</span>
    <span class="n">kubectl</span> <span class="n">top</span> <span class="n">node</span>
    <span class="n">kubectl</span> <span class="n">top</span> <span class="n">pod</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">services</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">svc</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">ev</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">rs</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">ns</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">nodes</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="k">no</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">pods</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="n">po</span>

    <span class="n">kubectl</span> <span class="k">delete</span> <span class="k">all</span> <span class="o">-</span><span class="n">l</span> <span class="n">app</span><span class="o">=</span><span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">api</span>
    <span class="n">kubectl</span> <span class="k">get</span> <span class="k">all</span>

    <span class="n">kubectl</span> <span class="n">apply</span> <span class="o">-</span><span class="n">f</span> <span class="n">deployment</span><span class="p">.</span><span class="n">yaml</span> 
    <span class="n">kubectl</span> <span class="n">apply</span> <span class="o">-</span><span class="n">f</span> <span class="p">..</span><span class="o">/</span><span class="n">currency</span><span class="o">-</span><span class="k">conversion</span><span class="o">/</span><span class="n">deployment</span><span class="p">.</span><span class="n">yaml</span> 
</pre></div>

<h2 id="yamls">Yamls<a class="headerlink" href="#yamls" title="Permanent link">&para;</a></h2>
<h3 id="pod">Pod<a class="headerlink" href="#pod" title="Permanent link">&para;</a></h3>
<ul>
<li>The basic execution unit of a Kubernetes application--the smallest and simplest unit in the Kubernetes object model that you create or deploy. </li>
<li>A Pod represents processes running on your cluster.</li>
<li>Init container<ul>
<li>Run before the app containers are started.</li>
<li>Init containers always run to completion.</li>
<li>Each init container must complete successfully before the next one starts.</li>
<li>If a Pod's init container fails, Kubernetes repeatedly restarts the Pod until the init container succeeds. However, if the Pod has a restartPolicy of Never, Kubernetes does not restart the Pod.</li>
</ul>
</li>
<li><a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-overview/">https://kubernetes.io/docs/concepts/workloads/pods/pod-overview/</a></li>
<li><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#pod-v1-core">https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#pod-v1-core</a></li>
</ul>
<div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pod-example</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">containers</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ubuntu</span>
    <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ubuntu:trusty</span>
    <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;echo&quot;</span><span class="p p-Indicator">]</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;Hello</span><span class="nv"> </span><span class="s">World&quot;</span><span class="p p-Indicator">]</span>
</pre></div>

<h3 id="replicaset">ReplicaSet<a class="headerlink" href="#replicaset" title="Permanent link">&para;</a></h3>
<ul>
<li>Maintain a stable set of replica Pods running at any given time. </li>
<li>As such, it is often used to guarantee the availability of a specified number of identical Pods</li>
<li><a href="https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/">https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/</a></li>
<li><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#replicaset-v1-apps">https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#replicaset-v1-apps</a></li>
</ul>
<div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ReplicaSet</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="c1"># Unique key of the ReplicaSet instance</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">replicaset-example</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="c1"># 3 Pods should exist at all times.</span>
  <span class="nt">replicas</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">matchLabels</span><span class="p">:</span>
      <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
  <span class="nt">template</span><span class="p">:</span>
    <span class="nt">metadata</span><span class="p">:</span>
      <span class="nt">labels</span><span class="p">:</span>
        <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
    <span class="nt">spec</span><span class="p">:</span>
      <span class="nt">containers</span><span class="p">:</span>
      <span class="c1"># Run the nginx image</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx:1.14</span>
</pre></div>

<h3 id="deployment">Deployment<a class="headerlink" href="#deployment" title="Permanent link">&para;</a></h3>
<ul>
<li>Deployment provides declarative updates for Pods and ReplicaSets.</li>
<li>You describe a desired state in a Deployment, and the Deployment Controller changes the actual state to the desired state at a controlled rate.</li>
<li><a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">https://kubernetes.io/docs/concepts/workloads/controllers/deployment/</a></li>
<li><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#deployment-v1-apps">https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#deployment-v1-apps</a></li>
</ul>
<div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="c1"># Unique key of the Deployment instance</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deployment-example</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="c1"># 3 Pods should exist at all times.</span>
  <span class="nt">replicas</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">matchLabels</span><span class="p">:</span>
      <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
  <span class="nt">template</span><span class="p">:</span>
    <span class="nt">metadata</span><span class="p">:</span>
      <span class="nt">labels</span><span class="p">:</span>
        <span class="c1"># Apply this label to pods and default</span>
        <span class="c1"># the Deployment label selector to this value</span>
        <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
    <span class="nt">spec</span><span class="p">:</span>
      <span class="nt">containers</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
        <span class="c1"># Run this image</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx:1.14</span>
</pre></div>

<h3 id="daemonset">DaemonSet<a class="headerlink" href="#daemonset" title="Permanent link">&para;</a></h3>
<ul>
<li>A DaemonSet ensures that all (or some) Nodes run a copy of a Pod. </li>
<li>As nodes are added to the cluster, Pods are added to them. As nodes are removed from the cluster, those Pods are garbage collected.<ul>
<li>running a cluster storage daemon on every node</li>
<li>running a logs collection daemon on every node</li>
<li>running a node monitoring daemon on every node</li>
</ul>
</li>
<li><a href="https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/">https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/</a></li>
<li><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#daemonset-v1-apps">https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#daemonset-v1-apps</a></li>
</ul>
<div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DaemonSet</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="c1"># Unique key of the DaemonSet instance</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">daemonset-example</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">matchLabels</span><span class="p">:</span>
      <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">daemonset-example</span>
  <span class="nt">template</span><span class="p">:</span>
    <span class="nt">metadata</span><span class="p">:</span>
      <span class="nt">labels</span><span class="p">:</span>
        <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">daemonset-example</span>
    <span class="nt">spec</span><span class="p">:</span>
      <span class="nt">containers</span><span class="p">:</span>
      <span class="c1"># This container is run once on each Node in the cluster</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">daemonset-example</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ubuntu:trusty</span>
        <span class="nt">command</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/bin/sh</span>
        <span class="nt">args</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">-c</span>
        <span class="c1"># This script is run through `sh -c &lt;script&gt;`</span>
        <span class="p p-Indicator">-</span> <span class="p p-Indicator">&gt;-</span>
          <span class="no">while [ true ]; do</span>
          <span class="no">echo &quot;DaemonSet running on $(hostname)&quot; ;</span>
          <span class="no">sleep 10 ;</span>
          <span class="no">done</span>
</pre></div>

<h3 id="service">Service<a class="headerlink" href="#service" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#service-v1-core">https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#service-v1-core</a></li>
</ul>
<div class="codehilite"><pre><span></span><span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="c1"># Unique key of the Service instance</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service-example</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">ports</span><span class="p">:</span>
    <span class="c1"># Accept traffic sent to port 80</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http</span>
      <span class="nt">port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
      <span class="nt">targetPort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="c1"># Loadbalance traffic across Pods matching</span>
    <span class="c1"># this label selector</span>
    <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
  <span class="c1"># Create an HA proxy in the cloud provider</span>
  <span class="c1"># with an External IP address - *Only supported</span>
  <span class="c1"># by some cloud providers*</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">LoadBalancer</span>
</pre></div>

<h3 id="volume-and-volumemounts">Volume and VolumeMounts<a class="headerlink" href="#volume-and-volumemounts" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pv-recycler</span>
  <span class="nt">namespace</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">restartPolicy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Never</span>
  <span class="nt">volumes</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vol</span>
    <span class="nt">hostPath</span><span class="p">:</span>
      <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/any/path/it/will/be/replaced</span>
  <span class="nt">containers</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pv-recycler</span>
    <span class="nt">image</span><span class="p">:</span> <span class="s">&quot;k8s.gcr.io/busybox&quot;</span>
    <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;/bin/sh&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;-c&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;test</span><span class="nv"> </span><span class="s">-e</span><span class="nv"> </span><span class="s">/scrub</span><span class="nv"> </span><span class="s">&amp;&amp;</span><span class="nv"> </span><span class="s">rm</span><span class="nv"> </span><span class="s">-rf</span><span class="nv"> </span><span class="s">/scrub/..?*</span><span class="nv"> </span><span class="s">/scrub/.[!.]*</span><span class="nv"> </span><span class="s">/scrub/*</span><span class="nv">  </span><span class="s">&amp;&amp;</span><span class="nv"> </span><span class="s">test</span><span class="nv"> </span><span class="s">-z</span><span class="nv"> </span><span class="s">\&quot;$(ls</span><span class="nv"> </span><span class="s">-A</span><span class="nv"> </span><span class="s">/scrub)\&quot;</span><span class="nv"> </span><span class="s">||</span><span class="nv"> </span><span class="s">exit</span><span class="nv"> </span><span class="s">1&quot;</span><span class="p p-Indicator">]</span>
    <span class="nt">volumeMounts</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vol</span>
      <span class="nt">mountPath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/scrub</span>
</pre></div>

<h3 id="persistentvolumeclaims">PersistentVolumeClaims<a class="headerlink" href="#persistentvolumeclaims" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PersistentVolumeClaim</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-pvc</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">storageClassName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-ssd-local-storage</span>
  <span class="c1"># Find matching storage class</span>
  <span class="nt">accessModes</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ReadWriteOnce</span>
    <span class="c1"># Find matching access mode</span>
  <span class="nt">resources</span><span class="p">:</span>
    <span class="nt">requests</span><span class="p">:</span>
      <span class="nt">storage</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8Gi</span>
      <span class="c1"># Find 8Gi of storage </span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PersistentVolume</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-local-storage</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">storageClassName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-ssd-local-storage</span>
  <span class="nt">capacity</span><span class="p">:</span>
    <span class="nt">storage</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8Gi</span>
  <span class="nt">accessModes</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ReadWriteOnce</span>
  <span class="nt">hostPath</span><span class="p">:</span>
    <span class="nt">path</span><span class="p">:</span> <span class="s">&quot;/mnt/somedir&quot;</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DirectoryOrCreate</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mypod</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">containers</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">myfrontend</span>
      <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
      <span class="nt">volumeMounts</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">mountPath</span><span class="p">:</span> <span class="s">&quot;/var/www/html&quot;</span>
        <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mypd</span>
  <span class="nt">volumes</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mypd</span>
      <span class="nt">persistentVolumeClaim</span><span class="p">:</span>
        <span class="nt">claimName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-pvc</span>
</pre></div>

<h3 id="storageclass-and-binding">StorageClass and Binding<a class="headerlink" href="#storageclass-and-binding" title="Permanent link">&para;</a></h3>
<ul>
<li>Change reclaim policy as required </li>
</ul>
<div class="codehilite"><pre><span></span><span class="c1"># What do want?</span>
<span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PersistentVolumeClaim</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mongo-pvc</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">storageClassName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cloud-ssd</span>
  <span class="nt">accessModes</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ReadWriteOnce</span>
  <span class="nt">resources</span><span class="p">:</span>
    <span class="nt">requests</span><span class="p">:</span>
      <span class="nt">storage</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">7Gi</span>
<span class="nn">---</span>
<span class="c1"># How do we want it implemented</span>
<span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">storage.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">StorageClass</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cloud-ssd</span>
<span class="nt">provisioner</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kubernetes.io/aws-ebs</span>
<span class="nt">parameters</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gp2</span>
</pre></div>

<h3 id="statefulset-set">StatefulSet Set<a class="headerlink" href="#statefulset-set" title="Permanent link">&para;</a></h3>
<ul>
<li>StatefulSet is the workload API object used to manage stateful applications.<ul>
<li>Stable, unique network identifiers.</li>
<li>Stable, persistent storage.</li>
<li>Ordered, graceful deployment and scaling.</li>
<li>Ordered, automated rolling updates.</li>
</ul>
</li>
<li>Like a Deployment, a StatefulSet manages Pods that are based on an identical container spec. </li>
<li>Unlike a Deployment, a StatefulSet maintains a sticky identity for each of their Pods.</li>
<li>These pods are created from the same spec, but are not interchangeable: <ul>
<li>Each has a persistent identifier that it maintains across any rescheduling.</li>
</ul>
</li>
<li><a href="https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/">https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/</a></li>
</ul>
<h3 id="rbac">RBAC<a class="headerlink" href="#rbac" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">https://kubernetes.io/docs/reference/access-authn-authz/rbac/</a></li>
<li>Kind - <code class="codehilite"><span class="k">Role</span></code> -&gt; <code class="codehilite"><span class="n">ClusterRole</span></code>to grant cluster-wide permissions.
<div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Role</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">namespace</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pod-reader</span>
<span class="nt">rules</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">apiGroups</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;&quot;</span><span class="p p-Indicator">]</span> <span class="c1"># &quot;&quot; indicates the core API group</span>
  <span class="nt">resources</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;pods&quot;</span><span class="p p-Indicator">]</span>
  <span class="nt">verbs</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;get&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;watch&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;list&quot;</span><span class="p p-Indicator">]</span>
</pre></div>
<div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io/v1</span>
<span class="c1"># This role binding allows &quot;jane&quot; to read pods in the &quot;default&quot; namespace.</span>
<span class="c1"># You need to already have a Role named &quot;pod-reader&quot; in that namespace.</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RoleBinding</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">read-pods</span>
  <span class="nt">namespace</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="nt">subjects</span><span class="p">:</span>
<span class="c1"># You can specify more than one &quot;subject&quot;</span>
<span class="p p-Indicator">-</span> <span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">User</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">jane</span> <span class="c1"># &quot;name&quot; is case sensitive</span>
  <span class="nt">apiGroup</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io</span>
<span class="nt">roleRef</span><span class="p">:</span>
  <span class="c1"># &quot;roleRef&quot; specifies the binding to a Role / ClusterRole</span>
  <span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Role</span> <span class="c1">#this must be Role or ClusterRole</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pod-reader</span> <span class="c1"># this must match the name of the Role or ClusterRole you wish to bind to</span>
  <span class="nt">apiGroup</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">rbac.authorization.k8s.io</span>
</pre></div></li>
</ul>
<h3 id="configmap">ConfigMap<a class="headerlink" href="#configmap" title="Permanent link">&para;</a></h3>
<p><div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">creationTimestamp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2016-02-18T18:52:05Z</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">game-config</span>
  <span class="nt">namespace</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>
  <span class="nt">resourceVersion</span><span class="p">:</span> <span class="s">&quot;516&quot;</span>
  <span class="nt">uid</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">b4952dc3-d670-11e5-8cd0-68f728db1985</span>
<span class="nt">data</span><span class="p">:</span>
  <span class="nt">game.properties</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">enemies=aliens</span>
    <span class="no">lives=3</span>
    <span class="no">enemies.cheat=true</span>
    <span class="no">enemies.cheat.level=noGoodRotten</span>
    <span class="no">secret.code.passphrase=UUDDLRLRBABAS</span>
    <span class="no">secret.code.allowed=true</span>
    <span class="no">secret.code.lives=30</span>
  <span class="nt">ui.properties</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">color.good=purple</span>
    <span class="no">color.bad=yellow</span>
    <span class="no">allow.textmode=true</span>
    <span class="no">how.nice.to.look=fairlyNice</span>
</pre></div>
<div class="codehilite"><pre><span></span><span class="n">kubectl</span> <span class="k">create</span> <span class="n">configmap</span> <span class="n">game</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="mi">2</span> <span class="c1">--from-file=configure-pod-container/configmap/game.properties</span>
</pre></div></p>
<h3 id="secret">Secret<a class="headerlink" href="#secret" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mysecret</span>
<span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Opaque</span>
<span class="nt">data</span><span class="p">:</span>
  <span class="nt">username</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">YWRtaW4=</span>
  <span class="nt">password</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MWYyZDFlMmU2N2Rm</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mysecret</span>
<span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Opaque</span>
<span class="nt">stringData</span><span class="p">:</span>
  <span class="nt">config.yaml</span><span class="p">:</span> <span class="p p-Indicator">|-</span>
    <span class="no">apiUrl: &quot;https://my.api.com/api/v1&quot;</span>
    <span class="no">username: {{username}}</span>
    <span class="no">password: {{password}}</span>
</pre></div>

<h3 id="ingress">Ingress<a class="headerlink" href="#ingress" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">test-ingress</span>
  <span class="nt">annotations</span><span class="p">:</span>
    <span class="nt">nginx.ingress.kubernetes.io/rewrite-target</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">rules</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">domain1.com</span>
    <span class="nt">http</span><span class="p">:</span>
      <span class="nt">paths</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/testpath</span>
        <span class="nt">pathType</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Prefix</span>
        <span class="nt">backend</span><span class="p">:</span>
          <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">test</span>
          <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="p p-Indicator">-</span> <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">domain2.com</span>
</pre></div>

<h3 id="job">Job<a class="headerlink" href="#job" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">batch/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Job</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pi</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">template</span><span class="p">:</span>
    <span class="nt">spec</span><span class="p">:</span>
      <span class="nt">containers</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pi</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">perl</span>
        <span class="nt">command</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;perl&quot;</span><span class="p p-Indicator">,</span>  <span class="s">&quot;-Mbignum=bpi&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;-wle&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;print</span><span class="nv"> </span><span class="s">bpi(2000)&quot;</span><span class="p p-Indicator">]</span>
      <span class="nt">restartPolicy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Never</span>
  <span class="nt">backoffLimit</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4</span>
</pre></div>

<h3 id="cronjob">CronJob<a class="headerlink" href="#cronjob" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">batch/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CronJob</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">schedule</span><span class="p">:</span> <span class="s">&quot;*/1</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*&quot;</span>
  <span class="nt">jobTemplate</span><span class="p">:</span>
    <span class="nt">spec</span><span class="p">:</span>
      <span class="nt">template</span><span class="p">:</span>
        <span class="nt">spec</span><span class="p">:</span>
          <span class="nt">containers</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">hello</span>
            <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">busybox</span>
            <span class="nt">args</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/bin/sh</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">-c</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">date; echo Hello from the Kubernetes cluster</span>
          <span class="nt">restartPolicy</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OnFailure</span>
</pre></div>

<h2 id="cloud-deployments">Cloud Deployments<a class="headerlink" href="#cloud-deployments" title="Permanent link">&para;</a></h2>
<p><strong>Kops</strong></p>
<ul>
<li><a href="https://kops.sigs.k8s.io/">https://kops.sigs.k8s.io/</a></li>
<li><a href="https://kops.sigs.k8s.io/getting_started/commands/">https://kops.sigs.k8s.io/getting_started/commands/</a></li>
</ul>
<h2 id="notes">Notes<a class="headerlink" href="#notes" title="Permanent link">&para;</a></h2>
<ul>
<li>bretfisher Courses - Kubernetes Mastery: Hands-On Lessons From A Docker Captain: <a href="https://www.bretfisher.com/courses/">https://www.bretfisher.com/courses/</a></li>
<li>Threat matrix for Kubernetes - <a href="https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/">https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/</a></li>
<li>Pod Security Policies: <a href="https://kubernetes.io/docs/concepts/policy/pod-security-policy/">https://kubernetes.io/docs/concepts/policy/pod-security-policy/</a></li>
<li><a href="https://www.jaegertracing.io/docs/1.18/">https://www.jaegertracing.io/docs/1.18/</a></li>
</ul>
<p><img alt="" src="_assets/2020-05-13-21-52-12.png" /></p>
<ul>
<li>Stay current in k8s</li>
<li>Harden nodes</li>
<li>Restrict network via RBAC</li>
<li>Use namespaces and network policies</li>
<li>Slim down images</li>
<li>Logs - k8s audit / k8s rbac audit logs / </li>
</ul>
<ul>
<li>Follows single responsibility concept</li>
<li>Cluster<ul>
<li>Master Node - Manage Cluster<ul>
<li>API Server (kube-apiserver)</li>
<li>Distributed Database (etcd)</li>
<li>Scheduler  (kube-scheduler)</li>
<li>Controller Manager (kube-controller-manager)</li>
</ul>
</li>
<li>Worker Nodes - Run Applications <ul>
<li>Node Agent (kubelet)</li>
<li>Networking Component (kube-proxy)</li>
<li>Container Runtime (CRI - OCI/docker/rkt)</li>
<li>PODS</li>
</ul>
</li>
</ul>
</li>
<li>Service<ul>
<li>Pods are not visible outside k8s cluster</li>
<li>K8s service is a long running object with IP address and stable fixed port usable to expose Pods out of k8s cluster</li>
<li>Pod can have "Label" (key value pairs)</li>
<li>Service can have "Selector" (key value pairs)</li>
<li>Service will look for any matching key-value pairs when binding a service to a pod (selector / label)</li>
<li>Service Types:<ul>
<li>NodePort <ul>
<li>Expose a port through the node </li>
<li>Port needs to be greater than 30,000</li>
<li>Configure <code class="codehilite"><span class="n">port</span></code> and <code class="codehilite"><span class="n">nodeport</span></code> </li>
</ul>
</li>
<li>ClusterIP <ul>
<li>Internal service / not exposed to external traffic but exposed to internal nodes</li>
</ul>
</li>
<li>LoadBalancer</li>
</ul>
</li>
</ul>
</li>
<li>Pod may die for many reasons:<ul>
<li>If pod take too many resources</li>
<li>If node failed (all pods in that node die)</li>
</ul>
</li>
<li>ReplicaSets <ul>
<li>Add replica count into <code class="codehilite"><span class="n">pod</span> <span class="n">definition</span></code></li>
<li>Change kind to <code class="codehilite"><span class="n">ReplicaSet</span></code></li>
<li>Nest pod definition in <code class="codehilite"><span class="k">template</span></code>  <code class="codehilite"><span class="n">spec</span></code> attribute</li>
<li>Remove <code class="codehilite"><span class="n">pod</span> <span class="k">names</span></code></li>
<li>Add <code class="codehilite"><span class="n">selector</span></code> block (similar to <code class="codehilite"><span class="n">services</span></code>)</li>
</ul>
</li>
<li>Deployment <ul>
<li>Automatic rolling update with rollbacks</li>
</ul>
</li>
<li>Networking <ul>
<li>Service Discovery<ul>
<li>Same Pod - can be accessed via <code class="codehilite"><span class="n">localhost</span></code></li>
<li>Kube-dns - Resolve service name to IP address</li>
</ul>
</li>
<li>Namespaces <ul>
<li>Partitioning resources into separate areas</li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">get</span> <span class="n">ns</span></code> get list of namespaces </li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">get</span> <span class="k">all</span> <span class="o">-</span><span class="n">n</span> <span class="n">kube</span><span class="o">-</span><span class="k">system</span></code> list resources from a namespace</li>
</ul>
</li>
<li><code class="codehilite"><span class="n">FQDN</span></code> -&gt; <code class="codehilite"><span class="k">database</span></code> -&gt; <code class="codehilite"><span class="k">database</span><span class="p">.</span><span class="n">mynamespace</span></code> -&gt; <code class="codehilite"><span class="k">database</span><span class="p">.</span><span class="n">mynamespace</span><span class="p">.</span><span class="n">svc</span><span class="p">.</span><span class="k">cluster</span><span class="p">.</span><span class="k">local</span></code> (last part is appended by DNS)<ul>
<li>Check <code class="codehilite"><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">resolve</span><span class="p">.</span><span class="n">conf</span></code></li>
</ul>
</li>
</ul>
</li>
<li>Expand memory:<ul>
<li><code class="codehilite"><span class="n">minikube</span> <span class="n">stop</span></code></li>
<li><code class="codehilite"><span class="n">minikube</span> <span class="k">delete</span></code></li>
<li><code class="codehilite"><span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="o">~/</span><span class="p">.</span><span class="n">kube</span></code> and <code class="codehilite"><span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="o">~/</span><span class="p">.</span><span class="n">minikube</span></code></li>
<li><code class="codehilite"><span class="n">minikube</span> <span class="k">start</span> <span class="c1">--memory 4096</span></code></li>
</ul>
</li>
<li>Microservices <ul>
<li>changing one part is hard without affecting other</li>
<li>complications of release coordination (big bang releases)</li>
<li>shared global databases (integration databases)</li>
<li>microservices as extreme form of modularity <ul>
<li>no direct communication in between</li>
<li>interfaces for communication </li>
<li>totally independent </li>
<li>limit to one specific area of business function</li>
<li>highly cohesive and loosely coupled</li>
<li>database is split </li>
<li>Domain-driven Design (Eric Evans) - Bounded Context</li>
<li><a href="https://github.com/DickChesterwood/k8s-fleetman">https://github.com/DickChesterwood/k8s-fleetman</a></li>
<li>need api gateway to expose backend functions (microservices)<ul>
<li>single point of entry to system</li>
<li><a href="https://microservices.io/patterns/apigateway.html">https://microservices.io/patterns/apigateway.html</a> </li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Common Cluster Configurations: <a href="https://github.com/kubernetes/kubernetes/tree/master/cluster/addons">https://github.com/kubernetes/kubernetes/tree/master/cluster/addons</a></li>
<li>ElasticStack + (LogStash / FluentD)</li>
<li>Helm - Package management for k8s<ul>
<li><code class="codehilite"><span class="n">helm</span> <span class="n">init</span></code></li>
<li><code class="codehilite"><span class="n">helm</span> <span class="k">version</span></code></li>
<li><a href="https://github.com/helm/charts">https://github.com/helm/charts</a></li>
<li><code class="codehilite"><span class="n">helm</span> <span class="n">repo</span> <span class="k">update</span></code></li>
<li><code class="codehilite"><span class="n">helm</span> <span class="n">install</span> <span class="k">stable</span><span class="o">/</span><span class="n">mysql</span> <span class="c1">--set mysqlPassword=example --name my-mysql</span></code></li>
<li>Fix permissions:
  <div class="codehilite"><pre><span></span>kubectl create serviceaccount --namespace kube-system tiller
kubectl create clusterrolebinding tiller-cluster-rule --clusterrole<span class="o">=</span>cluster-admin --serviceaccount<span class="o">=</span>kube-system:tiller
kubectl patch deploy --namespace kube-system tiller-deploy -p <span class="s1">&#39;{&quot;spec&quot;:{&quot;template&quot;:{&quot;spec&quot;:{&quot;serviceAccount&quot;:&quot;tiller&quot;}}}}&#39;</span> 
</pre></div></li>
</ul>
</li>
<li>Prometheus / Grafana (UI)<ul>
<li><code class="codehilite"><span class="n">helm</span> <span class="n">install</span> <span class="k">stable</span><span class="o">/</span><span class="n">prometheus</span><span class="o">-</span><span class="k">operator</span> <span class="c1">--name my-monitoring --namespace monitoring</span></code></li>
<li>To see how this works <code class="codehilite"><span class="n">kops</span> <span class="n">edit</span> <span class="k">cluster</span> <span class="c1">--name prometheus-oper-prometheus</span></code> change type to <code class="codehilite"><span class="n">LoadBalancer</span></code> and access UI(9090/graph))</li>
<li>To get a full set of data from Prometheus:
  <div class="codehilite"><pre><span></span>kops edit cluster --name <span class="si">${</span><span class="nv">NAME</span><span class="si">}</span>
kubelet:
  anonymousAuth: <span class="nb">false</span>    
  authenticationTokenWebhook: <span class="nb">true</span>    
  authorizationMode: Webhook
kops update cluster --yes
kops rolling-update cluster --yes 
</pre></div></li>
<li><code class="codehilite"><span class="n">prometheus</span><span class="o">-</span><span class="k">operator</span><span class="err">&quot;</span> <span class="n">failed</span><span class="p">:</span> <span class="n">rpc</span> <span class="n">error</span><span class="p">:</span> <span class="n">code</span> <span class="o">=</span> <span class="n">Canceled</span></code> <a href="https://github.com/helm/helm/issues/6130">https://github.com/helm/helm/issues/6130</a><ul>
<li><code class="codehilite"><span class="n">helm</span> <span class="n">del</span> <span class="c1">--purge monitoring</span></code></li>
<li><code class="codehilite"><span class="n">helm</span> <span class="n">install</span> <span class="c1">--name monitoring --namespace monitoring stable/prometheus-operator --set prometheusOperator.createCustomResource=false</span></code></li>
</ul>
</li>
<li><code class="codehilite"><span class="n">AlertManager</span></code> over <code class="codehilite"><span class="o">/</span><span class="n">api</span></code><ul>
<li>Dead man's switch - Constantly alerting. Stops if an alert is fired (or Prometheus is down)</li>
</ul>
</li>
<li><code class="codehilite"><span class="n">Slack</span></code> integration <ul>
<li>Incoming web-hook</li>
<li>Listen for Dead man's switch</li>
<li><a href="https://prometheus.io/docs/alerting/latest/configuration/">https://prometheus.io/docs/alerting/latest/configuration/</a></li>
<li><code class="codehilite"><span class="n">alertmanager</span><span class="p">.</span><span class="n">yaml</span></code>
    <div class="codehilite"><pre><span></span><span class="nt">global</span><span class="p">:</span>
<span class="nt">slack_api_url</span><span class="p">:</span> <span class="s">&#39;&lt;&lt;add</span><span class="nv"> </span><span class="s">your</span><span class="nv"> </span><span class="s">slack</span><span class="nv"> </span><span class="s">endpoint</span><span class="nv"> </span><span class="s">here&gt;&gt;&#39;</span>
<span class="nt">route</span><span class="p">:</span>
<span class="nt">group_by</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&#39;alertname&#39;</span><span class="p p-Indicator">]</span>
<span class="nt">group_wait</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5s</span>
<span class="nt">group_interval</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1m</span>
<span class="nt">repeat_interval</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10m</span>
<span class="nt">receiver</span><span class="p">:</span> <span class="s">&#39;slack&#39;</span>

<span class="nt">receivers</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&#39;slack&#39;</span>
<span class="nt">slack_configs</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">channel</span><span class="p">:</span> <span class="s">&#39;#alerts&#39;</span>
    <span class="nt">icon_emoji</span><span class="p">:</span> <span class="s">&#39;:bell:&#39;</span>
    <span class="nt">send_resolved</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="nt">text</span><span class="p">:</span> <span class="s">&quot;&lt;!channel&gt;</span><span class="nv"> </span><span class="s">\nsummary:</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">.CommonAnnotations.message</span><span class="nv"> </span><span class="s">}}\n&quot;</span>
</pre></div></li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="n">logs</span> <span class="o">-</span><span class="n">n</span> <span class="n">monitoring</span><span class="o">-</span><span class="n">namespace</span>  <span class="n">kube</span><span class="o">-</span><span class="n">prometheus</span></code></li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="n">logs</span> <span class="o">-</span><span class="n">n</span> <span class="n">monitoring</span><span class="o">-</span><span class="n">namespace</span>  <span class="n">kube</span><span class="o">-</span><span class="n">prometheus</span> <span class="o">-</span><span class="k">c</span> <span class="n">alertmanager</span></code></li>
<li>remove existing secret for the config file and set a new secret (<code class="codehilite"><span class="n">alertmanager</span><span class="o">-</span><span class="n">kube</span><span class="o">-</span><span class="n">prometheus</span></code>)</li>
</ul>
</li>
</ul>
</li>
<li>Requests and Limits<ul>
<li>Allow cluster manager to make intelligent decisions </li>
<li>If memory limit reached -&gt; pod remain running, container restart</li>
<li>If cpu limit reached -&gt; cpu clamped/throttled (will not be allowed to go over)
  <div class="codehilite"><pre><span></span><span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="nt">containers</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">db</span>
    <span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span>
    <span class="nt">requests</span><span class="p">:</span>
        <span class="nt">memory</span><span class="p">:</span> <span class="s">&quot;64Mi&quot;</span>
        <span class="nt">cpu</span><span class="p">:</span> <span class="s">&quot;250m&quot;</span>
    <span class="nt">limits</span><span class="p">:</span>
        <span class="nt">memory</span><span class="p">:</span> <span class="s">&quot;128Mi&quot;</span>
        <span class="nt">cpu</span><span class="p">:</span> <span class="s">&quot;500m&quot;</span>
</pre></div></li>
</ul>
</li>
<li>Metrics <ul>
<li>Enable metrics server: <code class="codehilite"><span class="n">minikube</span> <span class="n">addons</span> <span class="n">list</span></code> <code class="codehilite"><span class="n">minikube</span> <span class="n">addons</span> <span class="n">enable</span> <span class="n">metrics</span><span class="o">-</span><span class="n">server</span></code></li>
<li>View stats: <code class="codehilite"><span class="n">kubectl</span> <span class="n">top</span> <span class="n">pod</span></code> <code class="codehilite"><span class="n">kubectl</span> <span class="n">top</span> <span class="n">node</span></code></li>
</ul>
</li>
<li>Dashboard<ul>
<li><code class="codehilite"><span class="n">minikube</span> <span class="n">dashboard</span></code></li>
</ul>
</li>
<li>Horizontal Pod Autoscaling (HPA)<ul>
<li><a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/">https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/</a></li>
<li><a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale-walkthrough/">https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale-walkthrough/</a></li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="n">autoscale</span> <span class="n">deployment</span> <span class="n">example</span><span class="o">-</span><span class="n">deployment</span> <span class="c1">--cpu-percent 400 --min 1 --max 5</span></code> (relative to the request)</li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">get</span> <span class="n">hpa</span></code></li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">describe</span> <span class="n">hpa</span></code></li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">get</span> <span class="n">hpa</span> <span class="o">-</span><span class="n">o</span> <span class="n">yaml</span></code>
  <div class="codehilite"><pre><span></span><span class="nt">behavior</span><span class="p">:</span>
<span class="nt">scaleDown</span><span class="p">:</span>
    <span class="nt">policies</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Pods</span>
    <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4</span>
    <span class="nt">periodSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">60</span>
    <span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Percent</span>
    <span class="nt">value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
    <span class="nt">periodSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">60</span>
</pre></div></li>
</ul>
</li>
<li>Readiness Probe / Liveness Probe<ul>
<li><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/">https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/</a></li>
<li><code class="codehilite"><span class="n">readiness</span> <span class="n">probes</span></code> - to decide when the container is available for accepting traffic</li>
<li><code class="codehilite"><span class="n">startup</span> <span class="n">probe</span></code> - with <code class="codehilite"><span class="n">failureThreshold</span> <span class="o">*</span> <span class="n">periodSeconds</span></code> long enough to cover the worse case startup time. deal with legacy applications that might require an additional startup time on their first initialization.</li>
<li><code class="codehilite"><span class="n">liveness</span> <span class="n">probes</span></code> - to know when to restart a container (!live = restart)</li>
</ul>
</li>
<li>QoS and Evection <ul>
<li><a href="https://kubernetes.io/docs/concepts/scheduling-eviction/kube-scheduler/">https://kubernetes.io/docs/concepts/scheduling-eviction/kube-scheduler/</a></li>
<li>A scheduler watches for newly created Pods that have no Node assigned. </li>
<li>For every Pod that the scheduler discovers, the scheduler becomes responsible for finding the best Node for that Pod to run on. </li>
<li>QoS<ul>
<li><a href="https://kubernetes.io/docs/tasks/configure-pod-container/quality-service-pod/">https://kubernetes.io/docs/tasks/configure-pod-container/quality-service-pod/</a></li>
<li>Guaranteed - Both Limit and Request defined</li>
<li>Burstable - Only Request is defined</li>
<li>BestEffort - No limit or request defined </li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">describe</span> <span class="n">pod</span></code> shows QoS class</li>
</ul>
</li>
<li>Evicted based on QoS</li>
</ul>
</li>
<li>Pod Priorities    <ul>
<li><a href="https://kubernetes.io/docs/concepts/configuration/pod-priority-preemption/">https://kubernetes.io/docs/concepts/configuration/pod-priority-preemption/</a></li>
<li>Priority indicates the importance of a Pod relative to other Pods. </li>
<li>If a Pod cannot be scheduled, the scheduler tries to preempt (evict) lower priority Pods to make scheduling of the pending Pod possible.</li>
<li>Only <code class="codehilite"><span class="n">Pod</span><span class="o">-</span><span class="n">Priority</span></code> is used in scheduling new pods </li>
<li>During evection only <code class="codehilite"><span class="n">QoS</span></code> is considered first and then <code class="codehilite"><span class="n">Pod</span><span class="o">-</span><span class="n">Priority</span></code></li>
</ul>
</li>
<li>RBAC<ul>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">get</span> <span class="k">role</span></code></li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">get</span> <span class="n">rolebinding</span></code></li>
<li>Super-user<ul>
<li>Create OS user</li>
<li>In k8s create a new namespace <code class="codehilite"><span class="n">kubectl</span> <span class="k">create</span> <span class="n">ns</span> <span class="n">playground</span></code></li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="n">config</span> <span class="k">view</span></code>. Copy API LB endpoint URL. </li>
<li>X.509<ul>
<li>API only accept requests signed by <code class="codehilite"><span class="n">CA</span></code> within the k8s cluster</li>
<li>Create private-key: <code class="codehilite"><span class="n">openssl</span> <span class="n">genrsa</span> <span class="o">-</span><span class="k">out</span> <span class="n">private</span><span class="o">-</span><span class="k">key</span><span class="o">-</span><span class="n">username</span><span class="p">.</span><span class="k">key</span> <span class="mi">2048</span></code></li>
<li>CSR: <code class="codehilite"><span class="n">openssl</span> <span class="n">req</span> <span class="o">-</span><span class="k">new</span> <span class="o">-</span><span class="k">key</span> <span class="n">private</span><span class="o">-</span><span class="k">key</span><span class="o">-</span><span class="n">username</span><span class="p">.</span><span class="k">key</span> <span class="o">-</span><span class="k">out</span> <span class="n">req</span><span class="p">.</span><span class="n">csr</span> <span class="c1">--subj &quot;/CN=username/O=groupname&quot;</span></code></li>
<li><code class="codehilite"><span class="n">aws</span> <span class="n">s3</span> <span class="n">cp</span> <span class="n">s3</span><span class="p">:</span><span class="o">//</span><span class="k">storage</span><span class="o">-</span><span class="n">name</span><span class="o">/</span><span class="n">example</span><span class="p">.</span><span class="k">local</span><span class="o">/</span><span class="n">pki</span><span class="o">/</span><span class="n">private</span><span class="o">/</span><span class="n">ca</span><span class="o">/&lt;</span><span class="nb">number</span><span class="o">&gt;</span><span class="p">.</span><span class="k">key</span> <span class="n">kubernetes</span><span class="p">.</span><span class="k">key</span></code> </li>
<li><code class="codehilite"><span class="n">aws</span> <span class="n">s3</span> <span class="n">cp</span> <span class="n">s3</span><span class="p">:</span><span class="o">//</span><span class="k">storage</span><span class="o">-</span><span class="n">name</span><span class="o">/</span><span class="n">example</span><span class="p">.</span><span class="k">local</span><span class="o">/</span><span class="n">pki</span><span class="o">/</span><span class="n">issued</span><span class="o">/</span><span class="n">ca</span><span class="o">/&lt;</span><span class="nb">number</span><span class="o">&gt;</span><span class="p">.</span><span class="n">crt</span> <span class="n">kubernetes</span><span class="p">.</span><span class="n">crt</span></code> </li>
<li><code class="codehilite"><span class="n">openssl</span> <span class="n">x509</span> <span class="o">-</span><span class="n">req</span> <span class="o">-</span><span class="k">in</span> <span class="n">req</span><span class="p">.</span><span class="n">csr</span> <span class="o">-</span><span class="n">CA</span> <span class="n">kubernetes</span><span class="p">.</span><span class="n">crt</span> <span class="o">-</span><span class="n">CAkey</span> <span class="n">kubernetes</span><span class="p">.</span><span class="k">key</span> <span class="o">-</span><span class="n">CAcreateserial</span> <span class="o">-</span><span class="k">out</span> <span class="n">username</span><span class="p">.</span><span class="n">crt</span> <span class="o">-</span><span class="n">days</span> <span class="mi">365</span></code></li>
<li>Install new certificate with:<ul>
<li><code class="codehilite"><span class="n">cp</span> <span class="n">username</span><span class="p">.</span><span class="n">crt</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="p">.</span><span class="n">certs</span><span class="o">/</span></code></li>
<li><code class="codehilite"><span class="n">cp</span> <span class="n">private</span><span class="o">-</span><span class="k">key</span><span class="o">-</span><span class="n">username</span><span class="p">.</span><span class="k">key</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="p">.</span><span class="n">certs</span><span class="o">/</span></code></li>
<li><code class="codehilite"><span class="n">cp</span> <span class="n">kubernetes</span><span class="p">.</span><span class="n">crt</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="p">.</span><span class="n">certs</span><span class="o">/</span></code></li>
<li><code class="codehilite"><span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">username</span><span class="p">:</span><span class="n">username</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">username</span><span class="o">/</span><span class="n">certs</span></code></li>
</ul>
</li>
</ul>
</li>
<li>Define <code class="codehilite"><span class="k">Role</span></code> and <code class="codehilite"><span class="n">RoleBinding</span></code> (to bind role to user).</li>
</ul>
</li>
<li>New user do:<ul>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="n">config</span> <span class="k">set</span><span class="o">-</span><span class="n">credential</span> <span class="n">username</span> <span class="c1">--client-certificate=username.crt --client-key=private-key-username.key</span></code></li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="n">config</span> <span class="k">set</span><span class="o">-</span><span class="k">cluster</span> <span class="n">example</span><span class="p">.</span><span class="k">local</span> <span class="c1">--certificate-authority=kubernetes.crt</span></code></li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="n">config</span> <span class="k">set</span><span class="o">-</span><span class="k">cluster</span> <span class="n">example</span><span class="p">.</span><span class="k">local</span> <span class="c1">--server=&lt;api-lb_url&gt;</span></code></li>
<li>Now new user can: <code class="codehilite"><span class="n">kubectl</span> <span class="n">config</span> <span class="k">set</span><span class="o">-</span><span class="n">context</span> <span class="n">mycontext</span> <span class="c1">--user my-user-name --cluster example.local</span></code> <a href="https://kubernetes.io/docs/tasks/access-application-cluster/configure-access-multiple-clusters/">https://kubernetes.io/docs/tasks/access-application-cluster/configure-access-multiple-clusters/</a></li>
<li>Check config with <code class="codehilite"><span class="n">kubectl</span> <span class="n">config</span> <span class="k">view</span></code></li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="n">config</span> <span class="n">use</span><span class="o">-</span><span class="n">context</span> <span class="n">mycontext</span></code></li>
<li>Now new user can <code class="codehilite"><span class="n">kubectl</span> <span class="k">get</span> <span class="k">all</span></code></li>
</ul>
</li>
<li>Only allowed to access the namespace defined in <code class="codehilite"><span class="k">role</span></code>.</li>
<li>If all-namespaces should be visible use <code class="codehilite"><span class="n">ClusterRole</span></code> and <code class="codehilite"><span class="n">ClusterRoleBinding</span></code>.<ul>
<li>Grant limited permission across cluster. Then use <code class="codehilite"><span class="k">Role</span></code> section to grant wider permissions on own-cluster. </li>
</ul>
</li>
<li><code class="codehilite"><span class="n">ServiceAccount</span></code> in <code class="codehilite"><span class="n">RoleBinding</span></code> is used to grant access to one pod from another. </li>
</ul>
</li>
<li>ConfigMap <ul>
<li>Env variables are unmanageable and may get duplicated, leaving multiple places to change</li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">get</span> <span class="n">cm</span></code></li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">describe</span> <span class="n">cm</span></code> </li>
<li>Using config  map<ul>
<li><code class="codehilite"><span class="n">valueFrom</span></code> -&gt; <code class="codehilite"><span class="n">configMapKeyRef</span></code><ul>
<li>Still duplicates</li>
<li>When updating:<ul>
<li>Create a new version of the config-map</li>
<li>Change the name referenced</li>
</ul>
</li>
</ul>
</li>
<li><code class="codehilite"><span class="n">envFrom</span></code> -&gt; <code class="codehilite"><span class="n">configMapKeyRef</span></code><ul>
<li>all key value paired copied</li>
</ul>
</li>
<li><code class="codehilite"><span class="n">volumeMount</span></code> and <code class="codehilite"><span class="n">volume</span></code> -&gt; <code class="codehilite"><span class="n">configMap</span></code><ul>
<li>Each value of map becomes the file name</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Secrets <ul>
<li>Just prevents you from accidentals printing secret when doing <code class="codehilite"><span class="n">kubectl</span> <span class="k">get</span> <span class="n">secrets</span></code> </li>
<li>No encryption</li>
<li>RBAC can be used to deny access to <code class="codehilite"><span class="n">secrets</span></code> while giving access to <code class="codehilite"><span class="n">configMaps</span></code></li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">get</span> <span class="n">secrets</span></code> </li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">get</span> <span class="n">secret</span> <span class="o">-</span><span class="n">n</span> <span class="n">monitoring</span> <span class="n">example</span> <span class="o">-</span><span class="n">o</span> <span class="n">yaml</span></code> </li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">get</span> <span class="n">secret</span> <span class="o">-</span><span class="n">n</span> <span class="n">monitoring</span> <span class="n">example</span> <span class="o">-</span><span class="n">o</span> <span class="n">json</span></code></li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">delete</span> <span class="n">secret</span> <span class="o">-</span><span class="n">n</span> <span class="n">monitoring</span> <span class="n">example</span> <span class="o">-</span><span class="n">o</span> <span class="n">json</span></code></li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">create</span> <span class="n">secret</span> <span class="o">-</span><span class="n">n</span> <span class="n">monitoring</span> <span class="n">example</span> <span class="c1">--from-file=example.yaml</span></code></li>
<li>Hot Reloading of ConfigMaps Spring Cloud Kubernetes Demo: <a href="https://www.youtube.com/watch?v=DiJ0Na8rWvc&amp;t=563s">https://www.youtube.com/watch?v=DiJ0Na8rWvc&amp;t=563s</a></li>
</ul>
</li>
<li>Ingress Controllers<ul>
<li>Accessing Service <ul>
<li>NodePort - Alow defining port and exposing. Port 30,000 and above only. </li>
<li>ClusterIP - Internal access only</li>
<li>LoadBalancer - Provided by the cloud provider<ul>
<li>will require separate LB for each service</li>
</ul>
</li>
<li>LB talk to Ingress Controller (ex Nginx) and IC talk to services</li>
</ul>
</li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">get</span> <span class="n">ingress</span></code> <code class="codehilite"><span class="n">kubectl</span> <span class="k">describe</span> <span class="n">ingress</span></code> </li>
<li><code class="codehilite"><span class="n">minikube</span> <span class="n">addons</span> <span class="n">list</span></code> <code class="codehilite"><span class="n">minikube</span> <span class="n">addons</span> <span class="n">enable</span> <span class="n">ingress</span></code></li>
<li><a href="https://kubernetes.github.io/ingress-nginx/">https://kubernetes.github.io/ingress-nginx/</a></li>
</ul>
</li>
<li>Batch Jobs <ul>
<li>Pod by default <code class="codehilite"><span class="n">always</span></code> restarts (restart policy)</li>
<li>Designed to run to completion</li>
</ul>
</li>
<li>DaemonSet<ul>
<li>All nodes run a copy of these pods</li>
</ul>
</li>
<li>StatefulSet <ul>
<li>Pods have predictable names</li>
<li>Startup in sequence</li>
<li>Client can address by name</li>
<li>Example: Primary secondary situation</li>
</ul>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="o">-</span> <span class="n">OpenFaaS</span> <span class="n">Kubeless</span> <span class="n">OpenWisk</span>
<span class="o">-</span> <span class="n">GitLab</span> <span class="n">TravisCI</span> <span class="n">CircleCI</span>
<span class="o">-</span> <span class="n">Promethius</span> <span class="n">Fluentd</span> <span class="n">OpenTracing</span> <span class="n">Jeager</span> 
<span class="o">-</span> <span class="n">Istio</span> <span class="n">LinkerD</span> <span class="n">Consul</span>
<span class="o">-</span> <span class="n">Teraform</span> <span class="n">Helma</span>
</pre></div>

<h2 id="tools">Tools<a class="headerlink" href="#tools" title="Permanent link">&para;</a></h2>
<ul>
<li>Kubernetes RBAC static Analysis &amp; visualisation tool: <a href="https://github.com/appvia/krane">https://github.com/appvia/krane</a></li>
</ul>
<h2 id="security-validations">Security Validations<a class="headerlink" href="#security-validations" title="Permanent link">&para;</a></h2>
<ul>
<li>For internal services, use <code class="codehilite"><span class="n">ClusterIP</span></code> service-type. (instead of <code class="codehilite"><span class="n">NodePort</span></code>)</li>
<li>In production all use <code class="codehilite"><span class="n">ClusterIP</span></code> ??</li>
<li>Are pods stateless?</li>
<li>Are resource requests and limits defined properly.<ul>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="k">describe</span> <span class="n">node</span> <span class="n">minikube</span></code> (cluster node). <code class="codehilite"><span class="n">Allocatable</span></code> and <code class="codehilite"><span class="n">Capacity</span></code>. </li>
</ul>
</li>
<li>If &lt; Java 10 is used &frac14; of RAM is taken for Xmx by default (<code class="codehilite"><span class="o">-</span><span class="n">Xmx50m</span></code>)</li>
<li>Readiness Probe / Liveness Probe defined properly</li>
<li><code class="codehilite"><span class="n">kubectl</span> <span class="n">config</span> <span class="k">view</span> <span class="c1">--minify</span></code> to get password of cluster admin user/password. usable to login to cluster API and all services deployed in the cluster including <code class="codehilite"><span class="n">AlertManager</span></code>:<ul>
<li><code class="codehilite"><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">namespaces</span><span class="o">/</span></code></li>
<li><code class="codehilite"><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">namespaces</span><span class="o">/</span><span class="n">monitoring</span><span class="o">/</span><span class="n">services</span></code></li>
<li><code class="codehilite"><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">namespaces</span><span class="o">/</span><span class="n">monitoring</span><span class="o">/</span><span class="n">services</span><span class="o">/</span><span class="n">alert</span><span class="o">-</span><span class="n">manager</span><span class="o">-</span><span class="n">operated</span><span class="p">:</span><span class="mi">9093</span><span class="o">/</span><span class="n">proxy</span></code></li>
</ul>
</li>
<li>Prometheus: <a href="https://prometheus.io/docs/operating/security/">https://prometheus.io/docs/operating/security/</a></li>
<li>Audit RBAC configuration<ul>
<li>API groups are defined properly without using <code class="codehilite"><span class="o">*</span></code></li>
<li>Check <code class="codehilite"><span class="n">ClusterRole</span></code> for cluster wide permissions </li>
</ul>
</li>
<li>K8s API only accepts requests signed by <code class="codehilite"><span class="n">CA</span></code> within the k8s cluster</li>
<li>Make sure cluster key is stored securely. <ul>
<li><code class="codehilite"><span class="n">kops</span></code>: <code class="codehilite"><span class="n">KOPS_STATE_STORE</span></code> (s3 bucket) contains this. <code class="codehilite"><span class="n">cluster_folder</span><span class="o">/</span><span class="n">pki</span><span class="o">/</span><span class="n">private</span><span class="o">/</span><span class="n">ca</span><span class="o">/&lt;</span><span class="nb">number</span><span class="o">&gt;</span><span class="p">.</span><span class="k">key</span></code> and <code class="codehilite"><span class="n">pki</span><span class="o">/</span><span class="n">issued</span><span class="o">/</span><span class="n">ca</span><span class="o">/&lt;</span><span class="nb">number</span><span class="o">&gt;</span><span class="p">.</span><span class="n">crt</span></code>.<ul>
<li><code class="codehilite"><span class="n">aws</span> <span class="n">s3</span> <span class="n">ls</span> <span class="n">s3</span><span class="p">:</span><span class="o">//</span><span class="k">storage</span><span class="o">-</span><span class="n">name</span><span class="o">/</span><span class="n">example</span><span class="p">.</span><span class="k">local</span><span class="o">/</span><span class="n">pki</span><span class="o">/</span><span class="n">private</span><span class="o">/</span><span class="n">ca</span><span class="o">/&lt;</span><span class="nb">number</span><span class="o">&gt;</span><span class="p">.</span><span class="k">key</span></code></li>
<li><code class="codehilite"><span class="n">aws</span> <span class="n">s3</span> <span class="n">cp</span> <span class="n">s3</span><span class="p">:</span><span class="o">//</span><span class="k">storage</span><span class="o">-</span><span class="n">name</span><span class="o">/</span><span class="n">example</span><span class="p">.</span><span class="k">local</span><span class="o">/</span><span class="n">pki</span><span class="o">/</span><span class="n">private</span><span class="o">/</span><span class="n">ca</span><span class="o">/&lt;</span><span class="nb">number</span><span class="o">&gt;</span><span class="p">.</span><span class="k">key</span> <span class="n">kubernetes</span><span class="p">.</span><span class="k">key</span></code> </li>
<li><code class="codehilite"><span class="n">aws</span> <span class="n">s3</span> <span class="n">cp</span> <span class="n">s3</span><span class="p">:</span><span class="o">//</span><span class="k">storage</span><span class="o">-</span><span class="n">name</span><span class="o">/</span><span class="n">example</span><span class="p">.</span><span class="k">local</span><span class="o">/</span><span class="n">pki</span><span class="o">/</span><span class="n">issued</span><span class="o">/</span><span class="n">ca</span><span class="o">/&lt;</span><span class="nb">number</span><span class="o">&gt;</span><span class="p">.</span><span class="n">crt</span></code> </li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="cluster-api">Cluster API<a class="headerlink" href="#cluster-api" title="Permanent link">&para;</a></h2>
<ul>
<li>Bring declarative k8s style APIs to cluster creation, configuration and management.</li>
</ul>
<h2 id="new-references">New References<a class="headerlink" href="#new-references" title="Permanent link">&para;</a></h2>
<ul>
<li>Understanding Kubernetes limits and requests by example: <a href="https://sysdig.com/blog/kubernetes-limits-requests/">https://sysdig.com/blog/kubernetes-limits-requests/</a></li>
<li>Understanding Kubernetes pod evicted and scheduling problems: <a href="https://sysdig.com/blog/kubernetes-pod-evicted/">https://sysdig.com/blog/kubernetes-pod-evicted/</a></li>
<li>How to troubleshoot Kubernetes OOM and CPU Throttle: <a href="https://sysdig.com/blog/troubleshoot-kubernetes-oom/">https://sysdig.com/blog/troubleshoot-kubernetes-oom/</a></li>
</ul>
<h2 id="teraform">Teraform<a class="headerlink" href="#teraform" title="Permanent link">&para;</a></h2>
<ul>
<li>Server provisioning </li>
<li>Two steps:<ul>
<li>Initialize: <code class="codehilite"><span class="n">terraform</span> <span class="n">init</span></code></li>
<li>Validate: <code class="codehilite"><span class="n">terraform</span> <span class="n">validate</span></code></li>
<li>Plan: <code class="codehilite"><span class="n">terraform</span> <span class="n">plan</span></code></li>
<li>Execute: <code class="codehilite"><span class="n">teraform</span> <span class="n">apply</span></code></li>
</ul>
</li>
<li><code class="codehilite"><span class="n">terraform</span> <span class="n">console</span></code><ul>
<li>Resources are referenced as <type>.<name>: Example: <code class="codehilite"><span class="n">aws_s3_bucket</span><span class="p">.</span><span class="n">my_s3_bucket</span></code></li>
</ul>
</li>
<li>Types: <code class="codehilite"><span class="n">resource</span></code> <code class="codehilite"><span class="k">output</span></code> <code class="codehilite"><span class="k">variable</span></code> <code class="codehilite"><span class="n">lists</span></code> <code class="codehilite"><span class="n">maps</span></code> <code class="codehilite"><span class="n">provisioner</span></code> <code class="codehilite"><span class="k">connection</span></code></li>
<li><code class="codehilite"><span class="n">terfaform</span><span class="p">.</span><span class="n">tfstate</span></code> <code class="codehilite"><span class="n">terfaform</span><span class="p">.</span><span class="n">tfstate</span><span class="p">.</span><span class="n">backup</span></code> and <code class="codehilite"><span class="na">.teraform</span></code> must not be commited. Contains secrets in plain text. </li>
<li>When state needs to be shared, store the state inside a <code class="codehilite"><span class="n">Remote</span> <span class="n">Backend</span></code>.</li>
<li>Create multiple resources: <code class="codehilite">count  = 2 \n name=&quot;my_user_<span class="cp">${</span><span class="n">count</span><span class="o">.</span><span class="n">index</span><span class="cp">}</span>&quot;</code></li>
<li><code class="codehilite"><span class="nv">teraform</span> <span class="k">show</span></code> <code class="codehilite"><span class="n">teraform</span> <span class="n">fmt</span></code></li>
<li>Assign to variable from environment variables: <code class="codehilite"><span class="n">TF_VAR_</span><span class="o">&lt;</span><span class="n">variable_name</span><span class="o">&gt;=</span><span class="ss">&quot;&lt;value&gt;&quot;</span></code></li>
<li>Best Practice: Create separate projects for resources that might have similar lifecycle. One application would have multiple projects. </li>
<li>Best Practice: Use immutable servers - Once you provision a server and a change is required, just remove the old server and prosition a new one. Do not do tweeks.</li>
<li>Make things dynamic:<ul>
<li><code class="codehilite"><span class="n">aws_default_vpc</span></code> special resources that is not created / destroyed by Teraform. </li>
<li><code class="codehilite"><span class="n">data_provider</span></code> <code class="codehilite"><span class="n">aws_subnet_ids</span></code> to get list of subnets  within the VPC</li>
<li><code class="codehilite"><span class="n">aws_security_group</span></code></li>
<li><code class="codehilite"><span class="n">data_provider</span></code> <code class="codehilite"><span class="n">aws_ami</span></code> <code class="codehilite"><span class="n">aws_ami_ids</span></code> (most_recent: true)</li>
</ul>
</li>
<li><code class="codehilite"><span class="n">teraform</span> <span class="n">graph</span></code> -&gt; Graphwiz  </li>
<li>Storing state into S3<ul>
<li>Create S3 bucket: lifecycle, versioning, server_side_encryption_configuration</li>
<li>Create aws_dynamodb_table for locks: Attribute(LockID/S)</li>
<li>terraform -&gt; backend "s3" -&gt; point to s3 and dynamodb.. name  should be unique:  application/project/type/envitronment<ul>
<li>application_name, project_name, environment can be variables</li>
</ul>
</li>
</ul>
</li>
<li>Workspaces<ul>
<li>Track multiple environments</li>
<li><code class="codehilite"><span class="nv">teraform</span> <span class="nv">workspace</span> <span class="k">show</span></code></li>
<li><code class="codehilite"><span class="n">teraform</span> <span class="n">workspace</span> <span class="n">list</span></code></li>
<li><code class="codehilite"><span class="n">teraform</span> <span class="n">workspace</span> <span class="k">new</span> <span class="n">prod</span><span class="o">-</span><span class="n">env</span></code></li>
<li><code class="codehilite"><span class="n">teraform</span> <span class="n">workspace</span> <span class="k">select</span> <span class="n">prod</span><span class="o">-</span><span class="n">env</span></code></li>
<li>Use <code class="codehilite"><span class="cp">${</span><span class="n">teraform</span><span class="o">.</span><span class="n">workspace</span><span class="cp">}</span></code> to add the workspace name to resources</li>
</ul>
</li>
<li>Modules<ul>
<li>Create <code class="codehilite"><span class="n">teraform</span><span class="o">-</span><span class="n">modules</span></code> dir and in it create modules for different resources</li>
<li>Create <code class="codehilite"><span class="n">dev</span></code>  <code class="codehilite"><span class="n">prod</span></code> folders. In these folders in main.tf add variable for environment. <ul>
<li><code class="codehilite"><span class="k">module</span> <span class="s">&quot;user_module&quot;</span> { <span class="n">source</span> = <span class="s">&quot;../../teraform-modules/users&quot;</span> <span class="n">environment</span> = <span class="s">&quot;dev&quot;</span>}</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="codehilite"><pre><span></span>    <span class="nv">brew</span> <span class="nv">install</span> <span class="nv">terraform</span>
    <span class="nv">terraform</span> <span class="o">--</span><span class="nv">version</span>
    <span class="nv">terraform</span> <span class="nv">version</span>
    <span class="nv">terraform</span> <span class="nv">init</span>
    <span class="nv">export</span> <span class="nv">AWS_ACCESS_KEY_ID</span><span class="o">=*******</span>
    <span class="nv">export</span> <span class="nv">AWS_SECRET_ACCESS_KEY</span><span class="o">=*********</span>
    <span class="nv">terraform</span> <span class="nv">plan</span>
    <span class="nv">terraform</span> <span class="nv">console</span>
    <span class="nv">terraform</span> <span class="nv">apply</span> <span class="o">-</span><span class="nv">refresh</span><span class="o">=</span><span class="nv">false</span>
    <span class="nv">terraform</span> <span class="nv">plan</span> <span class="o">-</span><span class="nv">out</span> <span class="nv">iam</span>.<span class="nv">tfplan</span>
    <span class="nv">terraform</span> <span class="nv">apply</span> <span class="s2">&quot;</span><span class="s">iam.tfplan</span><span class="s2">&quot;</span>
    <span class="nv">terraform</span> <span class="nv">apply</span> <span class="o">-</span><span class="nv">target</span><span class="o">=</span><span class="nv">aws_iam_user</span>.<span class="nv">my_iam_user</span>
    <span class="nv">terraform</span> <span class="nv">destroy</span>
    <span class="nv">terraform</span> <span class="nv">validate</span>
    <span class="nv">terraform</span> <span class="nv">fmt</span>
    <span class="nv">terraform</span> <span class="k">show</span>
    <span class="nv">export</span> <span class="nv">TF_VAR_iam_user_name_prefix</span> <span class="o">=</span> <span class="nv">FROM_ENV_VARIABLE_IAM_PREFIX</span>
    <span class="nv">export</span> <span class="nv">TF_VAR_iam_user_name_prefix</span><span class="o">=</span><span class="nv">FROM_ENV_VARIABLE_IAM_PREFIX</span>
    <span class="nv">terraform</span> <span class="nv">plan</span> <span class="o">-</span><span class="nv">refresh</span><span class="o">=</span><span class="nv">false</span> <span class="o">-</span><span class="nv">var</span><span class="o">=</span><span class="s2">&quot;</span><span class="s">iam_user_name_prefix=VALUE_FROM_COMMAND_LINE</span><span class="s2">&quot;</span>
    <span class="nv">terraform</span> <span class="nv">apply</span> <span class="o">-</span><span class="nv">target</span><span class="o">=</span><span class="nv">aws_default_vpc</span>.<span class="nv">default</span>
    <span class="nv">terraform</span> <span class="nv">apply</span> <span class="o">-</span><span class="nv">target</span><span class="o">=</span><span class="nv">data</span>.<span class="nv">aws_subnet_ids</span>.<span class="nv">default_subnets</span>
    <span class="nv">terraform</span> <span class="nv">apply</span> <span class="o">-</span><span class="nv">target</span><span class="o">=</span><span class="nv">data</span>.<span class="nv">aws_ami_ids</span>.<span class="nv">aws_linux_2_latest_ids</span>
    <span class="nv">terraform</span> <span class="nv">apply</span> <span class="o">-</span><span class="nv">target</span><span class="o">=</span><span class="nv">data</span>.<span class="nv">aws_ami</span>.<span class="nv">aws_linux_2_latest</span>
    <span class="nv">terraform</span> <span class="nv">workspace</span> <span class="k">show</span>
    <span class="nv">terraform</span> <span class="nv">workspace</span> <span class="nv">new</span> <span class="nv">prod</span><span class="o">-</span><span class="nv">env</span>
    <span class="nv">terraform</span> <span class="nv">workspace</span> <span class="nv">select</span> <span class="nv">default</span>
    <span class="nv">terraform</span> <span class="nv">workspace</span> <span class="nv">list</span>
    <span class="nv">terraform</span> <span class="nv">workspace</span> <span class="nv">select</span> <span class="nv">prod</span><span class="o">-</span><span class="nv">env</span>
</pre></div>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../istio/" title="Istio" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Istio
              </span>
            </div>
          </a>
        
        
          <a href="../../windows/active-directory/" title="Active Directory" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Active Directory
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>